function $m(){}Type.registerNamespace("Common");Common.ek=function(n,t){if(isNullOrUndefined(n)||isNullOrUndefined(t))throw Error.argumentNull("appSettingsManager/clientRequestManager");this.e=n;this.g=t;this.d=null;this.f=null};Common.ek.a=function(n,t){try{return Diag.a.a(50860943,3004,50,"Parsing user privacy settings {0} from {1}",n,t),Common.cb.b(n,t)}catch(i){Diag.a.a(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",i.toString());throw i;}};Common.ek.prototype={d:null,f:null,e:null,g:null,i:function(n){var i=this.e.h.RoamingServiceHandlerWebServiceBase||"",r=String.format("{0}RoamingServiceHandler.ashx?action=",i),t=new Sys.StringBuilder(r);return t.append(n),t.append("&"),t.append(Common.a.e),t.toString()},h:function(n,t,i,r){return this.g.j(n,t,r,null,!1,2,null,i,"33",!1,null,6e4,null,null,!1,null)},a:function(n){var t=this;return new Promise(function(i,r){var e,u,f;try{if(isNullOrUndefined(t.d)||isNullOrUndefined(n)){r("Can't determine setting changes to save");return}if(e=t.d.a!==n.a,t.d.b===2&&e){t.k(n);i(!0);return}if(u=t.l(n),isNullOrUndefined(u)||!u.length){Diag.a.a(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed");r("No changes to save");return}if(t.d.b===1){i(t.j(u));return}t.d.b||(f=t.h(t.i("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",u),f.CW(function(){if(f.b===4||f.b===5){Diag.a.a(50860929,3004,10,"SaveUserPrivacySettings: Request failure");i(!1);return}var n=f.a();isNullOrUndefined(n.a)||isNullOrUndefined(n.a.a())||n.a.a().c!==200?i(!1):i(!0)}))}catch(o){Diag.a.a(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",o.toString());i(!1)}})},l:function(n){if(isNullOrUndefined(this.d)||isNullOrUndefined(n))throw Error.invalidOperation("User Privacy settings have not been initialized");var t=new($$sc.u.$$(String));return(n.b?n.b===1&&this.d.a!==n.a&&t.b("CCS"):(this.d.a!==n.a&&(t.b("CCS"),t.b("CCSTime")),this.d.c!==n.c&&t.b("OfficePrivacyRoamedNoticeShown")),!t.e.length)?(Diag.a.a(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null):n.j(t)},b:function(){if(!this.f){var n=this;this.f=new Promise(function(t){try{if(n.d){t(n.d.e());return}n.o().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.m().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.n().then(function(i){return n.d=i,t(n.d.e()),null},function(){return Diag.a.a(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)"),n.d=new Common.cb,t(n.d.e()),null}),null}),null})}catch(i){Diag.a.a(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",i.toString());n.d=new Common.cb;t(n.d.e())}})}return this.f},o:function(){var n=this;return new Promise(function(t,i){var u,f,r;try{if(u=window.location.href.indexOf("&wd_pn=2")!==-1,f=n.e.a("PrivacyDialogShouldCheckRoaming"),!f&&!u){Diag.a.a(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used");i("Roaming should not be used");return}r=n.h(n.i("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest",null);r.CW(function(){try{if(r.b===4||r.b===5)Diag.a.a(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var n=r.a();if(n&&n.a&&n.a.a())if(n.a.a().c!==200)Diag.a.a(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",n.a.a().c);else{if(n.a.a().a){t(Common.ek.a(n.a.a().a,0));return}Diag.a.a(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Diag.a.a(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");i("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure");return}}catch(u){Diag.a.a(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",u.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Request Exception");return}})}catch(e){Diag.a.a(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",e.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Exception");return}})},m:function(){var n=this;return new Promise(function(t,i){var u,r,f,e,o;try{if(u=Common.W.b("WacUPToggleState"),r=null,!isNullOrUndefined(u)&&u.length>0&&(r=decodeURIComponent(u)),!isNullOrUndefined(r)&&r.length>0){Diag.a.a(50860940,3004,50,"TryGetSettingsFromCookie: Cookie is present for UserPrivacySettings");t(Common.ek.a(r,1));return}if(f=Common.cb.a(1,null),e=new($$sc.u.$$(String)),e.b("CCS"),o=f.j(e),n.j(o)){t(f);return}i("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie");return}catch(s){Diag.a.a(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",s.toString());i("UserPrivacySettings TryGetSettingsFromCookie Eception")}})},n:function(){var n=this;return new Promise(function(n){var r,t,i;try{r=window.location.href.indexOf("&wdccsoff=1")!==-1;t=Common.cb.a(2,null);r?(t.a=2,Common.a.X=!0):t.a=1;n(t);return}catch(u){Diag.a.a(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",u.toString());i=Common.cb.a(2,null);i.a=1;n(i)}})},k:function(n){return Common.a.X=n.a===2?!0:!1,!0},j:function(n){try{var t=this.e.h.PrivacyCookieDomain||"";if(!t||!t.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");return Common.W.f("WacUPToggleState",n,390,"/",t)}catch(i){return Diag.a.a(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",i.toString()),!1}},c:function(n){var t=this,i=this;return this.b().then(function(i){for(var u=t.e.d("ServicesControlsMicrosoftControllerServicesList")?t.e.e("ServicesControlsMicrosoftControllerServicesList"):new Array(0),f=new($$sc.q.$$(String))($$sc.f.b()),r=0;r<u.length;r++)f.a(u[r]);return f.b(n)?i.a!==2:!0},function(){return Diag.a.a(50860945,3004,10,"Failed to get privacy setting for feature {0}",n),!0})}};Type.registerNamespace("Common.App.ApplicationFeatureHelper");Common.App.ApplicationFeatureHelper.d=function(){};Common.App.ApplicationFeatureHelper.d.prototype={applicationFeatureHelperHandler:0,cloudPolicySettings:1};Common.App.ApplicationFeatureHelper.d.registerEnum("Common.App.ApplicationFeatureHelper.d",!1);Common.App.ApplicationFeatureHelper.j=function(){};Common.App.ApplicationFeatureHelper.j.prototype={Features:null};Common.App.ApplicationFeatureHelper.e=function(){};Common.App.ApplicationFeatureHelper.e.prototype={PolicySettings:null,ControllerConnectedServicesFeatureNames:null};Common.App.ApplicationFeatureHelper.h=function(){};Common.App.ApplicationFeatureHelper.h.a=function(){Common.App.a.a().a(new Common.App.ApplicationFeatureHelper.h,0,!1)};Common.App.ApplicationFeatureHelper.h.prototype={d:null,a:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"},c:function(n){var i,r,t;this.d=n;i=this;this.d.b(Common.App.ApplicationFeatureHelper.c).a().b(function(){return new Common.App.ApplicationFeatureHelper.i(Common.a.a,Common.a.d)});r=this;this.d.b(Common.App.ApplicationFeatureHelper.b).a().b(function(){return new Common.ek(Common.a.a,Common.a.d)});t=this;this.d.b(Common.App.ApplicationFeatureHelper.a).a().b(function(){return new Common.App.ApplicationFeatureHelper.g(Common.a.a,Common.a.d,t.d.a(Common.App.ApplicationFeatureHelper.c),t.d.a(Common.App.ApplicationFeatureHelper.b),Common.a.c())})},b:function(){var n=this;Common.a.a.g(function(){var t=n.d.a(Common.App.ApplicationFeatureHelper.a);Common.a.a.a("LicensingIsEnabled")&&(t.a("LicensingTestFeature",!1).then(function(n){return Diag.a.a(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",n,Common.a.a.h.IsAnonymousUser),null}),t.b("LicensingTestFeature",0).then(function(n){return Diag.a.a(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",n,Common.a.a.h.IsAnonymousUser),null}))})}};Common.App.ApplicationFeatureHelper.g=function(n,t,i,r){var u,f,e,o;this.p=Function.createDelegate(this,this.u);this.m=new Common.App.ApplicationFeatureHelper.f(n,t);this.f=n;this.n=n.a("IsO365ConsumerHost");this.k=n.a("IsO365CommercialHost");this.j=i;this.l=r;this.d=n.a("LicensingIsEnabled");this.g=n.a("OcpsIsEnabled")&&this.k;this.h=(n.a("ShowPrivacyDialog")||n.a("TrustCenterDialogIsEnabled"))&&!!r;u=this;this.i=new Promise(function(n){n(!1)});f=this;this.c=new Promise(function(n){n(!0)});this.o=this.r();this.t()?this.e=this.w(this.d,this.q("/afhs/ApplicationFeatureHelperHandler.ashx"),this.p):(e=this,this.e=new Promise(function(n){n({})}));o=this;this.e.catch(function(n){Diag.a.a(42513088,3004,10,n)})};Common.App.ApplicationFeatureHelper.g.prototype={m:null,f:null,j:null,l:null,d:!1,g:!1,h:!1,n:!1,k:!1,o:null,i:null,c:null,e:null,r:function(){for(var t=this.f.d("AllLicensedFeatures")?this.f.e("AllLicensedFeatures"):new Array(0),i=new($$sc.q.$$(String))($$sc.f.b()),n=0;n<t.length;n++)i.a(t[n]);return i},t:function(){return this.k||this.n},w:function(n,t,i){return Diag.a.a(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing"),this.m.d(Object,n,t,i,0)},u:function(n){var t=JSON.parse(n);return t?(Diag.a.a(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Diag.a.a(50938594,3004,50,"{0}",t)):Diag.a.a(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set. Response was {0}",n),t.Features},q:function(n){return String.format("{0}{1}?{2}",this.f.c("WebServiceBase"),n,Common.a.e)},a:function(n,t){var i,r,u;if(!this.g&&!this.h&&n==="ConnectedServices"||!this.d&&n!=="ConnectedServices")return this.c;if(Diag.a.a(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",n),n==="ConnectedServices"){var e=this.g?this.j.a("ControllerConnectedServicesEnabled",!0):this.c,h=this,c=this,o=this.h?this.l.b().then(function(n){return n.a!==2},function(){return t}):this.c,s=this;return e.then(function(n){return n?o:s.i})}i=null;i=this.g?this.j.b(n,!0):this.c;r=null;r=this.d?this.s(n,t):this.c;u=null;u=this.h?this.l.c(n):this.c;var f=this,l=this,a=this;return i.then(function(n){return n?u.then(function(n){return n?r:f.i}):f.i}).then(function(n){return n},function(){return t})},b:function(n,t){var r,i,u;return this.d?(Diag.a.a(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",n),i=this,u=this,this.e.then(function(r){return n in r?i.v(r[n],t):t},function(){return t})):(r=this,new Promise(function(n){n(2)}))},v:function(n,t){switch(n.toLowerCase()){case"unknown":return 0;case"basic":return 1;case"premium":return 2;default:return t}},s:function(n,t){if(this.d){if(this.o.b(n)){var i=this,r=this;return this.e.then(function(t){return n in t},function(){return t})}return this.c}return this.c}};Common.App.ApplicationFeatureHelper.i=function(n,t){var r,i,u;for(this.j=Function.createDelegate(this,this.m),this.f={},this.h=new Common.App.ApplicationFeatureHelper.f(n,t),this.c=n,this.e=n.a("OcpsIsEnabled")&&n.a("IsO365CommercialHost"),this.f=JSON.parse(n.h.OcpsDefaultSettings||"{}"),r=this.c.d("ServicesControlsMicrosoftControllerServicesList")?this.c.e("ServicesControlsMicrosoftControllerServicesList"):new Array(0),this.d=new($$sc.q.$$(String))($$sc.f.b()),i=0;i<r.length;i++)this.d.a(r[i]);this.g=this.n(this.e,this.l("/afhs/CloudPolicySettings.ashx"),this.j);u=this;this.g.catch(function(n){Diag.a.a(50622685,3004,10,n)})};Common.App.ApplicationFeatureHelper.i.prototype={h:null,c:null,d:null,e:!1,g:null,a:function(n,t){var i;if(!this.e)return i=this,new Promise(function(t){t(i.i(n))});var r=this,u=this,f=this.g.then(function(i){try{var f=i.PolicySettings[Common.bY.toString(0)];return new Promise(function(t){t(f[n]!=="0")})}catch(u){return Diag.a.a(50622686,306,10,"Failed to get "+n+" policy value. Error Message: {0}",u.message),r.k(u.toString(),t,r.i(n))}},function(i){return u.k(i,t,u.i(n))}),e=this;return f.then(function(t){return Diag.a.a(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",n,t),null}),f},b:function(n,t){var f=this,i=new Promise(function(n){n(!0)}),r="",u;return this.d.b(n)&&(r="ControllerConnectedServicesEnabled",i=this.a(r,t)),u=this,i.then(function(t){return Diag.a.a(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",n,t,r),null}),i},k:function(n,t,i){var r,u;return t?(r=this,new Promise(function(n){n(i)})):(u=this,new Promise(function(t,i){i(n)}))},n:function(n,t,i){return this.h.d(Common.App.ApplicationFeatureHelper.e,n,t,i,1)},l:function(n){return String.format("{0}{1}?{2}",this.c.h.WebServiceBase,n,Common.a.e)},m:function(n){var t=null,i,r;return r=Common.bm.a(Common.App.ApplicationFeatureHelper.e,n,i={val:t}),t=i.val,r,Diag.a.a(50622687,3004,t?50:10,"ParseApplicationFeatureHelperResponse: fetched CloudPolicySettingsData from {0}",n),t},i:function(n){return n in this.f?this.f[n]!=="0":!0}};Common.App.ApplicationFeatureHelper.f=function(n,t){this.a=n;this.c=t};Common.App.ApplicationFeatureHelper.f.prototype={a:null,c:null,d:function(n,t,i,r,u){var e=Common.App.ApplicationFeatureHelper.d.toString(u),f=this;return new Promise(function(o,s){if(!t){o(new n);return}Diag.a.a(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing.");f.g(u);f.c.a(i,2,null,f.f(),!1,0,function(n){Diag.a.a(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",e);try{if(isNullOrUndefined(n)||isNullOrUndefined(n.b)||isNullOrUndefined(n.b.a)){s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",e));f.b("NullResponseData",u);return}if(n.b.c!==200){f.b("NonSuccessStatusCode",u);s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",n.b.c,e));return}var t=r(n.b.a);if(isNullOrUndefined(t)){f.b("ParseResponseFailure",u);s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",e));return}Diag.a.a(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",e);o(t)}catch(i){f.b("UnhandledExceptionDuringRequest",u);s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",i,e))}},function(n){if(Diag.a.a(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",e),f.b("RequestFailed",u),isNullOrUndefined(n)||isNullOrUndefined(n.b)){s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",e));return}s(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",n.b.c,n.b.a||"No Data",e))},null,null,!1,f.a.b("ApplicationFeatureHelperRequestQueueTimeout",5e3),f.a.b("ApplicationFeatureHelperRequestSentTimeout",5e3),null,null,!1,null,!1)})},f:function(){var n={};return n["x-UserDataSignature"]=this.a.c("UserDataSignature"),n["x-LicensingIsEnabled"]=this.a.a("LicensingIsEnabled").toString(),n["x-CacheIsEnabled"]=this.a.a("LicensingRedisIsEnabled").toString(),n["x-OcpsIsEnabled"]=this.a.a("OcpsIsEnabled").toString(),n["x-LicensingAADIdIsEnabled"]=this.a.a("LicensingAadIdIsEnabled").toString(),n},g:function(n){var t=this.e(n);t&&t!==""&&Common.H.f(t,0,"stbrown",null)},b:function(n,t){var i=this.e(t);i&&i!==""&&Common.H.e(i,n,!1,!0,null)},e:function(n){switch(n){case 0:return"AFHSLicensingSuccessfulHTTPResponse";case 1:return"AFHSCloudPolicySuccessfulHTTPResponse";default:return""}}};Common.App.ApplicationFeatureHelper.j.registerClass("Common.App.ApplicationFeatureHelper.j");Common.App.ApplicationFeatureHelper.e.registerClass("Common.App.ApplicationFeatureHelper.e");Common.App.ApplicationFeatureHelper.h.a();Type.registerNamespace("Common.App.InsertFile");Common.App.InsertFile.a=function(n,t){this.W=Function.createDelegate(this,this.bs);Common.App.InsertFile.a.initializeBase(this);this.T=n;this.cU=!1;this.y=!1;this.m=this.bh();this.n=this.X;this.h(1,this.bg());this.R(this.bi(),this.W);t&&this.bq();this.co=!1};Common.App.InsertFile.a.a=function(n){var t=document.getElementById("errorText");t.innerText=n;t.style.display="inline-block"};Common.App.InsertFile.a.prototype={T:null,X:"InsertFileDialog",a:null,bn:function(){this.a.a||Diag.a.a(25798091,322,10,"UploadFrame.FileInputElement is null");var n=this.a.a.value;return n?!0:(Common.App.InsertFile.a.a($a.dv),!1)},bs:function(n){n===1&&this.bo()?(this.dZ(),this.T.f(this.a,this.dH)):n||this.i()},bq:function(){this.a=this.bp(document.getElementById("uploadFrameContainer"),this.T);this.a.a||Diag.a.a(25798092,322,15,"UploadFrame.FileInputElement is null")},dispose:function(){this.a=null;CommonUI.b.prototype.dispose.call(this)}};Common.App.InsertFile.c=function(n,t,i){this.p=Function.createDelegate(this,this.L);this.o=Function.createDelegate(this,this.W);this.D=Function.createDelegate(this,this.V);this.E=n;this.J=t;this.d=i;this.e=!1;this.r=!0;this.X();this.w=this.d.a("NativeFileOpenDialogIsEnabled")};Common.App.InsertFile.c.prototype={J:null,E:null,d:null,e:!1,q:null,r:!1,b:null,w:!1,F:0,G:0,H:0,I:0,k:null,W:function(n){if(this.b=n,!this.e){if(this.r){if(this.w&&Common.c.n()){this.k=n.H(this.D);return}if(this.k=n.H(null),!this.t(this.k,n))return}this.f(n,null)}},V:function(n){this.t(n,this.b)&&((Common.c.n()||Common.c.c())&&(this.k=n),this.f(this.b,null))},s:function(){this.q&&this.q()},X:function(){this.F=0;this.G=this.d.b("Box4UploadRetryCount",20);this.H=this.d.b("Box4UploadRetryDelayStart",200);this.I=this.d.b("Box4UploadRetryDelayMax",3200);this.b&&(this.b.dispose(),this.b=null)}};Common.App.InsertFile.b=function(n,t){this.b=n;this.a=t};Common.App.InsertFile.b.prototype={b:null,a:null};Common.App.InsertFile.d=function(n,t,i,r,u,f,e,o,s,h){this.B=Function.createDelegate(this,this.N);this.t=Function.createDelegate(this,this.W);this.D=Function.createDelegate(this,this.P);this.C=Function.createDelegate(this,this.O);this.E=Function.createDelegate(this,this.T);this.g=n;this.u=t;this.o=i;this.m=u;this.p=e;this.j=o;this.k=h;this.q=!1;this.v=r.a("CanaryRenewalForFileUploadIsEnabled");this.i=!1;this.b=document.createElement("iframe");this.b.className=f;this.b.id=f;this.m&&(this.b.style.visibility="visible",this.b.style.height="30px",this.b.setAttribute("frameborder","0"));this.h=this.E;Common.j.a(this.b,"load",this.h);s&&this.G()};Common.App.InsertFile.d.prototype={z:"FileUpload.ashx",b:null,n:!1,u:null,o:null,l:null,g:null,d:null,a:null,h:null,e:null,m:!1,p:null,j:null,k:null,c:null,w:!1,q:!1,v:!1,i:!1,r:function(){return Common.a.a?Common.a.a.a("NativeFileOpenDialogIsEnabled"):!1},Q:function(){return this.b.contentWindow.location.pathname.endsWith(this.z)},H:function(n){return(Common.a.b().u(),!this.a)?(Diag.a.a(25798093,322,50,"_fileInput is null"),""):(this.r()&&Common.c.n()&&(this.l=n,this.e=this.C,Common.j.a(this.a,"change",this.e)),Common.gN.a(this.D,1,"DoFileOpenDialog"),this.a.value)},O:function(){this.l&&this.l(this.a.value)},P:function(){try{Diag.a.a(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element.");this.a.click()}catch(n){Diag.a.a(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",n.message);throw n;}},U:function(){Common.a.be("Microsoft.Office.Web.SessionSettings.IWacWoncaCanaryRenewalForFileUploadSettings");this.S()?this.L():this.d.submit()},S:function(){return this.v&&!isNullOrUndefined(window.self.FormData)},L:function(){var n=new(Type.parse("FormData"))(this.d),t=this.x();this.c=new XMLHttpRequest;this.c.open("POST",t);this.c.onreadystatechange=this.t;this.c.send(n)},V:function(n){var t,i;this.d.removeChild(this.a);t=new(Type.parse("FormData"))(this.d);t.append("applicationfileInput",n.a,n.b);i=this.x();this.c=new XMLHttpRequest;this.c.open("POST",i);this.c.onreadystatechange=this.t;this.c.send(t)},W:function(){var n,t;if(this.c.readyState===4)if(this.c.status===200){if(n=this.c.getResponseHeader("X-NewKey"),!isNullOrUndefined(n)&&(t=this.X(n),!this.q&&t&&!this.R(this.c))){this.q=!0;this.y();this.L();return}this.s(this.c.responseText)}else Diag.a.a(42874946,322,15,"Upload request failed with status: "+this.c.status),this.s(null)},R:function(n){var r,t,i,u;try{if(r=JSON.parse(n.responseText),t=r.Responses,!isNullOrUndefined(t)&&t.length===1&&(i=t[0],!isNullOrUndefined(i)&&i.length===2&&(u=i[1].StatusCode,u===28)))return!1}catch(f){}return!0},X:function(n){return(Common.bG.d(n),Common.a.A!==n)?!1:!0},dispose:function(){this.w||(this.g.removeChild(this.b),Common.j.b(this.b,"load",this.h),this.h=null,this.e&&(Common.j.b(this.a,"change",this.e),this.e=null),this.b=null,this.g=null,this.d=null,this.a=null,this.w=!0,Diag.a.a(25798094,322,50,"UploadFrame disposed"))},N:function(){this.dispose()},M:function(n,t){var i=this.b.contentWindow.document.getElementById(n);if(i){i.value=t;return}i=this.b.contentWindow.document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;this.d.appendChild(i)},T:function(){var t,i;try{if(!this.b.contentWindow.document.body)return}catch(f){this.J();return}if(this.n||this.r()&&Common.c.n()){if(!(this.r()&&Common.c.n())||this.Q()){t=Common.c.a()?this.b.contentWindow.document.body.innerText:this.i?this.b.contentWindow.document.body.firstChild.innerText:this.b.contentWindow.document.body.firstChild.innerHTML;var n=this.b.contentWindow.document.body.innerText.toLowerCase(),r=n.indexOf("responses")>=0||n.indexOf("wopisrc")>=0,u=n.indexOf("http error")>=0;!r&&u&&(i=this.b.contentWindow.document.body.innerText,Diag.a.a(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+i));this.s(t)}}else this.I()},I:function(){var n,t,i;if(!this.n){var u=this.A("uploadForm"),r=this.A("fileInput"),f=this.x();this.d=this.b.contentWindow.document.createElement("form");this.d.id=u;this.d.method="post";this.d.encoding="multipart/form-data";this.d.action=f;this.a=this.b.contentWindow.document.createElement("input");this.a.type="file";this.j&&(this.a.accept=this.j,this.k&&(this.a.capture=this.k));this.a.id=r;this.a.name=r;this.m&&(n=this.b.contentWindow.document.body,n.style.margin="0",n.style.overflow="hidden",t=Common.a.b(),this.a.style.fontFamily=t.J(),this.a.style.fontSize=t.K(),this.a.style.margin="0");i=document.getElementById("__REQUESTDIGEST");i&&this.M("__REQUESTDIGEST",i.value);this.y();this.d.appendChild(this.a);this.b.contentWindow.document.body.appendChild(this.d);this.n=!0;this.u(this)}},G:function(){this.g.appendChild(this.b);this.r()&&Common.c.n()&&this.I()},x:function(){var t=new Common.bt(this.z),n;return Common.a.bI(t),this.K(t),n=t.toString(),(Common.c.c()||Common.c.n()||Common.c.m())&&(n=Common.k.r(n)),n},F:function(){var n=new Common.N(2,1,0,this.B,4,null,!1);Common.a.f().a(n)}};Common.App.InsertFile.a.registerClass("Common.App.InsertFile.a",CommonUI.b);Common.App.InsertFile.c.registerClass("Common.App.InsertFile.c");Common.App.InsertFile.d.registerClass("Common.App.InsertFile.d",null,Sys.IDisposable);Type.registerNamespace("Common.App.InsertPicture");Common.App.InsertPicture.c=function(n,t){Common.App.InsertPicture.c.initializeBase(this,[n,t])};Common.App.InsertPicture.c.prototype={bg:function(){return $a.dy},bi:function(){return $a.dB},bh:function(){return Common.App.InsertPicture.b.b()},bn:function(){var n,t;return(this.a.a||Diag.a.a(25798095,322,10,"UploadFrame.FileInputElement is null"),n=Common.App.InsertPicture.a.b(this.a.a.value),n)?(t=Common.App.InsertPicture.a.c(n),Common.App.InsertFile.a.a(t),!1):!0}};Common.App.InsertPicture.a=function(n,t,i){Common.App.InsertPicture.a.initializeBase(this,[n,t,i])};Common.App.InsertPicture.a.c=function(n){switch(n){case 1:return $a.Y;case 2:return $a.dC;default:return""}};Common.App.InsertPicture.a.d=function(n){for(var i=n.toLowerCase(),t=0;t<Common.App.InsertPicture.a.a.length;++t)if(i.endsWith(Common.App.InsertPicture.a.a[t]))return!0;return!1};Common.App.InsertPicture.a.b=function(n){return n?Common.App.InsertPicture.a.d(n)?0:2:1};Common.App.InsertPicture.a.prototype={c:null,l:null,Z:function(){return Common.a.b().d()},t:function(n,t){var i=Common.App.InsertPicture.a.b(n),r,u;return i?(t.F(),i===2&&(r=Common.App.InsertPicture.a.c(i),u=this.M(i),this.ba(u,r)),!1):!0},f:function(n,t){Diag.a.a(36783360,322,50,"PictureUploader.FinalizeUpload");this.q=t;this.O()&&this.bb();Common.PerfMetrics.a(5576);this.l=this.Z().a("LoadResource","PictureUploadTime");var i=this.P();i?this.K(n):this.s()},ba:function(n,t){var i=new CommonUI.d;i.g(0);i.e(n,$a.dA,t,null)},s:function(){Diag.a.a(36783361,322,50,"PictureUploader.OnUploadComplete");Common.App.InsertFile.c.prototype.s.call(this);this.l&&(this.l.a(),this.l=null);this.N()&&this.Y()},bb:function(){this.c=new CommonUI.g(!1);this.c.O=$a.dD;this.c.g(5);this.c.F=!1;this.c.e(null,null,null)},Y:function(){return this.c?(this.c.a(),this.c=null,!0):!1}};Common.App.InsertPicture.b=function(){};Common.App.InsertPicture.b.b=function(){return CommonUI.b.a(Common.App.InsertPicture.b.a,$a.dz,$a.Y)};Common.App.InsertPicture.c.registerClass("Common.App.InsertPicture.c",Common.App.InsertFile.a);Common.App.InsertPicture.a.registerClass("Common.App.InsertPicture.a",Common.App.InsertFile.c);Common.App.InsertPicture.a.a=[".jpg",".jpeg",".png",".gif",".bmp",".tif",".tiff"];Common.App.InsertPicture.b.a="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'><\/div> <div class='WACDialogError' id='errorText' role='alert'>{1}<\/div> <\/div>";Type.registerNamespace("_Ewa");_Ewa.FirstRunExperienceManager=function(n){this.e=Function.createDelegate(this,this.h);this.c=Function.createDelegate(this,this.f);this.d=Function.createDelegate(this,this.g);this.b=new _Ewa.sP(n,Common.a.d,this.d,this.c,null,this.e)};_Ewa.FirstRunExperienceManager.prototype={b:null,a:function(){Diag.a.a(41023176,0,50,"Initiating call to get FRE data for current user from Roaming Settings Service");var n,t=(n=new($$sc.u.$$(String)),n.b("Excel"),n);this.b.m(t)},i:function(n,t){var r={},i={};i.FREDisplayedDate=(new Date).toUTCString();i.VersionDisplayed=n;i.RemindMeLater=t;r.Excel=JSON.stringify(i);Diag.a.a(41023177,0,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.b.n(r)},g:function(n,t){if(t&&"FREDisplayedDate"in t)Diag.a.a(41023180,0,100,"UI experience is not enabled and FRE data has already been saved for the current user. No further action required.");else{Diag.a.a(41023178,0,50,"UI experience is not enabled. No FRE data found for current user. Registering FRE data.");this.i(0,!1);var i=n?n.k-n.h:-1;i>4e3&&Diag.a.a(41023179,0,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. FRE data has been registered regardless.",i,4e3,"Excel")}},f:function(n){Diag.a.a(41023181,0,10,"Excel Online First Run Experience failed to GET data from Roaming Settings Service with status: {0}",n?n.c:-1)},h:function(n){Diag.a.a(41023182,0,10,"Excel Online First Run Experience failed to POST data to Roaming Settings Service with status: {0}",n?n.c:-1)}};_Ewa.sO=function(n){_Ewa.sO.initializeBase(this);this.k=n;this.j()};_Ewa.sO.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.jW),311,new _Ewa.sO(n))};_Ewa.sO.prototype={k:null,h:null,b:function(){this.i(this.l())},l:function(){var n="/"+this.k.f().RoamingServiceHandlerWebServiceBase;return this.h=new _Ewa.FirstRunExperienceManager(n),this.h.a(),this.h}};_Ewa.sP=function(n,t,i,r,u,f){this.i=Function.createDelegate(this,this.p);this.j=Function.createDelegate(this,this.q);this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.o);this.f=n;this.a=t;this.c=i;this.b=r;this.e=u;this.d=f};_Ewa.sP.a=function(n){for(var i=new Sys.StringBuilder,t=0;t<n.e.length;t++)i.append(n.a(t)),t<n.e.length-1&&i.append(";");return i.toString()};_Ewa.sP.prototype={f:null,a:null,c:null,b:null,e:null,d:null,m:function(n){var t=this.k("getFirstRunExperienceSettings"),i;t.a("requestedsettings",_Ewa.sP.a(n));i=t.toString()+"&"+Common.a.e;this.a.a(i,1,null,null,!0,2,this.h,this.g,null,null,!1,null,null,null,null,!1,null,!1)},n:function(n){var t=this.k("saveFirstRunExperienceSettings"),i=t.toString()+"&"+Common.a.e,r=JSON.stringify(n);this.a.a(i,2,r,null,!0,4,this.j,this.i,null,null,!1,null,null,null,null,!1,null,!1)},o:function(n){var r=!1,u=null,t,i;try{n.b.a.length>0&&(t=$$as(Object,JSON.parse(n.b.a)),i=t?t.Excel:null,i&&(u=$$as(Object,JSON.parse(i.toString()))));r=!0}catch(f){this.l(null)}r&&this.c&&this.c(n.b,u)},l:function(n){this.b&&this.b(n?n.b:null)},q:function(n){this.e&&this.e(n?n.b:null)},p:function(n){this.d&&this.d(n?n.b:null)},k:function(n){var i=this.f+"RoamingServiceHandler.ashx",t=new Common.bt(i);return t.a("action",n),t}};_Ewa.FirstRunExperienceManager.registerClass("_Ewa.FirstRunExperienceManager",null,_Ewa.jW);_Ewa.sO.registerClass("_Ewa.sO",_Ewa.oQ.$$(_Ewa.jW));Type.registerNamespace("_Ewa");_Ewa.SO=function(){};_Ewa.SO.a=function(){_Ewa.h.a(function(){_Ewa.h.a(_Ewa.sO.a)})};_Ewa.SO.a();Type.registerNamespace("_Ewa");_Ewa.tN=function(n,t,i,r,u,f,e){_Ewa.tN.initializeBase(this,[n,t,i,r,u,!1]);this.r=!1;this.h=e;this.g=_Ewa.tN.a(f);var o=this.C(this.g.name,this.g.size);if(o){this.S(o);this.h.SX(Error.create("DataUrlUploaderWrapper: Invlid data url"));this.dispose();return}this.b=new _Ewa.lK(this.a.r(),this.o,this.p,r,!1,this.a)};_Ewa.tN.a=function(n){var i=n.split(","),r,e,u,t,o,f;for(r=i[0].indexOf("base64")>=0?window.self.atob(i[1]):window.self.decodeURI(i[1]),e=i[0].split(":")[1].split(";")[0],u=new Uint8Array(r.length),t=0;t<r.length;t++)u[t]=r.charCodeAt(t);return o=new Blob([u],{type:e}),f=o,f.name="Image.png",f};_Ewa.tN.prototype={h:null,g:null,B:function(n,t,i){_Ewa.lJ.prototype.B.call(this,n,t,i);this.h.SX(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))},v:function(n,t,i){_Ewa.lJ.prototype.v.call(this,n,t,i);_Ewa.j.b(n.Errors)?this.h.SX(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",_Ewa.j.a(n.Errors,",")))):this.h.b(!0)},T:function(n){var t=new Common.App.InsertFile.b(this.g.name,this.g);n.V(t)}};_Ewa.Fb=function(n,t,i){this.e=Function.createDelegate(this,this.bu);_Ewa.Fb.initializeBase(this,[n,!1]);this.V=t;this.d=n;this.b=Common.q.a();this.U=i;Common.App.InsertFile.a.prototype.bq.call(this);this.bt()};_Ewa.Fb.prototype={V:null,d:null,c:null,O:!1,b:null,U:null,bp:function(n,t){return new _Ewa.lK(n,t.o,t.p,this.U,!0,this.V)},dispose:function(){this.br();this.d=null;this.b=null;Common.App.InsertFile.a.prototype.dispose.call(this)},bn:function(){var i=this.d.U(this.a),n=this.d.C(this.a.a.value,i),t;return n?(t=this.d.y(n).Description,this.c.innerHTML=t,this.bv(),!1):!0},bo:function(){return!0},bt:function(){this.c=document.getElementById("errorText");this.c.style.display="inline-block";this.O=!1;this.c.innerHTML="";this.be().style.maxWidth=this.be().currentStyle.minWidth},bv:function(){this.b.a("click",this.a.a,this.e);this.b.a("keydown",this.a.a,this.e);this.O=!0},br:function(){this.O&&(this.b.b("click",this.a.a,this.e),this.b.b("keydown",this.a.a,this.e),this.O=!1)},bu:function(){return this.c.innerHTML="",this.br(),!1}};_Ewa.Fc=function(n){this.a=n};_Ewa.Fc.prototype={a:null,s:function(n,t,i){if(this.a.a(228)&&i&&"dataUrl"in i){var r=new($$sc.C.$$(Boolean));return new _Ewa.tN(this.a,null,Common.I.a(),Common.a.a,i,i.dataUrl,r),r.a}return new _Ewa.lJ(this.a,t,Common.I.a(),Common.a.a,i,!0),$$sc.a.a(Boolean,!0)},r:function(n,t){return t.a===1403967063&&this.a.q()},t:function(){return!1},u:function(n,t){return this.a.a(300)&&t===1403967063&&_Ewa.L.a(this.a).l()}};_Ewa.tO=function(n){_Ewa.tO.initializeBase(this,[n])};_Ewa.tO.a=function(n){_Ewa.Y.a(90,new _Ewa.tO(n))};_Ewa.tO.prototype={l:function(){this.k([new _Ewa.Fc(this.h)],null)}};_Ewa.lJ=function(n,t,i,r,u,f){this.Q=Function.createDelegate(this,this.bf);_Ewa.lJ.initializeBase(this,[null,i,r]);this.a=n;this.u=t;this.n=n.n().b("WebServiceCall","InsertPictureOperation");this.i=_Ewa.z.a().a(this.Q,1e5,_Ewa.l.bz,!1,!1);this.j=!1;this.m=this.a.f().InsertPictureMaxFileSizeBytes;u&&(this.z="TestOnly"in u);f&&this.bg()};_Ewa.lJ.c=function(n){return!n||_Ewa.i.a(n,"UnknownError",!0)?2:_Ewa.i.a(n,"NoFileSelectedError",!0)?1:_Ewa.i.a(n,"FileTooBig",!0)?3:_Ewa.i.a(n,"MaxConnectionsReached",!0)?5:0};_Ewa.lJ.b=function(n,t,i,r){return _Ewa.bc.a(1,0,0,n,t,i,r)};_Ewa.lJ.a=function(n){switch(n){case 1:return 1;case 2:return 6}return 0};_Ewa.lJ.prototype={n:null,u:null,A:null,x:null,i:null,j:!1,m:0,z:!1,a:null,bc:function(){return this.m/1048576},L:function(n){var t,u,i,r;this.n.a();this.i.a();t=n;u=!_Ewa.lK.a(t);u?(i=_Ewa.lJ.c(t),i?(Diag.a.a(34193863,0,50,"Server returned error, response: {0}",t),this.R(i)):this.bd(t)):(this.j?this.R(4):(r=new Common.fd(0,2,null,null,!1,null,null,null),r.b=8,this.B(new Common.fc(r),null,"InsertPictureWebMethod")),Diag.a.a(33863624,0,50,"Http Error occurred, isTimeoutError: {0}",this.j));Common.App.InsertPicture.a.prototype.s.call(this);this.dispose()},dispose:function(){System.a.a(this.i);this.b.F();this.a=null;this.i=null;this.b=null},f:function(n,t){Common.App.InsertPicture.a.prototype.f.call(this,n,t);var i=this,r=function(t,r){return i.A=t,i.x=r,i.n.c(),i.i.b(),i.j=!1,i.T(n),$$sc.a.a(Boolean,!0)},u=this,f=function(n){var t=new _Ewa.bd(510,0,n,8,null);return t.I=!0,t.v=u.u,t};_Ewa.O.a(this.a.g(),r,f,this.u)},U:function(n){var i=-1,t=n.a;return t&&t.files&&t.files.length>0&&(i=t.files[0].size),i},C:function(n,t){var i=_Ewa.lJ.a(Common.App.InsertPicture.a.b(n));return i?i===6&&this.be(n):t!==-1&&(Diag.a.a(34193864,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",t,this.m,this.a.c().bA()),t>this.m?i=3:t>this.a.c().bA()&&(i=7)),Diag.a.a(34193865,0,50,"Validated file on client, validation result: {0}",i),i},M:function(){return 0},P:function(){return!0},O:function(){return!0},N:function(){return!0},K:function(){},t:function(n,t){var r=this.U(t),i=this.C(n,r);return i?(this.e||i===1||this.S(i),!1):!0},T:function(n){n.U()},y:function(n){var u=0,t=1,i=-1100324317,r="InsertPictureUnknownError",f=null,e;switch(n){case 1:u=1450;t=0;i=940870981;r="InsertPictureNoFileSelected";break;case 3:t=0;i=1250467391;r="InsertPicturePictureTooBig";f=String.format(_Ewa.ClientStringManager.a().c(113),this.bc().toLocaleString());break;case 6:u=1454;t=0;i=1380041209;r="InsertPictureUnsupportedFormat";break;case 7:u=1451;t=0;i=-903115058;r="InsertPictureExceedWorkbookSize";break;case 4:u=1452;t=0;i=1218352119;r="InsertPictureUploadTimeout";break;case 5:u=1453;t=0;i=1979899005;r="InsertPictureServiceNonDeterministicError"}return e=_Ewa.lJ.b(u,t,i,r),f&&(e.Description=f),e},bg:function(){if(Diag.a.a(34193866,0,50,"Showing Insert Picture dialog"),!this.z&&(Common.c.i()||Common.c.n()&&Common.c.Q()<72))this.e=!1,this.b=new _Ewa.lK(this.a.r(),this.o,this.p,this.d,!1,this.a);else{this.e=!0;var n=new _Ewa.Fb(this,this.a,this.d);this.b=n.a}},bd:function(n){var t={},r,i;try{t=_Ewa.H.b(n);_Ewa.x.a().c(this.n.d(),t.ServerCorrelationId,_Ewa.P.toString(0),"ServerActions");!_Ewa.j.b(t.Errors)&&t.Result&&(this.a.c().P(t.StateId,"PictureUploaderWrapper.UploadResponseReceived"),r=t.Result,_Ewa.L.a(this.a).d(1,r,!1),i=this.a.b().a(_Ewa.ih,276,!1),i&&i.b(this.a,1,t.Result,t,"InsertPicture"),Diag.a.a(34193867,0,50,"Insert picture completed successfully :)"))}catch(u){Diag.a.a(25801035,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:-1,u)}this.v(t,null,"InsertPictureWebMethod")},R:function(n){var i=this.y(n),t={};t.Errors=[i];this.v(t,null,"InsertPictureWebMethod")},v:function(n,t,i){this.A(n,t,i)},B:function(n,t,i){this.x(n,t,i)},S:function(n){var t=this.y(n),i=new _Ewa.dt(this.a,t);i.v(!1)},bf:function(){this.j=!0},be:function(n){for(var i=this.a.f().InsertPicturUnsupportedExtensionsForLogging,r=n.toLowerCase(),t=0;t<i.length;++t)if(r.endsWith(i[t])){Diag.a.a(34193868,0,50,"Insert picture blocked invalid extension: {0}",i[t]);return}}};_Ewa.lK=function(n,t,i,r,u,f){_Ewa.lK.initializeBase(this,[n,t,i,r,u,"UploadFrame",f.c().i(),"image/*",!1,null]);this.f=f;this.i=!0;Common.App.InsertFile.d.prototype.G.call(this)};_Ewa.lK.a=function(n){return!n||_Ewa.i.a(n,"ServerUploadError",!1)};_Ewa.lK.prototype={f:null,A:function(n){return n},K:function(n){Diag.a.b(33863626,0,!!this.p,"SessionId shouldn't be null.");_Ewa.U.e(n,this.f.f());n.b("sessionId",this.p);var i=_Ewa.b.a(this.f).a(),t=_Ewa.g.c(i.v(),this.f);n.b("sheetName",this.f.e().a().a);n.b("row",t.FirstRow.toString());n.b("col",t.FirstColumn.toString())},y:function(){},J:function(){this.o("ServerUploadError")},s:function(n){this.o(n)}};_Ewa.lJ.registerClass("_Ewa.lJ",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.tN.registerClass("_Ewa.tN",_Ewa.lJ);_Ewa.Fb.registerClass("_Ewa.Fb",Common.App.InsertPicture.c);_Ewa.Fc.registerClass("_Ewa.Fc",null,_Ewa.iW);_Ewa.tO.registerClass("_Ewa.tO",_Ewa.Y);_Ewa.lK.registerClass("_Ewa.lK",Common.App.InsertFile.d);Type.registerNamespace("_Ewa");_Ewa.UP=function(){};_Ewa.UP.a=function(){_Ewa.h.a(function(n){_Ewa.tO.a(n)})};_Ewa.UP.a();Type.registerNamespace("_Ewa");_Ewa.Ji=function(n,t){var i,r;this.a=new($$sc.v.$$(_Ewa.uS));this.b=n;this.c=t;i=this;this.e=function(n){return Promise.resolve(n)};r=this;this.d=function(n){return Promise.reject(n)}};_Ewa.Ji.prototype={a:null,b:null,e:null,d:null,c:null,j:function(n){var t,i;return this.k(n.a)?(Diag.a.a(37364047,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",n.a),t=this.a.a(n.a),this.a.c(n.a,n),i=t.g,t.f=!1,this.h(n,i)):(this.a.c(n.a,n),this.l(n))},k:function(n){return this.a.b(n)},l:function(n){var t=this;return new Promise(function(i,r){n.g=t.b.a(n).then(function(r){return i(null),t.f(n,r)},function(n){return r(null),t.d(n)})})},h:function(n,t){var i=this;return new Promise(function(r,u){n.g=t.then(function(t){return i.n(n,t),i.b.a(n).then(function(t){return r(null),i.f(n,t)},function(n){return u(null),i.d(n)})},function(n){return i.d(n)})})},f:function(n,t){return n.f&&(this.g(n.a),this.m(n,t)),this.e(t)},g:function(n){this.a.d(n)},m:function(n,t){var i=this.i();n.a===i&&this.b.c(n.b,t,n.c.b)},i:function(){var n=_Ewa.b.a(this.c).a().b().e(),t;return n||(t=_Ewa.g.a(_Ewa.b.a(this.c).a().a(),this.c),n=t.FirstRow+"_"+t.FirstColumn),n},n:function(n,t){n.b=null;n.e=t}};_Ewa.cq=function(){};_Ewa.cq.b=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external");if(!!t&&t==="1")return!0}return!1};_Ewa.cq.d=function(n){return _Ewa.cq.b(n)&&!isNullOrUndefined(n.clipboardItems)&&!!n.clipboardItems.getItem("image/png")&&!n.clipboardItems.getItem("text/plain")};_Ewa.cq.c=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external-XLO-source");if(!!t&&t==="1")return!0}return!1};_Ewa.cq.a=function(n){if(n){var t=n.getCachedMetadata();if(t&&t.lastCopy)return t.lastCopy}return null};_Ewa.fs=function(){};_Ewa.fs.prototype={range:0,art:1};_Ewa.fs.registerEnum("_Ewa.fs",!1);_Ewa.QB=function(){};_Ewa.mP=function(){};_Ewa.mP.b=function(n){return CommonUI.b.a(_Ewa.mP.a,_Ewa.ClientStringManager.a().a(16),_Ewa.ClientStringManager.a().a(n?18:17),_Ewa.ClientStringManager.a().a(19))};_Ewa.Ac=function(n,t,i,r){_Ewa.Ac.initializeBase(this,[n,t,i,"AcrossSessionRangeCopyPasteHandler",r]);this.h=new _Ewa.qQ(n)};_Ewa.Ac.prototype={h:null,serialize:function(n){var r=n.sourceItem,t={},i=this.f.b(r),u,f;if(i)t.synchronousResult=i,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else{if(u=null,!_Ewa.v.y(this.c)&&this.p(r.a)){Diag.a.a(26035413,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");f=this.i.a(r.a);try{u=f.toString();i=this.d.a();i.setItem("text/plain",u);this.f.a(r,i);t.synchronousResult=i;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{f&&f.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.d.a(),t.synchronousResult.setItem("text/plain",this.n());t.asynchronousResult=this.t(n,r,u)}return n.syncClipboardItemsKeys=_Ewa.fC.a(t.synchronousResult),t},shouldWaitForCopyToComplete:function(n){return!n||!n.copyContextSnapshot?(Diag.a.a(39084501,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1):(Diag.a.b(41562511,0,!!this.c.f(),"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null"),n.copyContextSnapshot.sessionId===this.c.f().UserSessionId)?(Diag.a.a(41562513,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1):(Diag.a.a(41562514,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0)},onDeferredPasteStarted:function(n){this.h.d(n)},onDeferredPasteCompleted:function(n){this.h.c(n)},deserialize:function(n){var u,t,i,r,f,e;if(n.isClipboardDataContainShadowWorkbook=!isNullOrUndefined(n.clipboardItems.getItem("data/shadow-workbook")),u=n.copyContextSnapshot,t=this.e.b(u),_Ewa.cq.b(n))return this.j(n);if(i=n.commandParameters.originalDestination,t&&(i=_Ewa.qM.a(n,t),n.isSameSession))return this.s(n,u,t,i);if(n.commandParameters.commandType!==516){if(r=null,e=this.x(n.clipboardItems,f={val:r}),r=f.val,e)return n.isShadowWorkbookParsedSuccessfully=!0,this.v(n,_Ewa.g.a(i,this.c),r);if(n.isClipboardInaccessible)return Promise.reject(new _Ewa.ck(8,null,null,""));if(n.commandParameters.commandType!==36)return this.o(n)}return Promise.reject(new _Ewa.ck(6,null,null,""))},w:function(n,t){if(!n||!n.SourceRanges||!n.SourceRanges.Ranges||!n.SourceRanges.Ranges.length)return t.val=null,!1;var i=n.SourceRanges.Ranges[0];return(t.val=null,!n.ShadowWorkbookBase64&&!n.ShadowWorkbookSizeExceedsLimit)?!1:(t.val=this.r(n),t.val.rangeRowStart=i.FirstRow,t.val.rangeRowEnd=i.LastRow,t.val.rangeColumnStart=i.FirstColumn,t.val.rangeColumnEnd=i.LastColumn,t.val.sourceClientPath=n.SourceClientPath,t.val.sourceSheetName=n.SourceSheetName,t.val.sourceWorkbookName=n.SourceWorkbookName,!0)},x:function(n,t){t.val=null;var i=n.getItem("data/shadow-workbook");return i?(t.val=JSON.parse(i),this.u(t.val)):!1},u:function(n){return!!n&&(!!n.shadowWorkbookBase64||n.shadowWorkbookSizeExceedsLimit)&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)},v:function(n,t,i){return Diag.a.b(33863617,0,!!i,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null"),Common.a.D("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions"),n.pasteResult="CrossSessionPaste",n.payloadOrigin="CrossSession",n.payloadType="ShadowWorkbook",n.shadowWorkbookPayloadSize=_Ewa.fD.b(i),n.shadowWorkbookSizeExceedsLimit=_Ewa.fD.a(i),n.shadowWorkbookSizeExceedsLimit?(Diag.a.a(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,i.shadowWorkbookSizeExceedsLimit),Promise.reject(new _Ewa.ck(1,null,null,""))):(Diag.a.a(33863619,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request..."),this.e.k(n.commandParameters.ribbonCommandInfo,t,i,[n.commandParameters.stopwatch],n))},t:function(n,t,i){Diag.a.b(41805027,0,!!n,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var u=this.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?n.commandParameters.stopwatch.b():0,r=this;return new Promise(function(f,e){var o=function(o){var h,c,s,l,v,y,p,a;if(r.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u),_Ewa.j.b(o.Errors))_Ewa.j.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538326,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",_Ewa.j.a(o.Errors,","),n.id)):(Diag.a.a(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.j.a(o.Errors,","),n.id),e(new _Ewa.gj(2,o.Errors)));else{if(Diag.a.a(26035418,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",n.id),n.markForCancellation){e(new _Ewa.gj(3,o.Errors));return}h=o.Result;c=h.PlainTextResult;isNullOrUndefined(i)||(c=i);isNullOrUndefined(c)||(n.plainTextPayloadSize=c.length);s=r.d.a();(y=r.w(h,v={val:l}),l=v.val,y)&&(n.shadowWorkbookPayloadSize=_Ewa.fD.b(l),n.shadowWorkbookSizeExceedsLimit=_Ewa.fD.a(l),p=JSON.stringify(l),s.setItem("data/shadow-workbook",p));s.setItem("text/plain",c);_Ewa.v.y(r.c)&&(a=h.HtmlResult,n.htmlSizeExceedsLimit=h.HtmlSizeExceedsLimit,isNullOrUndefined(a)||(n.htmlPayloadSize=a.length),s.setItem("text/html",a));n.copyTotalSizeExceedsLimit=h.CopyTotalSizeExceedsLimit;s.setItem("copyId",n.commandParameters.id);r.f.a(t,s);n.asyncClipboardItemsKeys=_Ewa.fC.a(s);f(s)}},s=function(t){r.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u);var i=_Ewa.U.a(t.b);Diag.a.a(26035420,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.j.a(i,","),n.id);e(new _Ewa.gj(2,i))};Diag.a.a(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",n.id);r.e.i(t.a,n.commandParameters,o,s,[n.commandParameters.stopwatch])})}};_Ewa.qL=function(n,t,i,r,u){_Ewa.qL.initializeBase(this,[n,"ArtCopyPasteHandler"]);this.d=n;this.l=new _Ewa.qQ(n);this.h=t;this.k=i;this.f=_Ewa.b.a(n).a();this.i=u||new _Ewa.qO(this.h);this.p=new _Ewa.Ji(i,n);this.g=r};_Ewa.qL.a=function(n){return n.b===1||n.b===5};_Ewa.qL.prototype={f:null,d:null,k:null,h:null,i:null,p:null,g:null,l:null,getSourceItem:function(){return Diag.a.b(36227297,0,!!this.f.b().e(),"Expecting a floating object to be currently selected for copy"),Diag.a.a(39682266,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.f.b().e()),new _Ewa.gD(this.f.b().e(),this.d.c().k().e(),this.d.c().e(),this.d.f().UserSessionId,this.f.b().a().a().a)},beforeSerialize:function(n){if(!n||!n.commandParameters){Diag.a.a(36227298,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.");return}_Ewa.Ae.a(n);n.commandParameters.copyPasteTargetType=2},serialize:function(n){var r=n.sourceItem,t={},i;return r?this.v()?(Diag.a.a(39682267,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",r.a),this.x(),i=this.i.b(r),i?(t.synchronousResult=i,n.isFromCache=!0,n.isAsyncCopy=!1,n.clientSideCopyTime=n.commandParameters.stopwatch.b(),n.commandParameters.commandType===1&&this.d.A(2045211913,n.commandParameters.ribbonCommandInfo.b,n.commandParameters.ribbonCommandInfo.c,null)):(n.isFromCache=!1,n.isAsyncCopy=!0,i=this.h.a(),t.synchronousResult=this.s(i),t.asynchronousResult=this.u(n,r,i)),n.syncClipboardItemsKeys=_Ewa.fC.a(t.synchronousResult),t):(Diag.a.a(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),t):(Diag.a.a(36227299,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),t)},s:function(n){var t,i;return Diag.a.b(39977874,0,!!this.f.b().a(),"Expecting a floating object to be currently selected for copy"),n||(n=this.h.a()),t=this.f.b().a().bV(),!t||(i=String.format("<img src='{0}'>",t),n.setItem("text/html",i)),n},x:function(){var n=this.f.b().a();this.g.b(_Ewa.K.e(n.a(),null),_Ewa.K.w(n.H()))},shouldWaitForCopyToComplete:function(){return Diag.a.a(41562515,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0},onDeferredPasteStarted:function(n){this.l.d(n)},onDeferredPasteCompleted:function(n){this.l.c(n)},deserialize:function(n){var r,i,u,f,t,c,e,o,s,h;if(_Ewa.cq.b(n))return this.j(n);if(r=n.copyContextSnapshot,i=r.sourceItem,!i)return Promise.reject(new _Ewa.ck(10,null,null,""));if(u=i.c(this.d),!u&&!_Ewa.qL.a(i))return f=String.format("User attempted to paste art of type [{0}] between sessions.",i.b),Diag.a.a(36229120,0,50,f),Promise.reject(new _Ewa.ck(11,null,null,f));if(r.isAsyncSerializeFailed)return Promise.reject(new _Ewa.ck(16,null,null,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{c=n.clipboardItems.getItem("data/shadow-workbook");t=JSON.parse(c)}catch(l){return Diag.a.a(38102659,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(l)),Promise.reject(new _Ewa.ck(12,null,l,""))}if(t.floatingObjectId!==i.a?Diag.a.a(40134681,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId):Diag.a.a(39682268,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId),!t||!t.shadowWorkbookBase64)return Promise.reject(new _Ewa.ck(13,null,null,String.format("shadowWorkbookPayload is null = {0}",!t)));if(n.isShadowWorkbookParsedSuccessfully=!0,n.shadowWorkbookPayloadSize=_Ewa.fD.b(t),n.shadowWorkbookSizeExceedsLimit=_Ewa.fD.a(t),n.payloadOrigin=u?"SameSession":"CrossSession",n.payloadType="GVML",_Ewa.fD.a(t))return e=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,t.shadowWorkbookSizeExceedsLimit),Diag.a.a(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",e),Promise.reject(new _Ewa.ck(1,null,null,e));if(o=null,s=null,_Ewa.b.a(this.d).a().d()&70?s=_Ewa.b.a(this.d).a().b().e():o=this.d.j()&&this.d.j().k()?_Ewa.g.a(this.d.j().k(),this.d):_Ewa.g.a(n.commandParameters.originalDestination,this.d),h=null,this.g.c(i))try{h=this.g.a()}catch(a){Diag.a.a(37857494,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(a))}return this.p.j(new _Ewa.uS(n.commandParameters.ribbonCommandInfo,o,s,n.commandParameters.commandType,[n.commandParameters.stopwatch],t,i,n,h))},j:function(n){if(n.isExternalPaste=!0,this.d.a(228)&&n.clipboardItems.getItem("image/png")){var t=this.d.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?n.commandParameters.stopwatch.b():0,i=this,r=this;return $$sc.h.toPromise$t(Boolean,this.d.A(1403967063,n.commandParameters.ribbonCommandInfo.b,n.commandParameters.ribbonCommandInfo.c,{dataUrl:n.clipboardItems.getItem("image/png")})).then(function(r){return(i.d.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t),r)?Promise.resolve(null):Promise.reject(new _Ewa.ck(15,null,null,""))},function(){return r.d.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t),Promise.reject(new _Ewa.ck(15,null,null,""))})}return Diag.a.b(39965841,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler"),_Ewa.Qy.prototype.j.call(this,n)},v:function(){var n=_Ewa.b.a(this.d).a(),t;return!n.b().e()||!n.b().a()||!n.b().a().a()?!1:(t=n.b().a().a(),t.Z())},u:function(n,t,i){var r=this;return new Promise(function(u,f){var e=r.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?n.commandParameters.stopwatch.b():0,o=function(o){var c,s,l,h;if(r.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e),_Ewa.j.b(o.Errors))_Ewa.j.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538327,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.j.a(o.Errors,","))):(Diag.a.a(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.j.a(o.Errors,",")),f(new _Ewa.gj(4,o.Errors)));else{if(Diag.a.a(36229121,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",t.a),n.markForCancellation){f(new _Ewa.gj(3,o.Errors));return}if(_Ewa.j.d(o.Errors)&&Diag.a.a(39688195,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",_Ewa.j.a(o.Errors,",")),c=o.Result,c){s=null;s=r.r(c);s.floatingObjectId=t.a;n.shadowWorkbookPayloadSize=_Ewa.fD.b(s);n.shadowWorkbookSizeExceedsLimit=_Ewa.fD.a(s);try{l=JSON.stringify(s)}catch(a){f(new _Ewa.ck(14,null,a,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",n.shadowWorkbookPayloadSize,s.floatingObjectId)));return}Diag.a.b(41537862,0,!!i,"Expecting syncClipboardItems to be defined");h=i;h.setItem("data/shadow-workbook",l);n.commandParameters.commandType===1&&(r.w(t.b,t.a,o.StateId),r.t(t.a,t.b));r.i.a(t,h);n.asyncClipboardItemsKeys=_Ewa.fC.a(h);u(h)}else Diag.a.a(36508684,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",t.a),u(r.i.b(t))}},s=function(i){r.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e);var u=_Ewa.U.a(i.b);n.commandParameters.commandType===1&&r.k.d(t.b,t.a);Diag.a.a(36229123,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.j.a(u,","));f(new _Ewa.gj(4,u))};Diag.a.a(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");r.k.b(new _Ewa.Bk(t.a,n.commandParameters,o,n.commandParameters.commandType,t.b,s,[n.commandParameters.stopwatch]))})},t:function(n,t){var u=t+"_"+n,i=_Ewa.L.a(this.d).b(u,null),r;i?(r=14,_Ewa.L.a(this.d).c(i,r,!0),_Ewa.b.a(this.d).a().b().n(null)):Diag.a.a(37839768,0,100,"ArtCopyPasteHandler.DeleteFloatingObject: tried to delete a non existing floating object")},w:function(n,t,i){var f=this.d.b().a(_Ewa.ih,276,!1);if(f){var u=null,e=n+"_"+t,r=_Ewa.L.a(this.d).b(e,null);if(r&&r.h()&&(u=r.h().a),!u)return;var o=r.a().h(),h=this,s=function(){return!u.g().d(o)};f.a(s,i,"CutArt")}}};_Ewa.lc=function(n,t){this.e=n;this.f=t};_Ewa.lc.a=function(n){return String.format("{0}.{{{1}}}",n.length+2,n.toUpperCase())};_Ewa.lc.prototype={e:null,f:null,h:function(n,t,i,r,u,f,e){var l=this.e.d().a().b(),h=null,c,o={},a,s,y,v;o.CopyPasteTargetType=2;o.FloatingObjectId=n;o.CopyOperationId=i.id;u===2?(c=505,a=this,h=function(n,t){return _Ewa.jG.a(a.e.d().a(),o,_Ewa.n.a(n,r),f?_Ewa.n.b(t,f):t,i.ribbonCommandInfo,l,e)}):(c=179,s=this,h=function(u,h){return s.g(t,n),s.e.J(),_Ewa.jG.c(s.e.d().a(),o,_Ewa.n.a(u,r),f?_Ewa.n.b(h,f):h,i.ribbonCommandInfo,l,e)});y=this;v=function(){return new _Ewa.Fq(o)};this.e.g().a(new _Ewa.bd(c,0,h,16,v),i.ribbonCommandInfo)},g:function(n,t){var r=n+"_"+t,i=_Ewa.L.a(this.e).b(r,null);i?(_Ewa.b.a(this.e).a().b().c(i,!0),i.p(!1)):Diag.a.a(37790621,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",n,t)},d:function(n,t){var r=n+"_"+t,i=_Ewa.L.a(this.e).b(r,null);i&&i.p(!0)},b:function(n){var t=n;this.h(t.e,t.b,t.a,t.f,t.c,t.d,t.g)},i:function(n,t,i,r,u,f,e,o){var s=this;return new Promise(function(h,c){var l=s.e.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?f.commandParameters.stopwatch.b():0,a=function(n){if(s.e.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(f.requestTelemetryData=n.RequestTelemetryData,f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-l),_Ewa.j.h(n.Errors))f&&(f.encounteredDeploymentErrors=!0),Diag.a.a(36538328,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.j.a(n.Errors,","));else if(_Ewa.j.b(n.Errors))Diag.a.a(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.j.a(n.Errors,",")),c(new _Ewa.ck(9,n.Errors,null,""));else if(n.Result){var t=n.Result;Diag.a.a(36229124,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");s.j(e,t.FloatingObjectId,n.StateId);h(_Ewa.lc.a(t.FloatingObjectId))}else Diag.a.a(36229125,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),c(new _Ewa.ck(9,n.Errors,null,""))},v=function(n){s.e.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-l);var t=_Ewa.U.a(n.b);Diag.a.a(36229126,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.j.a(t,","));c(new _Ewa.ck(9,t,null,""))};s.k(n,u,t,i,a,v,r,o)})},j:function(n,t,i){var r=this.e.b().a(_Ewa.ih,276,!1);if(r){var u=n+"_"+_Ewa.lc.a(t),f=this,e=function(){return!!_Ewa.L.a(f.e).b(u,null)};r.a(e,i,"PasteArt")}},l:function(n,t){!t||this.f.d(n,n.b+"_"+t)},a:function(n){var t=n,r=this,i=this;return this.i(t.i,t.b,t.e,t.k,t.j,t.h,t.c.b,t.d).then(function(n){return n},function(n){return i.l(t.c,t.d),Promise.reject(n)})},c:function(n,t,i){if(n||(n=_Ewa.g.a(_Ewa.b.a(this.e).a().a(),this.e)),_Ewa.b.a(this.e).bu(_Ewa.g.b(n),1))_Ewa.L.a(this.e).d(i,t,!0);else{var r=_Ewa.b.a(this.e).a().b().i(n,t,i),u=this;r.CW(function(n){var i=n.a();i?Diag.a.a(36459653,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",t):Diag.a.a(36459654,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",t)})}},k:function(n,t,i,r,u,f,e,o){var l=this.e.d().a().b(),s={};s.ShadowWorkbookBase64=t.shadowWorkbookBase64;s.FloatingObjectId=r;s.DestinationRanges=i?_Ewa.g.f(i):null;s.CopyPasteTargetType=2;s.ClientEstimationFloatingObjectId=o;var h=this,a=function(n,t){return o||h.e.J(),_Ewa.jG.b(h.e.d().a(),s,_Ewa.n.a(n,u),_Ewa.n.b(t,f),null,l,e)},y=this,v=function(){return new _Ewa.Hg(s)},c=new _Ewa.bd(503,0,a,0,v);c.u=1;this.e.g().a(c,n)}};_Ewa.Ad=function(n){this.e=n};_Ewa.Ad.prototype={e:null,f:null,h:null,g:15,b:function(n,t){this.f=n;this.h=t},a:function(){var n,t,i,r,u;return!this.f||!this.h?(Diag.a.a(37857495,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),""):(n=_Ewa.K.e(new _Ewa.gk(this.f),null),n.Id=_Ewa.lc.a(Common.O.a().a),n.Version=-1,n.IsClientEstimation=!0,t=this.i(n),!t)?null:(i=new _Ewa.gk(n),t.a.g().b(i),i.d=-1,r=_Ewa.L.a(this.e),r.s(i,t),u=r.b(n.Type+"_"+n.Id,null),u&&u.bU(this.h),r.d(n.Type,n.Id,!0),n.Id)},c:function(n){return this.e.a(312)&&n.c(this.e)&&!_Ewa.b.a(this.e).d()&&!_Ewa.b.a(this.e).i().e()},d:function(n,t){if(this.c(n)){var i=_Ewa.L.a(this.e).b(t,null);i&&(Diag.a.a(38012936,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",t,i.a().a),_Ewa.L.a(this.e).c(i,15,!0),i.h()&&i.W(i.h(),!1))}},i:function(n){var u,f,t,r,i;return n?_Ewa.b.a(this.e).a().b().e()?(u=_Ewa.b.a(this.e).a().b().d().a(),n.OriginDeltaX=u.q+this.g,n.OriginDeltaY=u.r+this.g,n.AbsoluteLeft=n.AbsoluteLeft+this.g,n.AbsoluteTop=n.AbsoluteTop+this.g,n.AbsoluteRight=n.AbsoluteRight+this.g,n.AbsoluteBottom=n.AbsoluteBottom+this.g,n.ZOrder=u.m+1,_Ewa.b.a(this.e).a().b().d().h()):!this.e.j()||!this.e.j().k()?(Diag.a.a(37857497,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null):(f=this.e.j().k(),t=_Ewa.b.a(this.e).U(f),!t)?(Diag.a.a(37857498,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",f.toString()),null):(r=_Ewa.m.l(t.d(),t.e().h()),i=t.c().w(f,2,!1),!r||!i)?(Diag.a.a(37857499,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!r,!i),null):(n.OriginDeltaX=i.a.a-r.x,n.OriginDeltaY=i.a.b-r.y,n.AbsoluteLeft=i.a.a,n.AbsoluteTop=i.a.b,n.AbsoluteRight=n.AbsoluteLeft+Math.abs(this.f.AbsoluteRight-this.f.AbsoluteLeft),n.AbsoluteBottom=n.AbsoluteTop+Math.abs(this.f.AbsoluteBottom-this.f.AbsoluteTop),n.ZOrder=this.f.ZOrder+100,new _Ewa.eS(t.c().b().d(t.b()),t.b())):(Diag.a.a(37857496,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null)}};_Ewa.Qy=function(n,t){this.b=this.a;this.m=t;this.c=n;this.q=_Ewa.ClientStringManager.a();this.e=new _Ewa.eb(n,_Ewa.b.a(n))};_Ewa.Qy.prototype={c:null,q:null,e:null,m:null,a:function(){return this.m},n:function(){return this.q.b(5)},shouldWaitForCopyToComplete:function(){return!1},onDeferredPasteStarted:function(){},onDeferredPasteCompleted:function(){},j:function(n){var t,r,i;return n.isExternalPaste=!0,n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.c.a(223)&&n.commandParameters.commandType!==20?(t=n.clipboardItems.getItem("text/html"),r=!isNullOrUndefined(t)&&!!t&&t.trim()!==this.n()&&t.startsWith("<"),r?(i=n.clipboardItems.getItem("copyId"),this.y(n,t,isUndefined(i)?null:i)):this.o(n)):this.o(n):Promise.reject(new _Ewa.ck(6,null,null,""))},o:function(n){var t=n.clipboardItems.getItem("text/plain"),i=!isNullOrUndefined(t)&&t.trim()===this.n();return i?Promise.reject(new _Ewa.ck(7,null,null,"")):(isNullOrUndefined(t)||(n.plainTextPayloadSize=t.length),n.isPlainTextPaste=!0,n.pasteResult="SystemClipboardPaste",n.payloadOrigin=_Ewa.cq.c(n)?"LegacyCrossSession":"External",n.payloadType="PlainText",Diag.a.a(39186568,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request..."),this.e.m(n.commandParameters.originalDestination,t,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n))},y:function(n,t,i){return n.htmlPayloadSize=t.length,n.isHtmlPaste=!0,n.pasteResult="SystemClipboardHtmlPaste",n.payloadType="Html",n.payloadOrigin=_Ewa.cq.c(n)?"LegacyCrossSession":"External",Diag.a.a(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request..."),this.e.l(n.commandParameters.originalDestination,t,i,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n)},r:function(n){var t={};return n&&(t.shadowWorkbookBase64=n.ShadowWorkbookBase64,t.shadowWorkbookSizeExceedsLimit=n.ShadowWorkbookSizeExceedsLimit,t.shadowWorkbookBlockedSize=n.ShadowWorkbookBlockedSize),t}};_Ewa.qM=function(n,t,i,r,u){_Ewa.qM.initializeBase(this,[n,r]);this.k=t;this.d=i;this.f=u||new _Ewa.qO(this.d);this.g=_Ewa.b.a(n);this.l=this.g.a();this.i=n.b().a(_Ewa.mS,168,!1)};_Ewa.qM.a=function(n,t){var i=n.commandParameters.originalDestination;return(t.a.o()&&t.a.k()===i.k()||t.a.n()&&t.a.i()===i.i())&&(i=n.commandParameters.expandDestination),i};_Ewa.qM.prototype={g:null,l:null,i:null,k:null,f:null,d:null,getSourceItem:function(){return new _Ewa.kn(this.l.a(),this.c.c().k().e(),this.c.c().e(),this.c.f().UserSessionId)},beforeSerialize:function(n){n.isSellectionAllowed=!1;n.isAsyncCopy=!1;n.isFromCache=!1;n.encounteredDeploymentErrors=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.clientSideCopyTime=0;var i=new _Ewa.bL(this.c.e()),t=n.sourceItem;i.d(t.a,this.g)&&(n.isSellectionAllowed=!0,this.e.c(t.a,n.commandParameters.commandType))},p:function(n){return this.g.b().j()&&_Ewa.b.j(this.g,n)},s:function(n,t,i,r){return n.commandParameters.ribbonCommandInfo.a===1804571062&&this.k.f(n,i.a,i.b,n.commandParameters.expandDestination,this.c.c().k().e(),t.commandParameters.commandType===1),this.z(n,i,_Ewa.g.a(r,this.c),t.commandParameters.commandType)},z:function(n,t,i,r){var u=_Ewa.g.a(t.a,this.c);return u.SheetName=t.b,n.pasteResult="SameSessionPaste",n.payloadOrigin="SameSession",n.payloadType="ActiveSelection",Diag.a.a(37003422,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request..."),this.e.h(n.commandParameters.ribbonCommandInfo,u,i,r,n.commandParameters.commandType,[n.commandParameters.stopwatch],n)}};_Ewa.qN=function(n){_Ewa.qN.initializeBase(this,[n])};_Ewa.qN.a=function(n){_Ewa.Y.a(5,new _Ewa.qN(n))};_Ewa.qN.prototype={l:function(){var n=this;_Ewa.e.cw(_Ewa.k.a(_Ewa.ew,this.h.b(),18,this.dm()),function(){n.k([_Ewa.b.a(n.h).bF()],null)},this.h.i(),3)}};_Ewa.ld=function(){};_Ewa.ld.prototype={a:function(){var n=window.clipboardPlatform;return n?n.createClipboardItems():null}};_Ewa.iC=function(){};_Ewa.iC.a=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.sourceRanges=t,h.destinationRanges=i,h.flags=r,_Ewa.f.a(n,"PasteRange",h,u,f,e,64,s)};_Ewa.iC.d=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.source=t,h.destination=i,h.copyId=r,_Ewa.f.a(n,"PasteHtml",h,u,f,e,64,s)};_Ewa.iC.b=function(n,t,i,r,u,f,e,o){var s=n.a(9,e);return s.destinationRange=t,s.source=i,_Ewa.f.a(n,"PasteString",s,r,u,f,64,o)};_Ewa.iC.c=function(n,t,i,r,u,f,e,o){var s=n.a(1,e);return s.sourceRanges=t,s.copyId=i,_Ewa.f.a(n,"GetRangeForClipboard",s,r,u,f,4,o)};_Ewa.Ae=function(){};_Ewa.Ae.a=function(n){if(!n){Diag.a.a(36701969,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.");return}n.isAsyncCopy=!1;n.isSellectionAllowed=!1;n.isFromCache=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.htmlSizeExceedsLimit=!1;n.clientSideCopyTime=0;n.encounteredDeploymentErrors=!1;n.shadowWorkbookSizeExceedsLimit=!1;n.copyTotalSizeExceedsLimit=!1};_Ewa.qO=function(n){this.d=n};_Ewa.qO.prototype={c:null,e:null,d:null,b:function(n){return this.c&&this.c.g(n)?this.f(this.e):null},a:function(n,t){this.c=n;this.e=this.f(t)},f:function(n){var t=this.d.a(),u=n.getItem("text/plain"),i,r;return u&&t.setItem("text/plain",u),i=n.getItem("data/shadow-workbook"),i&&t.setItem("data/shadow-workbook",i),r=n.getItem("text/html"),r&&t.setItem("text/html",r),t}};_Ewa.bR=function(n,t,i,r,u,f,e,o){this.y=Function.createDelegate(this,this.bd);this.C=Function.createDelegate(this,this.bl);this.H=Function.createDelegate(this,this.bm);this.B=Function.createDelegate(this,this.bk);this.A=Function.createDelegate(this,this.bg);this.z=Function.createDelegate(this,this.be);this.G=Function.createDelegate(this,this.bh);_Ewa.bR.initializeBase(this,[!1]);this.p=n;this.w=i;this.r=_Ewa.b.a(n);this.s=u;this.E=f;this.q=t;this.t=r;this.x=o===1&&this.p.a(313);this.br();this.u=this.p.b().a(_Ewa.qV,85,!1);Diag.a.b(24388233,0,!!this.u,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");e||(Diag.a.a(37033877,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),e="cpiDID");this.v=Common.e.e(e);this.F="CultureTag: "+_Ewa.ClientStringManager.a().d()+" HASH: ";_Ewa.v.f(this.p)&&this.q.addMetadataChangeListener("EwaJsMetadataChangeListenerId",this.G)};_Ewa.bR.i=function(n){var t=n.innerError;return t&&t.pasteErrorName?n.innerError:null};_Ewa.bR.h=function(n){var t=n.innerError;return t&&t.copyErrorName?n.innerError:null};_Ewa.bR.b=function(n){var t="",i,r;return n?(i=n,!i.errorName||(t=i.errorName,i.innerError&&(t+="_"+_Ewa.bR.b(i.innerError))),t||(r=n,t=r&&!!r.name?r.name:"UnknownError"),t):"UnknownError"};_Ewa.bR.c=function(n){return _Ewa.bR.a||(_Ewa.v.z(n)?_Ewa.bR.a="Slice6":_Ewa.v.m(n)?_Ewa.bR.a="Slice5":_Ewa.v.f(n)?_Ewa.bR.a="Slice4":_Ewa.v.e(n)?_Ewa.bR.a="Slice3":_Ewa.v.g(n)?_Ewa.bR.a="Slice2":_Ewa.v.c(n)&&(_Ewa.bR.a="Slice1")),_Ewa.bR.a};_Ewa.bR.prototype={p:null,r:null,q:null,w:null,u:null,t:null,s:null,E:null,v:0,F:null,x:!1,g:function(n){this.dn("cpiOSC",n)},o:function(n){this.dp("cpiOSC",n)},i:function(n){var r,u,i,t;return n.stopwatch=this.p.n().a("UserAction",_Ewa.x.a().b(n.ribbonCommandInfo.a)+"ClientSide"),r=!!_Ewa.cq.a(this.q),u=this,this.d("Copy/before/"+Common.j.c.toString(n.ribbonCommandInfo.b),!1,!1,!0,n.copyPasteTargetType).catch(function(){}),n.userHash=this.v,n.id=Common.O.a().a,i=this,t=this,this.t.onCopy(n).then(function(t){return t.isAsyncCopy||n.stopwatch.a(),Diag.a.a(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",_Ewa.gR.a(n,i.p.isChangeGateEnabled("OfficeVSO:3716448_CCPCleanupUserHashTraces"))),i.Y(t,r),Promise.resolve(!0)},function(i){var r=i,f=!1,s="none",o="Unknown",e=!0,h=-1,c="CopyError_",l=!1,a=null,u;return r&&(a=r.copyContext,h=r.reason,c+=_Ewa.bR.b(r),!r.message||(o=r.message),u=_Ewa.bR.h(r),u&&(u.copyErrorName===3?(f=!0,o=s="Async Copy canceled by the user.",e=!1):_Ewa.j.d(u.ewaErrors)&&(o=t.D(u.ewaErrors),_Ewa.j.g(u.ewaErrors)&&!t.p.isChangeGateEnabled("OfficeVSO:3633999_CCPChangeExpectedErrors")?(f=!0,s=_Ewa.j.a(u.ewaErrors,",")):_Ewa.j.c(u.ewaErrors,_Ewa.bR.d)?(f=!0,l=!0):_Ewa.j.c(u.ewaErrors,_Ewa.bR.f)&&(f=!0))),r.reason===13?(f=!0,e=!1):r.reason===11&&(e=!1)),f?Diag.a.a(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",e,s,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.gR.a(n,t.p.isChangeGateEnabled("OfficeVSO:3716448_CCPCleanupUserHashTraces"))):Diag.a.a(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",e,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.gR.a(n,t.p.isChangeGateEnabled("OfficeVSO:3716448_CCPCleanupUserHashTraces"))),e&&t.d("Copy/fail/"+Common.j.c.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){}),t.X(n,f,o,c,h,l,a),Promise.reject(i)})},n:function(n){if(n.stopwatch=this.p.n().a("UserAction",_Ewa.x.a().b(n.ribbonCommandInfo.a)+"ClientSide"),n.originalDestination=this.r.a().a(),n.expandDestination=this.I(n.originalDestination,n.commandType),this.h(n.commandType,n.expandDestination)||this.S()){n.userHash=this.v;n.id=Common.O.a().a;var t=this,i=this;return this.t.onPaste(n).then(function(i){return t.bj(i,n)},function(t){return i.bi(n,t)})}return Diag.a.a(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestination: {0}, CommandType: {1}, copyPasteTargetType="{2}"',n.expandDestination,n.commandType,n.copyPasteTargetType),Promise.resolve(!0)},S:function(){var n=_Ewa.cq.a(this.q);return!n||!n.sourceItem||Object.getType(n.sourceItem)!==_Ewa.gD?!1:!!_Ewa.b.a(this.p).a().b().e()&&this.p.Q(null,214)},a:function(){var n=_Ewa.cq.a(this.q);return!n||!n.commandParameters?0:n.commandParameters.copyPasteTargetType},l:function(){return!!_Ewa.cq.a(this.q)&&_Ewa.jU.a(_Ewa.cq.a(this.q),this.p)},d:function(n,t,i,r,u){var e,o,f,s,h,c;try{return(e=u,o=this.W(),!r&&o===2)?(Diag.a.a(36304158,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),Promise.reject(null)):(e||(e=o),f=this.p.n().a("UserAction","ClearCopyState"),s=f.d(),Diag.a.a(24150914,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),this.s.a(),this.bq(),h=this,c=this,this.t.onCancelCopy(t).then(function(){return f.a(),h.Q(n,s,!0,i,t,"","",f.b(),e),Promise.resolve(!0)},function(r){Diag.a.a(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",r?copyPasteInfra.getStringifiedError(r):"null");f.a();var o="CancelError_",h="Unknown",u=r;return u&&(o+=_Ewa.bR.b(u),!u.message||(h=u.message)),c.Q(n,s,!1,i,t,h,o,f.b(),e),Promise.reject(r)}))}catch(l){return Promise.reject(null)}},W:function(){var n=_Ewa.cq.a(this.q);return!n||!n.sourceItem?0:Object.getType(n.sourceItem)===_Ewa.gD?2:1},j:function(n,t,i,r){var s,e,u,f,o;return n.stopwatch=this.p.n().a("UserAction","DragDropClientSide"),s=this,this.d("DragDrop/before/"+Common.j.c.toString(n.ribbonCommandInfo.b),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=r?256:128,u={},u.encounteredDeploymentErrors=!1,this.p.isChangeGateEnabled("OfficeVSO:3661605_SetCommandParametersInDragDropCells")&&(u.commandParameters=n),n.userHash=this.v,n.id=Common.O.a().a,f=this,o=this,this.s.h(n.ribbonCommandInfo,_Ewa.g.a(t,this.p),_Ewa.g.a(i,this.p),1,e,[n.stopwatch],u).then(function(){return Diag.a.a(36975680,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',n.copyPasteTargetType),f.r.a().o(-1),f.ba(n,t,i,u),Promise.resolve(!0)},function(r){return Diag.a.a(36975681,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',r?copyPasteInfra.getStringifiedError(r):"null",n.copyPasteTargetType),o.bf(r,n,t,i,u)})},k:function(n,t){var r=_Ewa.cq.a(this.q),i,e,c,l,o;if(!r)return Diag.a.a(25518403,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!_Ewa.fS.a(r.sourceItem))return Diag.a.a(36824457,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),$$sc.a.a(Boolean,!1);if(i=r.sourceItem,!i)return Diag.a.b(25518404,0,!!i,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!i.c(this.p))return Diag.a.a(34981187,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),$$sc.a.a(Boolean,!1);var u=i.a,a=this.r.a().a(),f=this.I(a,n),s=this.m(),v=i.b,y=this.p.c().k().e(),h=_Ewa.g.a(u,this.p);return h.SheetName=v,e=_Ewa.g.a(f,this.p),e.SheetName=y,c=f.o()||u.o()?$$sc.a.a(_Ewa.mz,0):f.n()||u.n()?$$sc.a.a(_Ewa.mz,1):this.E.a(this.p,_Ewa.b.a(this.p).d()),l=this,o=this,c.CWR($$sc.a,function(n){return l.U(h,e,s,n.a(),t)}).CW(function(){s?o.s.a():o.d("InsertCopiedCutCells/success/"+Common.j.c.toString(t.b),!0,!1,!1,0)})},b:function(){var n=_Ewa.cq.a(this.q);return!!n&&_Ewa.fS.a(n.sourceItem)},m:function(){return this.P(-911352779)},c:function(){return this.P(-1985798686)},h:function(n,t){var i=new _Ewa.bL(this.p.e()),r=n===36,u=i.a(4),f=this.a()===2&&i.a(1),e=r&&u;return e||f||this.p.Q(t,1)},e:function(n,t){return this.s.g(n,t)},dispose:function(){_Ewa.cE.prototype.dispose.call(this);this.bu();_Ewa.v.f(this.p)&&this.q.removeMetadataChangeListener("EwaJsMetadataChangeListenerId")},f:function(n,t,i,r,u,f){var s,h,c,e,o,l;if(n.commandParameters.commandType!==516){if(i===u&&(s=t.l(this.r.q()),h=r.l(this.r.q()),s&&h)){c=_Ewa.g.a(s,this.p);c.SheetName=i;e=!0;o=!1;switch(n.commandParameters.ribbonCommandInfo.a){case 1804571062:e=!0;o=!1;break;case 237279923:case 808159687:e=!0;o=!0;break;case 1766348718:case-185374993:e=!1;o=!0}l=this.w.d(this.r,c,_Ewa.g.a(h,this.p),n.commandParameters.stopwatch,e,o);f&&this.w.f(s,!1);l&&(this.R(n.commandParameters.expandDestination),this.J("DoPasteClientEstimation/"+Common.j.c.toString(n.commandParameters.ribbonCommandInfo.b),n))}}else Diag.a.a(24417763,0,50,"RangeCopyPasteHandler.DoPasteClientEstimation: client estimation support only paste formatting.")},P:function(n){var t=_Ewa.cq.a(this.q),i;return t?(i=t.sourceItem,i&&!i.c(this.p))?(Diag.a.a(34981188,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):t.commandParameters.ribbonCommandInfo.a===n:!1},U:function(n,t,i,r,u){var f={};f.InsertDirection=r;f.SourceRange=n;f.DestRange=t;f.CopyCutOperation=i?0:1;var e=this.p.d().a(),h=this,o=function(n,t){return _Ewa.EZ.a(e,f,n,t,null,null)},c=this,s=function(){return new _Ewa.Hl(f)},l=this;return _Ewa.O.a(this.p.g(),o,function(n){return new _Ewa.G(104,0,n,0,s)},u)},bh:function(n){this.bt(n)&&(this.s.a(),Diag.a.a(38922268,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))},bt:function(n){var t=!n||!n.lastCopy;return t?!0:_Ewa.jU.a(n.lastCopy,this.p)},M:function(n,t,i,r){var u={};return u.a=this.p.f().UserSessionId,u.e=n.stopwatch.d(),u.c=_Ewa.x.a().b(n.ribbonCommandInfo.a),u.b=Common.j.c.toString(n.ribbonCommandInfo.b),u.d=n.id,u.f=t.toString(),u.g=i.toString(),u.l=n.stopwatch.b(),u.n=!1,u.o=n.copyPasteTargetType.toString(),u.p=r.encounteredDeploymentErrors,u},ba:function(n,t,i,r){var u=this.M(n,t,i,r);u.h=!0;_Ewa.x.a().a(47,u,!0)},Z:function(n,t,i,r,u,f,e,o){var s=this.M(n,t,i,o);s.h=!1;s.i=r;s.k=u;s.m=f;s.n=e;_Ewa.x.a().a(47,s,!0)},Q:function(n,t,i,r,u,f,e,o,s){var h={};h.a=this.p.f().UserSessionId;h.b=t;h.c=n;h.f=i;h.e=r;h.d=u;h.g=f;h.h=e;h.i=o;h.j=s.toString();_Ewa.x.a().a(48,h,!0)},Y:function(n,t){var i=this.L(n.commandParameters,n);i.l=!0;i.j=t;_Ewa.x.a().a(45,i,!0)},X:function(n,t,i,r,u,f,e){var o=this.L(n,e);o.l=!1;o.m=t;o.o=i;o.y=r;o.x=u;o.z=f;_Ewa.x.a().a(45,o,!0);Diag.a.a(42768481,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",o.y,o.x,o.m,o.z,o.o)},L:function(n,t){var i={};return i.a=this.p.f().UserSessionId,i.f=n.stopwatch.d(),i.g=n.id,i.c=_Ewa.x.a().b(n.ribbonCommandInfo.a),i.b=Common.j.c.toString(n.ribbonCommandInfo.b),i.q=n.stopwatch.b(),i.bd=_Ewa.bR.c(this.p),i.bg=n.copyPasteHandlerName,i.bj=isNullOrUndefined(n.ribbonCommandInfo.c)?null:Common.J.toString(n.ribbonCommandInfo.c),i.s=n.copyPasteTargetType.toString(),i.bc=_Ewa.fC.b(n.copyPasteTargetType),i.z=!1,i.bk=this.p.a(66),t&&(this.p.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(i.bl=t.id,i.bm=t.serverRequestTimeInMs,t.requestTelemetryData&&(i.bn=t.requestTelemetryData.EcsOperationDuration,i.bo=t.requestTelemetryData.EcsRequestDuration,i.bp=t.requestTelemetryData.WfeRequestDuration)),i.d=t.sourceItem?t.sourceItem.toString():null,i.e=_Ewa.fS.a(t.sourceItem)?t.sourceItem.a.y():-1,i.h=t.isAsyncCopy,i.i=t.isFromCache,i.k=t.isSellectionAllowed,i.r=t.plainTextPayloadSize,i.u=t.htmlPayloadSize,i.v=t.htmlSizeExceedsLimit,i.w=t.copyTotalSizeExceedsLimit,i.t=t.shadowWorkbookPayloadSize,i.p=t.clientSideCopyTime,i.ba=t.encounteredDeploymentErrors,i.bb=t.shadowWorkbookSizeExceedsLimit,i.be=t.syncClipboardItemsKeys,i.bf=t.asyncClipboardItemsKeys,i.bh=this.K(t.succeededPopulatingSystemClipboardSync),i.bi=this.K(t.succeededPopulatingSystemClipboardAsync)),i},R:function(n){var t=this.r.a().a().by(n)?this.r.a().c():n.e();this.r.a().e(n,t,0,0,!0,"",!1,!0)},N:function(n,t,i){var r={},u;return r.a=this.p.f().UserSessionId,r.g=n.stopwatch.d(),r.p=n.stopwatch.b(),this.p.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&t&&(r.br=t.id,r.bs=t.serverRequestTimeInMs,t.requestTelemetryData&&(r.bt=t.requestTelemetryData.EcsOperationDuration,r.bu=t.requestTelemetryData.EcsRequestDuration,r.bv=t.requestTelemetryData.WfeRequestDuration)),r.t=n.copyPasteTargetType.toString(),r.bh=_Ewa.fC.b(n.copyPasteTargetType),r.bm=n.copyPasteHandlerName,r.i=n.expandDestination.toString(),r.h=n.originalDestination.toString(),r.e=n.id,r.d=n.commandType,r.c=_Ewa.x.a().b(n.ribbonCommandInfo.a),r.b=Common.j.c.toString(n.ribbonCommandInfo.b),r.bb=!1,r.bc=!1,r.bk=_Ewa.bR.c(this.p),r.bo=isNullOrUndefined(n.ribbonCommandInfo.c)?null:Common.J.toString(n.ribbonCommandInfo.c),r.bq=this.p.a(66),this.p.isChangeGateEnabled("OfficeVSO:3520161_CCPLogCopyIdOnLegacyCrossSessionPaste")?t?(u=t.copyContextSnapshot,u&&!t.isExternalPaste?(r.f=u.commandParameters.id,r.j=u.sourceItem.toString(),r.k=_Ewa.fS.a(u.sourceItem)?u.sourceItem.a.y():-1,r.bc=u.commandParameters.commandType===1):t.clipboardItems?r.f=t.clipboardItems.getItem("copyId"):Diag.a.a(50647260,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null")):Diag.a.a(50647261,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null"):i&&(r.f=i.commandParameters.id,r.j=i.sourceItem.toString(),r.k=_Ewa.fS.a(i.sourceItem)?i.sourceItem.a.y():-1,r.bc=i.commandParameters.commandType===1),r},bb:function(n,t,i,r,u,f,e,o,s){var h=this.N(n,o,s);h.l=!1;h.m=t;h.o=i;h.y=r;h.ba=u;h.z=f;h.bb=e;o?(h.u=_Ewa.cq.b(o)||!o.copyContextSnapshot,h.be=!h.u&&_Ewa.jU.a(o.copyContextSnapshot,this.p),h.bf=o.shadowWorkbookSizeExceedsLimit,h.r=o.shadowWorkbookPayloadSize,h.s=o.htmlPayloadSize,h.bl=_Ewa.fC.a(o.clipboardItems),h.x=o.activeSelectionType,h.bn=o.isSameSession,h.bi=o.payloadOrigin,h.bj=o.payloadType,this.p.isChangeGateEnabled("OfficeVSO:3552997_CCPLogPasteFromExternalOrigin")&&(h.bp=o.externalAppSource)):h.be=_Ewa.jU.a(s,this.p);_Ewa.x.a().a(46,h,!0);Diag.a.a(42768482,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",h.ba,h.z,h.m,h.bb,h.o)},bc:function(n,t){var i=this.N(n.commandParameters,n,t);i.u=n.isExternalPaste;i.l=!0;i.q=n.plainTextPayloadSize;i.r=n.shadowWorkbookPayloadSize;i.s=n.htmlPayloadSize;i.v=n.isClipboardDataContainShadowWorkbook;i.w=n.isShadowWorkbookParsedSuccessfully;i.x=n.activeSelectionType;i.y=n.pasteResult;i.bd=n.encounteredDeploymentErrors;i.bf=n.shadowWorkbookSizeExceedsLimit;i.bg=_Ewa.cq.c(n);i.bl=_Ewa.fC.a(n.clipboardItems);i.bn=n.isSameSession;i.bi=n.payloadOrigin;i.bj=n.payloadType;this.p.isChangeGateEnabled("OfficeVSO:3552997_CCPLogPasteFromExternalOrigin")&&(i.bp=n.externalAppSource);this.p.a(219)&&(i.be=!n.isSameSession&&!n.isExternalPaste);_Ewa.x.a().a(46,i,!0)},br:function(){this.p.e().c(this.z);this.p.e().x(this.A);this.p.g().b(this.B);this.p.D(this.H);_Ewa.b.a(this.p).e().c(this.C)},bu:function(){this.p&&this.p.e()&&(this.p.e().e(this.z),this.p.e().D(this.A));this.p&&this.p.g()&&this.p.g().e(this.B);this.r&&this.r.e()&&this.r.e().d(this.C)},bi:function(n,t){var i=null,o=t,r=!1,u=null,e="UnknownFailure",c=-1,f="Unknown",s="PasteError_",l=!1,v=_Ewa.cq.a(this.q),y,a,h;return(n.clearStateOnFinish||n.clearSystemClipboard)&&(y=this,this.d("Paste/fail/"+Common.j.c.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){})),o&&(c=o.reason,s+=_Ewa.bR.b(o),!o.message||(f=o.message),i=_Ewa.bR.i(o),i&&(i.pasteErrorName===1?(r=!0,e="CopyPasteLengthTooLongPopup",f=u="The pasted content is too long. Popup a dialog to the user.",Diag.a.a(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',u,n.copyPasteTargetType),a=_Ewa.bc.a(1,0,23,569,0,1306609195,"CopyPasteOversizeError"),h=new _Ewa.dt(this.p,a),h.B(),h.v(!1)):i.pasteErrorName===7?(r=!0,_Ewa.v.f(this.p)?(e="No-Op",f=u="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Diag.a.a(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):(e="AsyncCopyFailurePopup",f=u="An async copy was unable to populate the clipboard. Popup a dialog to the user.",Diag.a.a(25216993,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',u,n.copyPasteTargetType),this.bo())):i.pasteErrorName===8?(r=!0,e="UseShortcutsPopup",f=u="Unable to paste content from the system clipboard. Popup dialog to the user.",Diag.a.a(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',u,n.copyPasteTargetType),this.bp()):i.pasteErrorName===6?(r=!0,e="No-Op",f=u="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Diag.a.a(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):i.pasteErrorName===16?(r=!0,e="No-Op",f=u="Paste has failed because the previous copy has failed",Diag.a.a(40147082,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',u,n.copyPasteTargetType,copyPasteInfra.getStringifiedError(i))):_Ewa.j.d(i.ewaErrors)?(_Ewa.j.g(i.ewaErrors)||_Ewa.j.c(i.ewaErrors,_Ewa.j.m())?(r=!0,e="CommunicationError",u=_Ewa.j.a(i.ewaErrors,","),Diag.a.a(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',f,n.copyPasteTargetType)):_Ewa.j.c(i.ewaErrors,_Ewa.bR.g)?(r=!0,e="SavingWorkbookError",u=_Ewa.j.a(i.ewaErrors,","),Diag.a.a(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',f,n.copyPasteTargetType)):_Ewa.j.c(i.ewaErrors,_Ewa.bR.d)&&(r=!0,l=!0,e="OperationSucceededWithAlert",u=_Ewa.j.a(i.ewaErrors,","),Diag.a.a(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',f,n.copyPasteTargetType)),r||(f=this.D(i.ewaErrors),r=this.O(o))):i.pasteErrorName===11&&(r=!0,e="No-Op",f="Paste has failed because user try copy cross-session oart object")),o.reason===15&&(r=!0,e="No-Op",f="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished."),this.p.isChangeGateEnabled("OfficeVSO:3633999_CCPChangeExpectedErrors")&&_Ewa.i.a(s,"PasteError_FailedToReadFromClipboard_UserHashMismatchError",!1)&&(r=!0,e="No-Op",f="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")),r||Diag.a.a(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',o?copyPasteInfra.getStringifiedError(o):"null",n.copyPasteTargetType),this.bb(n,r,f,e,s,c,l,o.pasteContext,v),Promise.reject(t)},bj:function(n,t){var r,i,u;return Diag.a.a(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',t.copyPasteTargetType),this.bn(t.copyPasteTargetType,n)&&(r=null,i=n.PastedRange,i?r=new _Ewa.p(i.FirstRow,i.FirstColumn,i.LastRow,i.LastColumn,!1,!1):n.isExternalPaste||(r=t.expandDestination),this.bs(n.isExternalPaste,t.originalDestination,r)),u=_Ewa.cq.a(this.q),this.J("Paste/success/"+Common.j.c.toString(t.ribbonCommandInfo.b),n),this.bc(n,u),this.x&&(!t.isKeyboardEvent||_Ewa.cq.c(n))&&(this.p.c().c().a(66)?(Diag.a.a(42824788,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.x=!1,this.T()):Diag.a.a(42824789,0,15,"CopyPasteInfrastructure.OnPasteSuccess: unexpected: shouldShowLocalStorageDisabledNotification is true, AnonymousUser is false")),Promise.resolve(!0)},bn:function(n,t){return n===1||t.payloadType==="PlainText"||this.p.a(223)&&t.payloadType==="Html"},J:function(n,t){var i,r,u,f;(u=this.V(t,r={val:i}),i=r.val,u)&&(f=this,this.d(n,i,!1,!1,t.commandParameters.copyPasteTargetType).catch(function(){}))},bd:function(n,t){Diag.a.a(37364764,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",n,t);this.r.o()},bo:function(){var n=this.u.a();n.a(!1,!1,!1,this.y,this.p.isChangeGateEnabled("OfficeVSO:3633884_CtrlShiftVShortCut"))},bp:function(){var n=this.u.a();n.a(!0,!1,!1,this.y,this.p.isChangeGateEnabled("OfficeVSO:3633884_CtrlShiftVShortCut"))},bf:function(n,t,i,r,u){Diag.a.a(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",n?copyPasteInfra.getStringifiedError(n):"null");var o=!1,s=!1,f=!1,e="Unknown",h="DragAndDropError_";return n&&(h+=_Ewa.bR.b(n),_Ewa.j.d(n.ewaErrors)?(e=this.D(n.ewaErrors),_Ewa.j.c(n.ewaErrors,_Ewa.bR.d)&&(o=!0),_Ewa.j.c(n.ewaErrors,_Ewa.bR.e)&&(s=f=!0)):n.message&&(e=n.message)),f||(f=this.O(n)),s?this.r.a().o(-1):this.s.e(r),this.Z(t,i,r,f,e,h,o,u),Promise.reject(n)},I:function(n,t){var r=n,i=_Ewa.cq.a(this.q),u;return i&&_Ewa.fS.a(i.sourceItem)&&(u=i.sourceItem,r=this.s.f(t,u.a,n)),r},bq:function(){this.dk("cpiOSC",null,null)},bs:function(n,t,i){if(i){var r=this.r.a().a()===t;r?(this.R(i),Diag.a.a(24150919,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",i)):Diag.a.a(24150920,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestination: {0}",t)}},V:function(n,t){var i,r;if((t.val=!0,n.isPlainTextPaste||n.isHtmlPaste)||_Ewa.cq.d(n))return t.val=!1,!0;if(i=n.copyContextSnapshot,n.commandParameters.clearStateOnFinish)return!0;if(i&&_Ewa.fS.a(i.sourceItem)){if(r=i.sourceItem,!r.c(this.p))return!1;var u=i.commandParameters.ribbonCommandInfo.a===-1985798686,f=r.a,e=n.commandParameters.expandDestination,o=this.p.c().k().e(),s=r.b,h=s===o&&!!e.l(f);return u||h}return!1},bm:function(n,t){if(!t.b&&!t.c){var i=this;this.d("OnWorkbookOpened",!1,!1,!1,0).catch(function(){})}},be:function(n,t){var r=_Ewa.cq.a(this.q),i=this.s.b(r);i&&(t.a&&t.a.e()===i.b&&i.c(this.p)?this.s.c(i.a,r.commandParameters.commandType):this.s.a())},bg:function(n,t){var r=_Ewa.cq.a(this.q),i=this.s.b(r),u;i&&t.a&&t.a.e()===i.b&&i.c(this.p)&&(u=this,this.d("OnItemDeleting",!1,!1,!1,0).catch(function(){}))},bl:function(){var t=_Ewa.cq.a(this.q),n=this.s.b(t),i;n&&n.c(this.p)&&(i=this,this.d("OnStartEdit",!1,!1,!1,0).catch(function(){}))},bk:function(n,t){if(t.b===1&&t.a.a.c()&2){var i=this;this.d("OnQueueItemChanged/ItemRemoved",!1,!1,!1,0).catch(function(){})}},D:function(n){var t=_Ewa.j.O(n,"_");return this.F+Common.e.e(t).toString()},O:function(n){var t=_Ewa.bR.b(n);return!!t&&_Ewa.i.j(t,"MergedCellOverlap")},T:function(){var t=Common.c.f()?272:Common.c.m()?273:274;var i=_Ewa.bc.a(1,2,270,271,t,530046625,"ActivateLocalStorage"),n=_Ewa.k.b(_Ewa.cF,this.p.b(),4,3),r=this;_Ewa.e.cw(n,function(){n.a().a(33,i)},this.dm(),3)},K:function(n){return isNullOrUndefined(n)?"NotCalled":n?"Success":"Failed"}};_Ewa.qP=function(n){_Ewa.qP.initializeBase(this);this.h=n;this.n=_Ewa.ClientStringManager.a();this.j()};_Ewa.qP.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.cR),254,new _Ewa.qP(n))};_Ewa.qP.prototype={h:null,n:null,b:function(){var i=_Ewa.t.e([50,51],4,!1),t=_Ewa.k.a(_Ewa.ew,this.h.b(),18,this.h.i()),n=this;_Ewa.e.cw(_Ewa.e.ws([t,i],this.dm(),3),function(){var r=new _Ewa.ms,i=null;n.o(r).then(function(u){var f,e;i=u.b;f=copyPasteInfra.createCopyPasteInfra(i,new _Ewa.Af(n.h),r,n.h);Diag.a.b(24970909,0,!!n.h.f(),"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Diag.a.b(24970910,0,!!n.h.f()&&!!n.h.f().DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");e=i.getMetadataManager();n.i(new _Ewa.bR(n.h,e,t.a(),f,new _Ewa.eb(n.h,_Ewa.b.a(n.h)),new _Ewa.Ag,n.h.f().DocumentHostInfo.UserId,i.getInitializationError()));u.a?Diag.a.a(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}, IncreasingCipboardLimitEnabled = {5}",_Ewa.bR.c(n.h),u.a.dataClipboardStrategyType,JSON.stringify(u.a.dataClipboardCapabilities),u.a.clipboardStrategiesToInitialize[0].clipboardStrategyType===u.a.dataClipboardStrategyType,isNullOrUndefined(window.bsqmXLSPageLoadStartTime)?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString(),n.h.a(66)):Diag.a.b(41731932,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(t){Diag.a.b(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",_Ewa.bR.c(n.h),t?copyPasteInfra.getStringifiedError(t):"null")})},this.dm(),3)},dispose:function(){_Ewa.cE.prototype.dispose.call(this)},o:function(n){var i=null,u=window.clipboardPlatform,o,s,a,v;if(u&&(i=u.getClipboardPlatformEnvironment()),!i)return Diag.a.b(24970911,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);var t=this.h.f(),h=[t.OfficeOnlineChromeExtensionId,t.ChromeClipboardAccessExtensionId],c=this.n.b(5),f=this.h.z().a(56),e=!f&&this.h.z().a(5)&&_Ewa.v.f(this.h),r=this.h.w().d(),l=!!r&&(r.c()||r.p()||r.e());return l&&(e=!1),o=!f,s=this.q(e,o),Diag.a.b(40380624,0,!!t.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null"),a=this,v=this,i.init(this.h,n,h,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardOverrideOrigin,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,c,t.MachineCluster,new _Ewa.qR,s,t.DocumentHostInfo.UserId,t.ClipboardTtlInMS,this.h.a(483),t.UserSessionId).then(function(n){var t;return t=new _Ewa.qP.b,t.b=i,t.a=n,t},function(n){return Promise.reject(n)})},q:function(n,t){var i=[];return this.h.isChangeGateEnabled("OfficeVSO:3657687_CheckPlainTextBeforeLoadFilesFromClipboard")?(n&&t&&Array.add(i,this.p(6)),t&&(Array.add(i,this.m(7)),Array.add(i,this.m(0)))):(n&&t&&Array.add(i,this.l(6)),t&&(Array.add(i,this.k(7)),Array.add(i,this.k(0)))),n&&Array.add(i,this.l(5)),Array.add(i,this.k(4)),Diag.a.a(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",n,t,i?i.join(","):"[]"),i},l:function(n){var i=this.h.f(),t={};return t.clipboardStrategyType=n,t.sessionId=i.UserSessionId,t.useSharedClipboardIframe=!0,t.sharedClipboardHostingApp=i.SharedClipboardHostingApp,t.sharedClipboardHostingApps=i.SharedClipboardHostingApps,t.sharedClipboardHostingEnvironments=i.SharedClipboardHostingEnvironments,t.sharedClipboardOverrideOrigin=i.SharedClipboardOverrideOrigin,t.sharedClipboardSchemaVersion=i.SharedClipboardSchemaVersion,t.sharedClipboardExpirationInMinutes=i.SharedClipboardExpirationInMinutes,t.wacCluster=i.MachineCluster,t},p:function(n){var t={};return t.clipboardStrategyType=n,t.localStorageStrategyParameters=this.l(5),t.systemClipboardStrategyParameters=this.m(0),t},m:function(n){var t={};return t.clipboardStrategyType=n,t.skipFilesIfPlainTextExists=!0,t},k:function(n){var t={};return t.clipboardStrategyType=n,t}};_Ewa.qP.b=function(){};_Ewa.qP.b.prototype={b:null,a:null};_Ewa.eb=function(n,t){this.n=n;this.o=t};_Ewa.eb.d=function(n,t,i,r,u,f,e,o,s){var l=n.d().a().b(),h=i?_Ewa.g.f(i):null,c=r?_Ewa.g.f(r):null,a=function(t,i){return n.J(),_Ewa.iC.a(n.d().a(),h,c,u,_Ewa.n.a(t,e),_Ewa.n.b(i,o),f,l,s)},v=function(){return new _Ewa.Hh(h,c,u)},y=new _Ewa.bd(506,0,a,1,v);n.g().a(y,t)};_Ewa.eb.b=function(n,t,i,r,u,f,e){if(f.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(t.requestTelemetryData=n.RequestTelemetryData,t.serverRequestTimeInMs=t.commandParameters.stopwatch.b()-u),_Ewa.j.b(n.Errors))_Ewa.j.h(n.Errors)?(t&&(t.encounteredDeploymentErrors=!0),Diag.a.a(36538329,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.j.a(n.Errors,","))):r(new _Ewa.ck(5,n.Errors,null,""));else if(n.Result){var o=n.Result;o.SheetMultiRange&&o.SheetMultiRange.Ranges&&o.SheetMultiRange.Ranges.length&&(t.PastedRange=_Ewa.g.p(o.SheetMultiRange.Ranges[0],o.SheetMultiRange.SheetName));i(!0)}else i(e?e:!0)};_Ewa.eb.e=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.d().a().b(),a=function(t,a){n.J();var v=_Ewa.eb.c(i,r,s,h,c);return _Ewa.jG.b(n.d().a(),v,_Ewa.n.a(t,f),_Ewa.n.b(a,e),u,l,o)},v=new _Ewa.bd(503,0,a,1,null);n.g().a(v,t)};_Ewa.eb.c=function(n,t,i,r,u){var f={};return f.ShadowWorkbookBase64=n.shadowWorkbookBase64,f.SourceRanges={},f.SourceRanges.Ranges=new Array(1),f.SourceRanges.Ranges[0]={},f.SourceRanges.Ranges[0].FirstRow=n.rangeRowStart,f.SourceRanges.Ranges[0].LastRow=n.rangeRowEnd,f.SourceRanges.Ranges[0].FirstColumn=n.rangeColumnStart,f.SourceRanges.Ranges[0].LastColumn=n.rangeColumnEnd,f.DestinationRanges=t?_Ewa.g.f(t):null,f.CopyPasteTargetType=1,f.PasteType=i,f.CopyOperationId=r,f.PasteId=u,f.SourceClientPath=n.sourceClientPath,f.SourceSheetName=n.sourceSheetName,f.SourceWorkbookName=n.sourceWorkbookName,f};_Ewa.eb.a=function(n,t,i){var r=i.g();return r.i()<t&&(r.d=Math.min(1048576,r.a+t-1)),r.k()<n&&(r.c=Math.min(16384,r.b+n-1)),r};_Ewa.eb.prototype={n:null,o:null,j:function(){return this.n.a(66)?this.n.f().MaxCopyPasteLength:102400},d:function(n,t,i,r,u,f){var e=_Ewa.g.d(n,this.n),o=this.n.d().a().b(),s=this,h=function(n,h){return _Ewa.iC.c(s.n.d().a(),e,f,_Ewa.n.a(n,i),r?_Ewa.n.b(h,r):h,t,o,u)};this.n.g().a(new _Ewa.bd(504,0,h,16,null),t)},i:function(n,t,i,r,u){var f=_Ewa.g.a(n,this.n),e=this.n.d().a().b(),o=this,s=function(n,s){var h={};return h.CopyPasteTargetType=1,h.SourceRanges=_Ewa.g.f(f),h.CopyOperationId=t.id,_Ewa.jG.a(o.n.d().a(),h,_Ewa.n.a(n,i),r?_Ewa.n.b(s,r):s,t.ribbonCommandInfo,e,u)};this.n.g().a(new _Ewa.bd(505,0,s,16,null),t.ribbonCommandInfo)},k:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var c=f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?u.commandParameters.stopwatch.b():0,l=function(n){_Ewa.eb.b(n,u,e,o,c,f.n,null)},a=function(n){f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c);var t=_Ewa.U.a(n.b);o(new _Ewa.ck(5,t,null,""))},s=2,h;u.commandParameters.commandType===20&&(s=16);u.commandParameters.commandType===36&&(s=32);_Ewa.v.m(f.n)&&u.commandParameters.commandType===68&&(s=64);_Ewa.v.l(f.n)&&u.commandParameters.commandType===1028&&(s=1024);h=null;u.copyContextSnapshot&&u.copyContextSnapshot.commandParameters&&(h=u.copyContextSnapshot.commandParameters.id);_Ewa.eb.e(f.n,n,i,t,null,l,a,r,s,h,u.commandParameters.id)})},h:function(n,t,i,r,u,f,e){var o=this;return new Promise(function(s,h){var c=o.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?e.commandParameters.stopwatch.b():0,l=function(n){_Ewa.eb.b(n,e,s,h,c,o.n,null)},a=function(n){o.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(e.serverRequestTimeInMs=e.commandParameters.stopwatch.b()-c);var t=_Ewa.U.a(n.b);h(new _Ewa.ck(5,t,null,""))},v=r,y=-5&u,p=v|y;_Ewa.eb.d(o.n,n,t,i,p,null,l,a,f)})},l:function(n,t,i,r,u,f){var e=this;return new Promise(function(o,s){if(!t)o("");else if(t.length>4194304)Diag.a.a(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}",t.length,4194304),s(new _Ewa.ck(1,null,null,""));else{var h=function(r,h){e.n.J();var c=e.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?f.commandParameters.stopwatch.b():0,l=_Ewa.n.a(r,function(n){_Ewa.eb.b(n,f,o,s,c,e.n,t)}),a=_Ewa.n.b(h,function(n){e.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-c);var t=_Ewa.U.a(n.b);s(new _Ewa.ck(3,t,null,""))}),v=e.n.d().a().b(),y=_Ewa.g.a(n,e.n);return _Ewa.iC.d(e.n.d().a(),t,y,i,l,a,null,v,u)},c=new _Ewa.bd(204,0,h,1,null);e.n.g().a(c,r)}})},m:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var h,v,p;if(!t||(t=_Ewa.i.i(t,"\n","\r")),!t)e("");else if(h=f.j(),t.length>h)Diag.a.a(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,h),o(new _Ewa.ck(1,null,null,""));else{var c,l,a,s=_Ewa.g.a(n,f.n),w=!f.n.c().b()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.i.k(t),y=f.n.d().a().b();w?(a=526,v=_Ewa.bf.b(t,!0),c=function(i,h){var c=f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?u.commandParameters.stopwatch.b():0,l=_Ewa.n.a(i,function(n){f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(u.requestTelemetryData=n.RequestTelemetryData,u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c);n.Errors&&n.Errors.length>0?o(new _Ewa.ck(2,n.Errors,null,"")):e(t)}),a=_Ewa.n.b(h,function(n){f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c);var t=_Ewa.U.a(n.b);o(new _Ewa.ck(2,t,null,""))});return f.n.J(),_Ewa.f.c(f.n.d().a(),s,t,v,!1,!1,63,l,a,n,y,r)},l=function(){return new _Ewa.lP(s,t,v)}):(a=180,c=function(n,i){f.n.J();var h=f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?u.commandParameters.stopwatch.b():0,c=_Ewa.n.a(n,function(n){_Ewa.eb.b(n,u,e,o,h,f.n,t)}),l=_Ewa.n.b(i,function(n){f.n.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-h);var t=_Ewa.U.a(n.b);o(new _Ewa.ck(4,t,null,""))});return _Ewa.iC.b(f.n.d().a(),s,t,c,l,null,y,r)},l=function(){return new _Ewa.Hi(s,t)});p=new _Ewa.bd(a,0,c,1,l);f.n.g().a(p,i)}})},c:function(n,t){if(this.o.c().s()&16){var i=[t===1?4:5];this.o.j().c(i,null,null);this.o.j().a(n,i,!0);this.o.j().e(!0,!0)}},a:function(){var n=[4,5];this.o.j().b(n);this.o.j().a(null,n,!0);this.o.a().d()===1&&this.o.cT(!1)},f:function(n,t,i){var r;if(this.n.a(65)){if(36===n)return i.m()?_Ewa.eb.a(t.k(),t.i(),i):i.g();if(n===516){t=t.g();var u=t.i(),f=t.k(),e=t.a,o=t.b;t.d=Math.min(1048576,e+f-1);t.c=Math.min(16384,o+u-1)}var s=!(i.k()%t.k())&&!(i.i()%t.i()),h=i.J()&&!(i.k()%t.k()),c=i.G()&&!(i.i()%t.i());return h||c?r=_Ewa.eb.a(t.k(),t.i(),i):s?r=i.g():(r=i.g(),r.d=Math.min(1048576,r.a+t.i()-1),r.c=Math.min(16384,r.b+t.k()-1)),r}return 516===n?_Ewa.eb.a(t.i(),t.k(),i):36!==n||i.m()?_Ewa.eb.a(t.k(),t.i(),i):i.g()},e:function(n){var t=this.o.a();t.e(n,n.e(),0,0,!0,"",!1,!0);t.o(-1)},b:function(n){if(n&&n.sourceItem){if(!_Ewa.fS.a(n.sourceItem))return null;var t=n.sourceItem;if(t&&t.a)return t}return null},g:function(n,t){return(Diag.a.b(33863620,0,!!n,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null"),t&&"SourceControlId"in t)?!1:n.d?!1:n.b===1}};_Ewa.qQ=function(n){this.a=new _Ewa.u(!0);this.b=n};_Ewa.qQ.prototype={b:null,d:function(n){if(this.a.d(n.id)||this.a.c(n.id,!0),this.a.a.length>0){var t=_Ewa.k.b(_Ewa.cF,this.b.b(),4,3),i=this;_Ewa.e.cw(t,function(){t.a().a(26,null)},this.b.i(),3)}},c:function(n){var i=this.a.a.length>0,t,r;this.a.d(n.id)&&this.a.e(n.id);i&&!this.a.a.length&&(t=_Ewa.k.b(_Ewa.cF,this.b.b(),4,3),r=this,_Ewa.e.cw(t,function(){t.a().b(26)},this.b.i(),3))}};_Ewa.qR=function(){this.k={"SourceItemType.Range":0,"SourceItemType.Art":1};this.d={};this.g={"FloatingObjectType.Unknown":99,"FloatingObjectType.CardView":6,"FloatingObjectType.Chart":0,"FloatingObjectType.Group":7,"FloatingObjectType.Image":1,"FloatingObjectType.InteractiveReport":4,"FloatingObjectType.ModernOfficeExtension":3,"FloatingObjectType.Shape":5,"FloatingObjectType.Slicer":2,"FloatingObjectType.Unsupported":100};this.e={"99":"FloatingObjectType.Unknown","6":"FloatingObjectType.CardView","0":"FloatingObjectType.Chart","7":"FloatingObjectType.Group","1":"FloatingObjectType.Image","4":"FloatingObjectType.InteractiveReport","3":"FloatingObjectType.ModernOfficeExtension","5":"FloatingObjectType.Shape","2":"FloatingObjectType.Slicer","100":"FloatingObjectType.Unsupported"};this.j={"RibbonCommand.Copy":-911352779,"RibbonCommand.Cut":-1985798686};this.f={"-911352779":"RibbonCommand.Copy","-1985798686":"RibbonCommand.Cut"};this.i={"InputManager.InputMethod.NotDefined":-1,"InputManager.InputMethod.Unknown":0,"InputManager.InputMethod.Keyboard":1,"InputManager.InputMethod.Mouse":2,"InputManager.InputMethod.Touch":3,"InputManager.InputMethod.CrossSlide":9};this.b={};this.h={"FrameMode.None":0,"FrameMode.Reading":1,"FrameMode.Edit":2};this.c={};this.l={"UILocation.Unknown":0,"UILocation.UpperRibbon":1,"UILocation.Ribbon":2,"UILocation.QAT":3,"UILocation.Jewel":4,"UILocation.NavigationPane":5,"UILocation.KeyboardShortcut":6,"UILocation.StatusBar":7,"UILocation.Dialog":8,"UILocation.Floatie":9,"UILocation.NotificationBar":10,"UILocation.StandaloneCuiRoot":11,"UILocation.TaskPane":12,"UILocation.HeroDock":13,"UILocation.ContextMenu":19,"UILocation.DialogMenu":20,"UILocation.Toolbar":26,"UILocation.Canvas":30};this.a={};this.b[Common.j.c.toString(-1)]="InputManager.InputMethod.NotDefined";this.b[Common.j.c.toString(0)]="InputManager.InputMethod.Unknown";this.b[Common.j.c.toString(1)]="InputManager.InputMethod.Keyboard";this.b[Common.j.c.toString(2)]="InputManager.InputMethod.Mouse";this.b[Common.j.c.toString(3)]="InputManager.InputMethod.Touch";this.b[Common.j.c.toString(9)]="InputManager.InputMethod.CrossSlide";this.c[Common.bs.toString(0)]="FrameMode.None";this.c[Common.bs.toString(1)]="FrameMode.Reading";this.c[Common.bs.toString(2)]="FrameMode.Edit";this.a[Common.J.toString(0)]="UILocation.Unknown";this.a[Common.J.toString(1)]="UILocation.UpperRibbon";this.a[Common.J.toString(2)]="UILocation.Ribbon";this.a[Common.J.toString(3)]="UILocation.QAT";this.a[Common.J.toString(4)]="UILocation.Jewel";this.a[Common.J.toString(5)]="UILocation.NavigationPane";this.a[Common.J.toString(6)]="UILocation.KeyboardShortcut";this.a[Common.J.toString(7)]="UILocation.StatusBar";this.a[Common.J.toString(8)]="UILocation.Dialog";this.a[Common.J.toString(9)]="UILocation.Floatie";this.a[Common.J.toString(10)]="UILocation.NotificationBar";this.a[Common.J.toString(11)]="UILocation.StandaloneCuiRoot";this.a[Common.J.toString(12)]="UILocation.TaskPane";this.a[Common.J.toString(13)]="UILocation.HeroDock";this.a[Common.J.toString(19)]="UILocation.ContextMenu";this.a[Common.J.toString(20)]="UILocation.DialogMenu";this.a[Common.J.toString(26)]="UILocation.Toolbar";this.a[Common.J.toString(30)]="UILocation.Canvas";this.d[_Ewa.fs.toString(0)]="SourceItemType.Range";this.d[_Ewa.fs.toString(1)]="SourceItemType.Art"};_Ewa.qR.a=function(n){return new _Ewa.p(n.top,n.left,n.bottom,n.right,!1,!1)};_Ewa.qR.prototype={serializeSourceItem:function(n){var t={},i,r;if(n&&Object.getType(n)===_Ewa.kn)i=n,t.sheetName=i.b,t.top=i.a.a,t.left=i.a.b,t.bottom=i.a.d,t.right=i.a.c,t.sessionStateId=i.e,t.sessionId=i.d,t.sourceItemType=this.m(0);else if(n&&Object.getType(n)===_Ewa.gD)r=n,t.activeFloatingObjectControlId=r.a,t.sheetName=r.f,t.sessionStateId=r.e,t.sessionId=r.d,t.floatingObjectType=this.u(r.b),t.sourceItemType=this.m(1);else return Diag.a.b(25217025,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(t)},serializeCommandParameters:function(n){if(!n)return Diag.a.b(25217024,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var t={};return t.id=n.id,t.commandType=n.commandType,t.copyPasteTargetType=n.copyPasteTargetType,n.ribbonCommandInfo&&(t.ribbonCommandName=this.x(n.ribbonCommandInfo.a),t.inputMethodName=this.w(n.ribbonCommandInfo.b),t.frameModeName=this.v(n.ribbonCommandInfo.e),t.uiLocationName=this.y(n.ribbonCommandInfo.c),t.tabName=n.ribbonCommandInfo.d),JSON.stringify(t)},deserializeSourceItem:function(n){var t,i;if(!n)return null;try{if(t=JSON.parse(n),!t)return Diag.a.b(38847437,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;i=null;switch(this.s(t.sourceItemType)){case 0:i=new _Ewa.kn(_Ewa.qR.a(t),t.sheetName,t.sessionStateId,t.sessionId);break;case 1:i=new _Ewa.gD(t.activeFloatingObjectControlId,t.sheetName,t.sessionStateId,t.sessionId,this.n(t.floatingObjectType))}return i}catch(r){return Diag.a.a(38847438,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},deserializeCommandParameters:function(n){var t,i;if(!n)return null;try{return(t=JSON.parse(n),!t)?(Diag.a.b(38847439,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null):(i=_Ewa.gR.b(),i.id=t.id,i.ribbonCommandInfo=this.r(t),i.commandType=t.commandType,i.copyPasteTargetType=t.copyPasteTargetType,i)}catch(r){return Diag.a.a(38847440,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},r:function(n){return new _Ewa.R(this.q(n.ribbonCommandName),this.p(n.inputMethodName),this.o(n.frameModeName),this.t(n.uiLocationName),n.tabName,null)},x:function(n){return isNullOrUndefined(n)||!(n.toString()in this.f)?(Diag.a.b(25217028,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),this.f["-911352779"]):this.f[n.toString()]},q:function(n){return!n||!(n in this.j)?(Diag.a.b(25217029,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),-911352779):this.j[n]},w:function(n){return isNullOrUndefined(n)||!(Common.j.c.toString(n)in this.b)?(Diag.a.b(25217030,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",n),this.b[Common.j.c.toString(0)]):this.b[Common.j.c.toString(n)]},p:function(n){return!n||!(n in this.i)?(Diag.a.b(25217031,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",n),0):this.i[n]},v:function(n){return isNullOrUndefined(n)||!(Common.bs.toString(n)in this.c)?(Diag.a.b(25217032,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",n),this.c[Common.bs.toString(2)]):this.c[Common.bs.toString(n)]},o:function(n){return!n||!(n in this.h)?(Diag.a.b(25217033,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",n),2):this.h[n]},m:function(n){return isNullOrUndefined(n)||!(_Ewa.fs.toString(n)in this.d)?(Diag.a.b(25217034,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",n),this.d[_Ewa.fs.toString(0)]):this.d[_Ewa.fs.toString(n)]},s:function(n){return!n||!(n in this.k)?(Diag.a.b(25217035,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",n),0):this.k[n]},u:function(n){return isNullOrUndefined(n)||!(n.toString()in this.e)?(Diag.a.b(36229127,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",n),this.e["99"]):this.e[n.toString()]},n:function(n){return!n||!(n in this.g)?(Diag.a.b(36229128,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",n),99):this.g[n]},y:function(n){return isNullOrUndefined(n)||!(Common.J.toString(n)in this.a)?(Diag.a.b(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",n),this.a[Common.J.toString(2)]):this.a[Common.J.toString(n)]},t:function(n){return!n||!(n in this.l)?(Diag.a.b(36229130,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",n),2):this.l[n]}};_Ewa.Af=function(n){this.a=n};_Ewa.Af.prototype={a:null,b:null,c:null,e:function(){var t,n;return this.b||(t=this.a.b().a(_Ewa.cR,253,!0),t&&(n=t,this.b=_Ewa.v.f(this.a)?new _Ewa.Ac(this.a,n,new _Ewa.ld,null):_Ewa.v.g(this.a)?new _Ewa.Ai(this.a,n,new _Ewa.ld,null):new _Ewa.Ah(this.a,n,new _Ewa.ld,null))),this.b},d:function(){var t,n;return this.c||(t=this.a.b().a(_Ewa.cR,253,!0),t&&(n=new _Ewa.Ad(this.a),this.c=new _Ewa.qL(this.a,new _Ewa.ld,new _Ewa.lc(this.a,n),n,null))),this.c},getCopyFlowHandler:function(n){var t=this.g(_Ewa.b.a(this.a).cl());return n.commandParameters.copyPasteHandlerName=t.a(),t},getPasteFlowHandler:function(n){var t=_Ewa.v.e(this.a)?n.copyContextSnapshot:null,i=null;return i=this.a.a(228)&&_Ewa.cq.d(n)?this.d():_Ewa.cq.b(n)?this.e():t&&t.sourceItem&&Object.getType(t.sourceItem)===_Ewa.gD?this.d():this.e(),n.commandParameters.copyPasteHandlerName=i.b(),i},initializePasteContext:function(n){var r,e,o;if(n&&(n.isSameSession=!1,n.isShadowWorkbookParsedSuccessfully=!1,n.pasteResult="Undefined",n.payloadOrigin="Undefined",n.payloadType="Undefined",n.encounteredDeploymentErrors=!1,n.shadowWorkbookSizeExceedsLimit=!1,n.activeSelectionType=this.f(),n.copyContextSnapshot)){var t=n.copyContextSnapshot,u=_Ewa.fS.a(t.sourceItem),s=_Ewa.fS.b(t.sourceItem),i=0,f=!1;u?(r=t.sourceItem,n.isSameSession=r.c(this.a),i=1,f=this.h(r,n)):s&&(e=t.sourceItem,n.isSameSession=e.c(this.a),i=2);n.copyContextSnapshot.commandParameters&&(o=t.commandParameters.ribbonCommandInfo.a===-1985798686,n.commandParameters.clearSystemClipboard=_Ewa.jU.b(t,this.a)&&o&&u&&!f,n.commandParameters.copyPasteTargetType=i)}},getSessionId:function(){return this.a.f().UserSessionId},h:function(n,t){var i=n.a.o()&&t.commandParameters.originalDestination.a!==1,r=n.a.n()&&t.commandParameters.originalDestination.b!==1;return r||i},g:function(n){switch(n){case 1:return this.e();case 64:case 4:case 2:return this.d();default:throw Error.invalidOperation("Unsupported selection");}},f:function(){return _Ewa.b.a(this.a).a().d()&214?"FloatingObject":_Ewa.b.a(this.a).a().d()===1?"Cells":"Unknown"}};_Ewa.qS=function(n){this.d=Function.createDelegate(this,this.V);_Ewa.qS.initializeBase(this,[n,null])};_Ewa.qS.a=function(){return{ShiftCellsRight:!1,ShiftCellsDown:!0}};_Ewa.qS.prototype={b:null,e:null,O:null,T:function(n){this.m=_Ewa.mP.b(n);this.b=new($$sc.C.$$(_Ewa.mz));var t=_Ewa.ClientStringManager.a().a(15),i=_Ewa.qS.a();return this.l(t,this.d,i),this.U(),this.b.a},V:function(n,t){if(n===1){var i=1;t.ShiftCellsRight&&(i=0);Diag.a.a(25518408,0,50,"InsertCopiedCutDialog OK button pressed with valid input, shift direction = {0}",i?"Vertical":"Horizontal");this.b.b(i)}else Diag.a.a(25518409,0,50,"InsertCopiedCutDialog cancel button pressed"),this.i(),this.b.e()},U:function(){this.e=document.getElementById("ShiftCellsDown");this.O=document.getElementById("ShiftCellsRight")}};_Ewa.Ag=function(){};_Ewa.Ag.prototype={a:function(n,t){var i=new _Ewa.qS(n);return i.T(t)}};_Ewa.Ah=function(n,t,i,r){_Ewa.Ah.initializeBase(this,[n,t,i,"RangeCopyPasteHandler",r])};_Ewa.Ah.prototype={serialize:function(n){var r=n.sourceItem,t={},u=this.f.b(r),f,e,o,i;if(f=this.c.isChangeGateEnabled("OfficeVSO:3522520_CCPLegacyCopyAndPasteHaveDifferentCopyIdFix")?n.commandParameters.id:Common.O.a().a,u)t.synchronousResult=u,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else if(this.p(r.a)){Diag.a.a(24150922,0,50,"RangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");e=this.i.a(r.a);try{o=e.toString();u=this.d.a();this.c.isChangeGateEnabled("OfficeVSO:3246747_GetRangeForClipboardInSyncCopy")&&(u.setItem("copyId",f),this.h(n,r.a,n.commandParameters.ribbonCommandInfo,n.commandParameters.stopwatch,f));u.setItem("text/plain",o);this.f.a(r,u);t.synchronousResult=u;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{e&&e.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.d.a(),t.synchronousResult.setItem("copyId",f),t.synchronousResult.setItem("text/plain",this.n()),i=this,t.asynchronousResult=new Promise(function(t,u){var e=i.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?n.commandParameters.stopwatch.b():0,o=function(o){var h,s;if(i.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e),_Ewa.j.b(o.Errors))Diag.a.a(24150924,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.j.a(o.Errors,",")),u(new _Ewa.gj(1,o.Errors));else{if(Diag.a.a(24150923,0,50,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer succeed."),n.markForCancellation){u(new _Ewa.gj(3,o.Errors));return}h=o.Result;isNullOrUndefined(h)||(n.plainTextPayloadSize=h.length);s=i.d.a();i.c.isChangeGateEnabled("OfficeVSO:3522518_CCPLegacyAsyncPasteNoCopyIdFix")&&s.setItem("copyId",f);s.setItem("text/plain",h);i.f.a(r,s);n.asyncClipboardItemsKeys=_Ewa.fC.a(s);t(s)}},s=function(t){i.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e);var r=_Ewa.U.a(t.b);Diag.a.a(24150925,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.j.a(r,","));u(new _Ewa.gj(1,r))};Diag.a.a(24150926,0,50,"RangeCopyPasteHandler.Serialize: issue request to the server to get the copied data...");i.e.d(r.a,n.commandParameters.ribbonCommandInfo,o,s,[n.commandParameters.stopwatch],f)});return n.syncClipboardItemsKeys=_Ewa.fC.a(t.synchronousResult),t},h:function(n,t,i,r,u){var f=this.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")?n.commandParameters.stopwatch.b():0,e=this,o=function(t){e.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.requestTelemetryData=t.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-f);_Ewa.j.b(t.Errors)&&Diag.a.a(41514441,0,10,"LoadClipboardFromServer in RangeCopyPasteHandler in synchronous copy: LoadClipboardFromServer failed. errors: {0}",_Ewa.j.a(t.Errors,","))},s=this,h=function(t){s.c.isChangeGateEnabled("OfficeVSO:3661563_CPRequestTelemetry_Fixed1")&&(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-f);var i=_Ewa.U.a(t.b);Diag.a.a(41514442,0,10,"LoadClipboardFromServer in RangeCopyPasteHandler in synchronous copy: LoadClipboardFromServer failed. errors: {0}",_Ewa.j.a(i,","))};this.e.d(t,i,o,h,[r],u)},deserialize:function(n){var i,t,r;return Common.a.D("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions"),i=n.copyContextSnapshot,t=this.e.b(i),t?(Diag.a.a(24150927,0,50,"RangeCopyPasteHandler.Deserialize: trigger PasteRange request..."),r=_Ewa.qM.a(n,t),this.s(n,i,t,r)):n.isClipboardInaccessible?Promise.reject(new _Ewa.ck(8,null,null,"")):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.o(n):Promise.reject(new _Ewa.ck(6,null,null,""))}};_Ewa.Ai=function(n,t,i,r){_Ewa.Ai.initializeBase(this,[n,t,i,r]);this.m="SameSessionRangeCopyPasteHandler"};_Ewa.Ai.prototype={deserialize:function(n){return _Ewa.cq.b(n)?this.j(n):_Ewa.Ah.prototype.deserialize.call(this,n)}};_Ewa.le=function(n,t,i,r){var u,f;this.M=Function.createDelegate(this,this.X);this.N=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.V);this.P=Function.createDelegate(this,this.bd);this.E=Function.createDelegate(this,this.bc);this.D=Function.createDelegate(this,this.bb);this.C=Function.createDelegate(this,this.Y);this.w=Function.createDelegate(this,this.W);_Ewa.le.initializeBase(this,[!1]);this.e=n;u=n.c();this.I=String.format("url({0}), auto",_Ewa.t.b.a(77));u.e().c(this.w);u.e().x(this.C);u.l().c(this.w);u.g().b(this.D);n.e().c(this.E);u.D(this.P);this.o=u.c();this.i=t;this.B=r;this.p=new _Ewa.le.b;this.m=new _Ewa.le.e;this.x=!1;f=this;this.l=new($$sc.y.$$($$sc.n.$$(_Ewa.ew)))(function(){return _Ewa.k.a(_Ewa.ew,u.b(),18,f.dm())});this.F=i;this.f=new _Ewa.eb(this.e.c(),this.e)};_Ewa.le.c=function(n,t){return n<=1?n:Math.min(t,Math.ceil(Math.log(n)/Math.LN2))};_Ewa.le.a=function(n,t){t.f=2;t.h=_Ewa.le.c(n.length,31)};_Ewa.le.prototype={o:null,B:null,I:null,j:0,q:null,h:null,A:null,g:null,z:null,e:null,G:!1,K:null,p:null,m:null,x:!1,f:null,c:function(){return!!(387&this.j)},b:function(){var n=this.e.a().a(),t=this.S(n);return t?this.K:null},l:null,y:function(){return this.c()?this.h:null},v:function(){return this.e.a().p()},bh:function(n){return this.e.a().o(n),n},i:null,F:null,dispose:function(){if(this.e){var n=this.e.c();n.e().e(this.w);n.e().D(this.C);n.l().e(this.w);n.g().e(this.D);this.e.e().d(this.E)}!this.l.b&&_Ewa.cc.a(this.l.a())&&System.a.a(this.l.a().a());this.e=null;this.h=null;this.A=null;this.z=null;this.g=null;_Ewa.Sl.prototype.dispose.call(this)},s:function(n,t,i){var o=this.e.c(),y=t.a,s=!1,e=this.d(t,i),h=i.cutCopyText,c=i.inLoadedRange,l=i.duplicateCopy,f=i.pasteText,u=null,r,a,p,w,v;e&&(u=i.event);r=this.e.a().a();a=!0;switch(y){case-893975939:e||this.v()!==4?this.H(r,1,!e,c,l,t,h):(p=this.e.a().m(),this.H(p,i.cutCopyPasteFlag,!0,c,l,t,h));break;case 1902045020:this.H(r,2,!e,c,l,t,h);break;case 1696566924:this.T(t,o,e,r,u,f);break;case 1804571062:Diag.a.a(20821018,0,50,"PasteFormatting was clicked from ribbon");this.n(r,36,!0,t,u,f,!1);break;case 1766348718:this.n(r,68,!0,t,u,f,!1);break;case-958589048:Diag.a.a(22374108,0,50,"PasteTranspose was clicked from ribbon");this.n(r,516,!0,t,u,f,!1);break;case 42074747:this.n(r,1028,!0,t,u,f,!1);break;case-185374993:this.n(r,20,!0,t,u,f,!1);break;case-617905554:case 808159687:w=o.z().a(1);!w&&o.Q(r,1)?(v=0,this.v()===4&&(v=i.cutCopyPasteFlag),this.n(r,v,!e,t,u,f,!1)):(_Ewa.C.a(u,!0),s=!0);break;case 1872288872:s=!0;break;default:a=!1}return s&&this.k(!1),a?$$sc.a.a(Boolean,!0):_Ewa.J.a(y)},T:function(n,t,i,r,u,f){var o=this.e.a(),e,s;return(Diag.a.a(21303497,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}",i),!r)?(Diag.a.a(22856003,0,10,"selctedRange should not be null during format paint"),null):(this.h=r.g(),Diag.a.a(22856004,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}, SourceRange = {1}, this.gridControl.IsFormatPainterOn = {2}.",i,this.h,this.e.X()),this.e.X()?(Diag.a.a(21303500,0,50,"FormatPainter toggle off"),o.k(this.q),this.k(!1),this.e.bl(!1)):(e=this,this.q=function(){r=o.a();Diag.a.a(21303498,0,50,"FormatPainter handler, SourceRange = {0}, DestinationRange = {1}.",e.h,r.toString());e.n(r,36,!0,n,u,f,!0);e.k(!1)},this.h=r.g(),this.j=2,s=new _Ewa.bL(t.e()),s.d(r,this.e)&&this.f.c(r,2),this.g=this.o.k(),Diag.a.a(21303499,0,50,"FormatPainter toggle on"),o.l(this.q),this.e.r().b(this.I),this.e.bl(!0)),r)},r:function(n,t,i){var r=n===1&&!!i&&(!this.d(t,i)||!this.e.m());if(r)switch(t.a){case-893975939:case 1902045020:case 1804571062:case 1766348718:case-185374993:case-617905554:case 808159687:case 1872288872:case 1696566924:break;case-958589048:r=!0;break;case 42074747:r=_Ewa.v.l(this.e.c());break;default:r=!1}return r},u:function(){return!1},t:function(){return!1},a:function(){this.k(!1)},d:function(n,t){return this.f.g(n,t)},J:function(n){return(n?this.z:this.g)===this.o.k()},n:function(n,t,i,r,u,f,e){t||(t=this.j);var o=this.e.c(),s=new _Ewa.bL(o.e());(o.Q(null,1)||36===t&&s.a(4))&&(this.m.f(this.e.c(),this.i,this.c(),i,r.a,t),this.x=!1,this.c()||e?this.bf(n,t,r,u,e):this.be(n,t,i,r,f),this.x||this.m.c())},be:function(n,t,i,r,u){var e=this.e.c(),o,f;t!==36&&t!==68&&t!==516&&(o=i?this.i.c(!0):$$sc.a.a(String,u),this.x=!0,f=this,o.CWCT(function(t){var l=f.i.b(),s=t.a(),u=s===l,o=!f.i.a()&&(i||u),h=Common.c.d(),c=o&&i&&h;f.m.e(u,o,c);o?f.i.i(i,c,h,f.L,e.isChangeGateEnabled("OfficeVSO:3633884_CtrlShiftVShortCut")):(u||f.bg(n,s,r),f.m.c())},e.i(),3,this.B||$$sc.c.a))},bf:function(n,t,i,r,u){var f=this.e.c(),o,s,a,e,h,c,l;if(!this.h||!n){Diag.a.a(22856005,0,10,"source range/destination range should not be null on PasteFromRange");return}if(o=this.f.f(t,this.h,n),!o){Diag.a.a(22856006,0,10,"paste range should not be null");return}if(s=_Ewa.g.a(this.y(),f),!s){Diag.a.a(22856007,0,10,"source should not be null");return}this.g&&(s.SheetName=this.g.e());a=_Ewa.g.a(n,f);e=this.j;e&=3;e|=-5&t;var p=this.J(!1)&&!!o.l(this.y())||!!(this.j&1)||this.v()===4,w=new _Ewa.le.d(n.g(),o.g(),p,e),b=f.d().a().b(),k=_Ewa.g.f(s),d=_Ewa.g.f(a),v=this,g=function(n,t){return f.J(),_Ewa.iC.a(f.d().a(),k,d,e,_Ewa.n.a(n,v.O),_Ewa.n.b(t,v.N),w,b,null)},y=new _Ewa.bd(506,0,g,0,null);y.u=1;f.g().a(y,i);u&&this.l&&_Ewa.cc.a(this.l.a())&&(h=this.y().l(this.e.q()),c=n.l(this.e.q()),h&&c&&this.g&&(l=_Ewa.g.a(h,f),l.SheetName=this.g.e(),this.l.a().a().d(this.e,l,_Ewa.g.a(c,f),null,!0,!1)));_Ewa.C.a(r,!0)},V:function(n,t){this.m.d(n,t);this.m.c();this.e.o()},bg:function(n,t,i){var r,u,l,a,o;if(!t||(t=_Ewa.i.i(t,"\n","\r")),r=this.e.c(),!!t&&!this.U(n,t))if(_Ewa.le.a(t,i),u=this.f.j(),t.length>u)Diag.a.a(42824835,0,15,"ClipboardManager.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,u),alert(_Ewa.ClientStringManager.a().b(6));else{var f,e,s=_Ewa.g.a(n,r),c=!this.o.b()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.i.k(t),h=r.d().a().b();c?(_Ewa.cc.a(this.l.a())&&(_Ewa.v.a(r)&&this.e.b().g("ClipboardManager::ProcessPasteText()",!1),this.l.a().a().c(r,_Ewa.b.a(r).f(n.e()),t,!0,null,!1,-1,"")),e=526,l=this,f=function(i,u){return r.J(),_Ewa.f.c(r.d().a(),s,t,_Ewa.bf.b(t,!0),!1,!1,63,i,u,n,h,null)}):(e=180,a=this,f=function(n,i){return r.J(),_Ewa.iC.b(r.d().a(),s,t,n,i,null,h,null)});o=new _Ewa.bd(e,0,f,0,null);o.u=1;r.g().a(o,i)}},U:function(n,t){var i=this.F.a(n);try{return n.f(this.A)&&this.J(!0)&&_Ewa.i.a(t,i.toString().replace(new RegExp("\r\n","g"),"\n"),!1)}finally{i&&i.dispose()}},S:function(n){return this.G&&!!this.y()&&this.y().f(n)&&this.o.k()===this.g},H:function(n,t,i,r,u,f,e){var h=this.e.c(),s,o;this.k(!0);this.j=t;this.h=n.g();this.g=this.o.k();s=new _Ewa.bL(h.e());o=this.v()===4;this.p.f(this.e.c(),this.i,i,r,u,f.a,t,o);!o&&s.d(n,this.e)&&this.f.c(n,this.j);r||u?(this.Q(e,f,o),this.p.e(e)):this.f.d(n,f,this.M,null,null,null)},k:function(n){this.c()&&(this.j=0,this.A=this.h,this.h=null,this.z=this.g,this.g=null,n||this.i.g(),this.f.a());this.e.X()&&this.R()},R:function(){this.e.bl(!1);this.e.r().b("default");this.e.a().k(this.q);this.q=null;this.e.c().E()},bi:function(){this.e.c().A(237279923,2,0,{cutCopyPasteFlag:this.j})},ba:function(n,t,i){var u=this.v()===4,r=t,f;Diag.a.a(22374109,0,50,"ClipboardManager.OnPasteRangeSuccess: Paste range completed. AreServerMessagesPresent: [{0}]. AreNonStatusMessagesPresent: [{1}] proxyFlags: [{2}] methodName: [{3}]",_Ewa.j.d(n.Errors),_Ewa.j.b(n.Errors),r.a,i);_Ewa.j.d(n.Errors)&&u&&!_Ewa.j.c(n.Errors,[563945982])?this.f.e(this.e.a().m()):u&&this.bh(-1);f=r.c;f&&this.k(!1);!_Ewa.j.b(n.Errors)&&r.b.f(this.e.a().a())&&this.e.a().e(r.b,r.d,0,0,!0,"",!1,!0)},Z:function(n,t,i){var r=t;Diag.a.a(22374110,0,50,"ClipboardManager.OnPasteRangeFailed: Paste range failed. proxyFlags: [{0}] methodName: [{1}]",r.a,i)},X:function(n,t){var r=this.v()===4,f=t,i,u;n.Errors&&n.Errors.length?(r&&this.f.e(this.e.a().m()),this.i.h(),this.k(!1),this.p.e("")):(this.G=!0,i=n.Result,this.K=i,this.Q(i,f,r),u=this,this.i.d(i,!0).CWCT(function(){u.p.e(i)},this.e.c().i(),3,this.B||$$sc.c.a))},Q:function(n,t,i){_Ewa.le.a(n,t);i&&this.bi()},W:function(n,t){t.a&&t.a===this.g?this.f.c(this.h,this.j):this.f.a()},bb:function(n,t){t.b===1&&t.a.a.c()&2&&this.k(!1)},bc:function(){this.k(Common.c.p())},bd:function(n,t){t.b||this.k(!1)},Y:function(){this.c()&&this.J(!1)&&this.k(!1)}};_Ewa.le.b=function(){};_Ewa.le.b.prototype={a:null,c:null,d:null,b:0,f:function(n,t,i,r,u,f,e,o){this.b++;this.c=t;this.d=n;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.f();this.a.c=Common.c.j();this.a.d=i;this.a.e=r;this.a.f=u;this.a.g=t.a();this.a.h=t.f();this.a.i=f;this.a.j=e;this.a.k=o;this.a.l=t.e();this.a.m="N/A";this.a.n="N/A"},e:function(n){if(this.b++,this.b!==2&&Diag.a.a(17154648,0,15,"ClipboardManager.CopyTelemetry.Log: Invalid Call Count:{0}. Expecting:{1}",this.b,2),this.a.o=this.b,this.b=0,this.c.a()&&!this.c.e()){var t=this;this.c.c(!0).CWCT(function(i){var r=i.a(),u,f;Common.c.f()&&(r=r.replace(new RegExp("\n","g"),"\r\n"));u=n===r||!n;f=r===t.c.b();t.a.m=u.toString();t.a.n=f.toString();_Ewa.x.a().a(4,t.a,!0);(!u||f)&&Diag.a.a(17154649,0,15,"ClipboardManager.CopyTelemetry.Log: Failure to Copy to clipboard. IsPasteMatchCopy: {0}. WaitMessageInClipboard: {1} ",t.a.m,t.a.n)},this.d.i(),3,$$sc.c.a)}else this.a.m="N/A",this.a.n="N/A",_Ewa.x.a().a(4,this.a,!0)}};_Ewa.le.e=function(){};_Ewa.le.e.prototype={a:null,b:0,f:function(n,t,i,r,u,f){this.b++;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.f();this.a.c=Common.c.j();this.a.d=i;this.a.e=r;this.a.f=t.a();this.a.g=t.f();this.a.h=u;this.a.i=f;this.a.j="N/A";this.a.k="N/A";this.a.l="N/A";this.a.m="N/A";this.a.n="N/A"},e:function(n,t,i){this.b++;this.a.j=n.toString();this.a.k=t.toString();this.a.l=i.toString()},d:function(n,t){this.b++;this.a.m=n;this.a.n=t.toString()},c:function(){this.b++;(this.b<2||this.b>4)&&Diag.a.a(17154650,0,15,"ClipboardManager.PasteTelemetry.Log: Invalid Call Count:{0} Expecting in range [{1}, {2}]",this.b,2,4);this.a.o=this.b;this.b=0;_Ewa.x.a().a(5,this.a,!0)}};_Ewa.le.d=function(n,t,i,r){this.d=n;this.b=t;this.c=i;this.a=r};_Ewa.le.d.prototype={c:!1,d:null,b:null,a:0};_Ewa.jG=function(){};_Ewa.jG.a=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.f.a(n,"Copy",o,i,r,u,0,e)};_Ewa.jG.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.f.a(n,"Cut",o,i,r,u,0,e)};_Ewa.jG.b=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.pasteParameters=t,_Ewa.f.a(n,"Paste",o,i,r,u,64,e)};_Ewa.EZ=function(){};_Ewa.EZ.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.insertCopiedCutCellsParameters=t,_Ewa.f.a(n,"InsertCopiedCutCells",e,i,r,u,4,null)};_Ewa.Qy.registerClass("_Ewa.Qy");_Ewa.qM.registerClass("_Ewa.qM",_Ewa.Qy);_Ewa.Ac.registerClass("_Ewa.Ac",_Ewa.qM);_Ewa.qL.registerClass("_Ewa.qL",_Ewa.Qy);_Ewa.qN.registerClass("_Ewa.qN",_Ewa.Y);_Ewa.bR.registerClass("_Ewa.bR",_Ewa.cE,_Ewa.cR,_Ewa.Ug,Sys.IDisposable);_Ewa.qP.registerClass("_Ewa.qP",_Ewa.oQ.$$(_Ewa.cR));_Ewa.qS.registerClass("_Ewa.qS",_Ewa.Rz);_Ewa.Ah.registerClass("_Ewa.Ah",_Ewa.qM);_Ewa.Ai.registerClass("_Ewa.Ai",_Ewa.Ah);_Ewa.le.registerClass("_Ewa.le",_Ewa.Sl,_Ewa.iW,_Ewa.ke,Sys.IDisposable);_Ewa.le.d.registerClass("_Ewa.le.d");_Ewa.mP.a="<div class='WACDialogRow' id='labelRow'> <label id='labelId' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='RightRow'> <input type='radio' id='ShiftCellsRight' name='ShiftOptions' class='WACDialogRadio' alt='{1}' title='{1}'><\/input> <label id='ShiftRight' class='WACDialogLabel' for='ShiftCellsRight' >{1}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='DownRow'> <input type='radio' id='ShiftCellsDown' name='ShiftOptions' class='WACDialogRadio' alt='{2}' title='{2}'><\/input> <label id='ShiftDown' class='WACDialogLabel' for='ShiftCellsDown' >{2}<\/label> <\/div>";_Ewa.bR.g=[1352631530,1679665408];_Ewa.bR.d=[-103190598];_Ewa.bR.f=[1306609195];_Ewa.bR.e=[563945982];_Ewa.bR.a=null;Type.registerNamespace("_Ewa");_Ewa.Qz=function(){};_Ewa.Qz.a=function(){_Ewa.h.a(function(n){_Ewa.v.c(n)?_Ewa.qP.a(n):(n.b().b(_Ewa.ke,6,new _Ewa.le(_Ewa.b.a(n),n.b().a(_Ewa.qU,7,!1),n.b().a(_Ewa.mS,168,!1),null)),n.E(),_Ewa.qN.a(n))})};_Ewa.Qz.a();Type.registerNamespace("_Ewa");_Ewa.DomDiffApply=function(){};_Ewa.DomDiffApply.prototype={a:function(n,t){var i;try{var r=_Ewa.a.Y(n,!0),u=this.c(!1,!0),e=window.morphdom(t,r,u)}catch(f){Diag.a.a(40132949,0,10,"DomDiffApply.MorphElement: failed with exception {0}",f);i=_Ewa.ln.a();t=i.a(n,t)}return t},b:function(n,t){var i,r,u;try{i=_Ewa.a.Y(n,!0);r=this.c(!0,!0);window.morphdom(t,i,r)}catch(f){Diag.a.a(40132950,0,10,"DomDiffApply.MorphChildren: failed with exception {0}",f);u=_Ewa.ln.a();t=u.b(n,t)}return t},c:function(n,t){var i,r=this;return i=new $m,i.childrenOnly=n,i.onBeforeElUpdated=function(n,i){return _Ewa.a.bx(n),t&&_Ewa.a.bg(n,i),!0},i}};_Ewa.rP=function(){_Ewa.rP.initializeBase(this);this.j()};_Ewa.rP.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.fu),259,new _Ewa.rP)};_Ewa.rP.prototype={b:function(){var n=this;_Ewa.e.cw(_Ewa.t.c(44,4,!1),function(){n.i(new _Ewa.DomDiffApply)},this.dm(),3)}};$m.prototype={getNodeKey:null,onBeforeNodeAdded:null,onNodeAdded:null,onBeforeElUpdated:null,onElUpdated:null,onBeforeNodeDiscarded:null,onNodeDiscarded:null,onBeforeElChildrenUpdated:null,childrenOnly:!1};_Ewa.DomDiffApply.registerClass("_Ewa.DomDiffApply",null,_Ewa.fu);_Ewa.rP.registerClass("_Ewa.rP",_Ewa.oQ.$$(_Ewa.fu));Type.registerNamespace("_Ewa");_Ewa.RF=function(){};_Ewa.RF.a=function(){_Ewa.h.a(_Ewa.rP.a)};_Ewa.RF.a();