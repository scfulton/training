Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.F=function(){};Common.App.AppsForOfficeCommon.C=function(){};Common.App.AppsForOfficeCommon.p=function(){this.Ver=1};Common.App.AppsForOfficeCommon.b=function(){};Common.App.AppsForOfficeCommon.b.b=function(){return Common.App.AppsForOfficeCommon.b.a||(Common.App.AppsForOfficeCommon.b.a=new Common.App.AppsForOfficeCommon.b),Common.App.AppsForOfficeCommon.b.a};Common.App.AppsForOfficeCommon.b.prototype={a:function(n,t){var i=this.c();if(i)try{i.setItem(n,t)}catch(r){}},b:!1,c:function(){var n=null;if(!this.b)try{localStorage&&(n=localStorage)}catch(t){this.b=!0}return n}};Common.App.AppsForOfficeCommon.j=function(n){this.b=n};Common.App.AppsForOfficeCommon.j.prototype={b:null,a:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.p;r.Data=t;r.RR=i;r.CreatedOn=(new Date).getTime();this.b.a(n,Sys.Serialization.JavaScriptSerializer.serialize(r))}};Common.App.AppsForOfficeCommon.p.registerClass("Common.App.AppsForOfficeCommon.p");Common.App.AppsForOfficeCommon.b.a=null;Type.registerNamespace("Common.App.WopiIdentity");Common.App.WopiIdentity.a=function(){};Common.App.WopiIdentity.a.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};Common.App.WopiIdentity.a.registerEnum("Common.App.WopiIdentity.a",!1);Common.App.WopiIdentity.j=function(){};Common.App.WopiIdentity.k=function(){};Common.App.WopiIdentity.k.registerInterface("Common.App.WopiIdentity.k");Common.App.WopiIdentity.d=function(){};Common.App.WopiIdentity.d.registerInterface("Common.App.WopiIdentity.d");Common.App.WopiIdentity.l=function(){};Common.App.WopiIdentity.l.registerInterface("Common.App.WopiIdentity.l");Common.App.WopiIdentity.i=function(){};Common.App.WopiIdentity.i.registerInterface("Common.App.WopiIdentity.i");Common.App.WopiIdentity.c=function(){this.e="";this.f="";this.b="";this.a=0;this.d="";this.c=!0};Common.App.WopiIdentity.c.a=function(n){switch(n){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Common.App.WopiIdentity.c.prototype={e:null,get_upn:function(){return this.e},set_upn:function(n){return this.e=n,n},f:null,get_userId:function(){return this.f},set_userId:function(n){return this.f=n,n},b:null,get_authority:function(){return this.b},set_authority:function(n){return this.b=n,n},a:0,get_authorityType:function(){return this.a},set_authorityType:function(n){return this.a=n,n},d:null,get_tenantId:function(){return this.d},set_tenantId:function(n){return this.d=n,n},c:!1,get_isAnonymous:function(){return this.c},set_isAnonymous:function(n){return this.c=n,n}};Common.App.WopiIdentity.f=function(){this.b="";this.c="";this.a=""};Common.App.WopiIdentity.f.prototype={b:null,get_displayName:function(){return this.b},set_displayName:function(n){return this.b=n,n},c:null,get_email:function(){return this.c},set_email:function(n){return this.c=n,n},a:null,get_authority:function(){return this.a},set_authority:function(n){return this.a=n,n}};Common.App.WopiIdentity.h=function(n,t,i){this.a=n;this.b=t;this.c=i};Common.App.WopiIdentity.h.prototype={a:null,get_accessToken:function(){return this.a},set_accessToken:function(n){return this.a=n,n},b:null,get_authority:function(){return this.b},set_authority:function(n){return this.b=n,n},c:null,get_expiration:function(){return this.c},set_expiration:function(n){return this.c=n,n}};Common.App.WopiIdentity.m=function(){this.b=resource;this.c=scope;this.d=silentLogin;this.a=options};Common.App.WopiIdentity.m.prototype={b:null,get_resource:function(){return this.b},set_resource:function(n){return this.b=n,n},c:null,get_scope:function(){return this.c},set_scope:function(n){return this.c=n,n},d:!1,get_silentLogin:function(){return this.d},set_silentLogin:function(n){return this.d=n,n},a:null,get_options:function(){return this.a},set_options:function(n){return this.a=n,n}};Common.App.WopiIdentity.e=function(n,t){this.a=Common.App.WopiIdentity.e.T===Number||Type.isEnum(Common.App.WopiIdentity.e.T)?0:Common.App.WopiIdentity.e.T===Boolean?!1:null;this.b=n;this.a=t};Common.App.WopiIdentity.e.$$=function(n){var u=Common.App.WopiIdentity.__tc=Common.App.WopiIdentity.__tc||{},t="e$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.WopiIdentity.e.apply(this,t)};i.registerClass("Common.App.WopiIdentity.__tc."+t);o={"Common.App.WopiIdentity.e":{T:n},ctor:Common.App.WopiIdentity.e};i.prototype.$$gta=o;f=Common.App.WopiIdentity.e.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.WopiIdentity.e.prototype={b:null,get_requestParameters:function(){return this.b},set_requestParameters:function(n){return this.b=n,n},get_requestCallback:function(){return this.a},set_requestCallback:function(n){return this.a=n,n}};Common.App.WopiIdentity.b=function(n){this.f=Function.createDelegate(this,this.m);this.a={};this.b={};this.e=Common.a.b().d();this.c=n;this.c.c("PostAccessToken");this.c.b("PostAccessToken",this.f)};Common.App.WopiIdentity.b.prototype={c:null,a:null,b:null,e:null,getAccessToken:function(n,t){this.k(n,t);var i=this;return new Promise(function(r,u){var f=Common.a.a.h.PostMessageOrigin;if(Common.k.j(f).toLowerCase().indexOf(".spoppe.com")>-1){u(Common.App.WopiIdentity.a.toString(3));return}if(i.d(t)){if(t in i.a){u(Common.App.WopiIdentity.a.toString(4));return}window.setTimeout(function(){Diag.a.a(37856032,344,10,JSON.stringify({error:"Request timeout.",callerId:t}));u(Common.App.WopiIdentity.a.toString(5));return},12e4);i.h(n,t,function(n,t){n?r(n):(Diag.a.a(37856033,369,10,JSON.stringify({error:Common.App.WopiIdentity.a.toString(t)})),u(t))})}else Diag.a.a(37856034,344,10,JSON.stringify({error:"Caller is not allowed."})),u(Common.App.WopiIdentity.a.toString(2))})},getPrimaryIdentityInfo:function(n){var t=this;return new Promise(function(i,r){t.d(n)?t.j(function(n,t){n?i(n):(Diag.a.a(37856064,369,10,JSON.stringify({error:t.toString()})),r(t))}):(Diag.a.a(37856065,344,10,JSON.stringify({error:"Caller is not allowed."})),r(Common.App.WopiIdentity.a.toString(2)))})},getAuthContext:function(n){var t=this;return new Promise(function(i,r){var u=t.getAuthContextSync(n);u?i(u):r(Common.App.WopiIdentity.a.toString(2))})},getAuthContextSync:function(n){var t,i;return this.d(n)?(t=new Common.App.WopiIdentity.c,t.e=Common.a.a.h.UserPrincipalName,t.f=Common.a.a.h.LoggableUserId,t.b=Common.a.a.h.HostAuthAuthority,t.d=Common.a.a.h.TenantId,t.c=Common.a.a.a("IsAnonymousUser"),i=Common.a.a.h.HostAuthType,t.a=i.toLowerCase()==="aad"?2:i.toLowerCase()==="msa"?1:0,t):(Diag.a.a(40751647,344,10,JSON.stringify({error:"Caller is not allowed."})),null)},h:function(n,t,i){var u=Common.bx.c().a.a,f="getAccessToken_"+u,o=this.e.a("ComponentAttach",f),r,e;this.b[f]=o;r={};e=n.get_options()&&typeof n.get_options()!="undefined"?n.get_options():{};r.SsoRequestId=u;r.SsoResource=n.get_resource();r.SsoScope=n.get_scope();r.SsoSilentLogin=n.get_silentLogin();r.SsoOptions=n.get_options();r.AddinControlId=u;r.AddinApplicationResource=n.get_resource();r.AddinSSOAuthChallenge=e.authChallenge||"";r.AddinIsFirstParty=!0;this.c.a("GetAccessToken",r,"");this.a[u]=new(Common.App.WopiIdentity.e.$$(Function))(n,i)},j:function(n){var r=Common.a.a.h.UserName,u=Common.a.a.h.UserPrincipalName,f=Common.a.a.h.TenantId,i=Common.a.a.h.LoggableUserIdSpace,t=new Common.App.WopiIdentity.f;t.c=u;t.b=r;switch(i){case"OrgIdPuid":t.a="AzureActiveDirectoryAccount";break;case"MsaCid":case"MsaPuid":t.a="MicrosoftAccount";break;default:t.a=i}n(t,null)},m:function(n){var t=null,u,h,e;try{var i=n.Values.SsoRequestId||n.Values.AddinControlId,r=n.Values.SsoAccessToken||n.Values.AccessToken,l=n.Values.SsoAuthority||this.i(n.Values.HostApplicationType),a=n.Values.SsoTokenExpiration||new Date((new Date).getTime()+51e5),o=null,s=null,f=this.a[i];if(typeof f=="undefined"||!f){Diag.a.a(37856066,344,10,JSON.stringify({error:"No matching outstanding request for request ID.",requestId:i}));return}t=f.a;delete this.a[i];typeof r!="undefined"&&r&&r.length?s=new Common.App.WopiIdentity.h(r,l,a):o=Common.App.WopiIdentity.a.toString(this.l(n));u="getAccessToken_"+i;u in this.b&&(h=this.b[u],h.a(),delete this.b[u]);t(s,o)}catch(c){e=n.Values.SsoRequestId||n.Values.AddinControlId;e in this.a&&delete this.a[e];this.g();Diag.a.a(37856067,344,10,JSON.stringify({error:c.message,stack:c.stack}));t&&t(null,Common.App.WopiIdentity.a.toString(0))}},d:function(n){var a=Common.a.by,o,s,i,r,h,c,u,f,l;n=n.toLowerCase();for(var e=a,v=e.length,t=0;t<v;++t)if(o=e[t],n===o.toLowerCase())return!0;s=Common.a.cj;i=s;for(r in i)if(h={key:r,value:i[r]},n===h.value.toLowerCase())return!0;c=Common.a.ck;u=c;for(f in u)if(l={key:f,value:u[f]},n===l.value.toLowerCase())return!0;return!1},i:function(n){switch(n){case"OneDriveWOPI":return"MicrosoftAccount";case"SharepointOnline":case"ExchangeOnline":default:return"AzureActiveDirectoryAccount"}},l:function(n){var t=n.Values.SsoError||n.Values.AddinSSOError,i=n.Values.HostApplicationType;return this.g(),Diag.a.a(39068821,344,10,JSON.stringify({error:t,wopiHost:i})),t.indexOf("AADSTS50058")>-1?9:t.indexOf("Popup Window is null")>-1||t.indexOf("Popup Window closed")>-1?12:t.indexOf("AADSTS50001")>-1?10:t.indexOf("13002")>-1?8:t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1?11:t.indexOf("Token renewal operation failed due to timeout")>-1?6:0},k:function(n,t){var i=this.n(n.get_resource());Diag.a.a(39921882,344,50,JSON.stringify({callerId:t,resource:i}))},g:function(){var n=window.navigator.userAgent;Diag.a.a(39068822,344,50,JSON.stringify({userAgent:n}))},n:function(n){return n=n?n:"",n.replace("://","__").replace(new RegExp("\\.","g"),"_dot_").replace("/","\\")}};Common.App.WopiIdentity.g=function(){};Common.App.WopiIdentity.g.a=function(){Common.App.a.a().a(new Common.App.WopiIdentity.g,0,!1)};Common.App.WopiIdentity.g.prototype={a:function(){return"Common.App.WopiIdentity"},c:function(n){var t=this;n.b(Common.App.WopiIdentity.b).c(Common.App.WopiIdentity.d).a().b(function(){return new Common.App.WopiIdentity.b(n.a(Common.Q))})},b:function(){}};Common.App.WopiIdentity.b.registerClass("Common.App.WopiIdentity.b",null,Common.App.WopiIdentity.d);Common.App.WopiIdentity.g.a();Type.registerNamespace("_Ewa");_Ewa.TokenParameters=function(){this.b="";this.e=!0;this.d=null};_Ewa.TokenParameters.prototype={c:null,a:null,b:null,get_scope:function(){return this.b},set_scope:function(n){return this.b=n,n},e:!1,get_silentLogin:function(){return this.e},set_silentLogin:function(n){return this.e=n,n},d:null,get_options:function(){return this.d},set_options:function(n){return this.d=n,n},get_authChallenge:function(){return this.c},set_authChallenge:function(n){return this.c=n,n},get_policy:function(){return null},set_policy:function(n){return n},get_resource:function(){return this.a},set_resource:function(n){return this.a=n,n},getTypeName:function(){return"Microsoft.Authentication.TokenParameters"},invokePropertyGet:function(n){switch(n){case 3:return this.c;case 4:return null;case 2:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 3:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.Wv=function(){};_Ewa.Wv.registerInterface("_Ewa.Wv");_Ewa.TokenParameters.registerClass("_Ewa.TokenParameters",null,Common.App.WopiIdentity.i);Type.registerNamespace("Common.App.OAuth");Common.App.OAuth.a=function(){};Common.App.OAuth.a.registerInterface("Common.App.OAuth.a");Common.App.OAuth.p=function(){};Common.App.OAuth.d=function(){};Common.App.OAuth.e=function(){};Common.App.OAuth.f=function(){};Common.App.OAuth.n=function(){};Common.App.OAuth.g=function(n,t,i,r){this.d=n;this.e=r.a("OAuthManagerEnableConsoleLogging");this.g=i;this.c=this.j(this.d,t,r);this.f=this.i(r.h.OAuthManagerHostPathOverride)};Common.App.OAuth.g.prototype={g:null,d:null,f:null,e:!1,c:null,b:function(){var n=this;return $$sc.h.toPromise$o(this.g.e()).then(function(){return n.k()})},a:function(n,t,i,r){t===this.d&&(t=null);var u=new Common.App.OAuth.g.a(n,t,this.c.get_authorityType(),i,r);return u.h()},k:function(){var f=null,u,n,e,i,t,o,r;if(!this.c)return Diag.a.a(41460757,3e3,15,"Auth context is null. WebAuthImplicit package did not load."),Promise.reject(!1);u=this.h(this.c.get_authorityType());switch(this.c.get_authorityType()){case 2:e=(n=new Common.App.OAuth.e,n.appId=this.d,n.authority=this.c.get_authority(),n.redirectUri=this.f,n.upn=this.c.get_upn(),n);f=(i=new Common.App.OAuth.d,i.idp=u,i.aadConfig=e,i.enableConsoleLogging=this.e,i);break;case 1:o=(t=new Common.App.OAuth.f,t.appId=this.d,t.authority=this.c.get_authority(),t.redirectUri=this.f,t.upn=this.c.get_upn(),t);f=(r=new Common.App.OAuth.d,r.idp=u,r.msaConfig=o,r.enableConsoleLogging=this.e,r);break;default:return Diag.a.a(41003226,3e3,100,"Non-microsoft authentication authority: {0}. WebAuthImplicit package did not load.",u),Promise.reject(!1)}return Common.App.OAuth.b.a.Load(f),Diag.a.a(41003227,3e3,100,"WebAuthImplicit package loaded."),Promise.resolve(!0)},j:function(n,t){var i=t.getAuthContextSync(n);return i?i:(Diag.a.a(41460758,3e3,15,"Auth context not found for appId [{0}]; Ensure that your appId is allowlisted in [Word/Excel/PowerPoint]WopiIdentityWhitelist",n),null)},i:function(n){var u=window.location.protocol,f=window.location.host,t=n,i,r;return isNullOrUndefined(t)&&(i=window.location.pathname,r=i.lastIndexOf("/"),t=r>=0?i.substring(0,r+1):""),u+"//"+f+t+"WacOAuth.html"},h:function(n){switch(n){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"Unexpected enum type"}}};Common.App.OAuth.g.a=function(n,t,i,r,u){this.a=n;this.e=t;this.f=i;this.g=r;this.d=u};Common.App.OAuth.g.a.prototype={a:null,e:null,f:0,g:null,d:!1,b:0,c:0,h:function(){var i=Common.App.OAuth.b.a.GetToken(this.g,this.d,this.e),t=this,n=this;return i.then(function(n){var i=t.i(n,!0);return i.IsSuccess?Diag.a.a(41460759,3e3,50,"Successfully retreived token for app [{0}]",t.a):Diag.a.a(41460760,3e3,15,"Failed to retrieve token for app [{0}]: {1}",t.a,JSON.stringify(i)),i},function(t){var i=n.i(t,!1);return(i.ErrorCode==="Timeout"||i.ErrorCode==="Token Renewal Failed")&&n.b<2?(n.b+=1,Diag.a.a(42267907,3e3,100,"Retrying to retrieve token for app [{0}] attempt {1}: {2}",n.a,n.b,JSON.stringify(i)),n.h()):i.ErrorCode==="login_required"&&n.f===1&&n.c<=2&&Common.a.a.a("WordOAuthTestAppPopUpIsEnabled")?(n.c+=1,Diag.a.a(41460762,3e3,100,"Retrying retrieve token for app [{0}] with popup enabled, attempt {1}: {2}",n.a,n.c,JSON.stringify(i)),n.d=!0,n.h()):(Diag.a.a(41460764,3e3,15,"Failed to retrieve token for app [{0}]: {1}",n.a,JSON.stringify(i)),i)})},i:function(n,t){var i=n,e=null,r=null,u=null,f;return isNullOrUndefined(i)?(r="NoResult",u="No result came from WebAuthJsImplictModule.GetToken()"):isNullOrUndefined(i.ErrorCode)?isNullOrUndefined(i.ErrorMessage)?isNullOrUndefined(i.Token)?(r="Exception",u=JSON.stringify(n)):t?e=i.Token:(r="RejectToken",u="A rejected promise returned a token."):(r=isNullOrUndefined(i.ErrorCode)?"Exception":i.ErrorCode,u=i.ErrorMessage):(r=i.ErrorCode,u=isNullOrUndefined(i.ErrorMessage)?"No message":i.ErrorMessage),(r||u)&&(e=null),f=new Common.App.OAuth.c,f.IsSuccess=!!e,f.Token=e,f.ErrorCode=r,f.ErrorMessage=u,f}};Common.App.OAuth.j=function(n,t,i){this.f=t;this.e=new Common.App.OAuth.l(n);this.b=i;Diag.a.a(42084323,3e3,100,"OAuthManager Created")};Common.App.OAuth.j.prototype={e:null,f:null,b:null,c:null,d:!1,a:function(n,t){return this.g(n,t,!1)},g:function(n,t,i){var f,r,u,e,h;if(Diag.a.a(42084352,3e3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called",n,t),f=Common.a.a.h.HostAuthType,r=null,f.toLowerCase()==="aad"?r=Common.a.cj[n]:f.toLowerCase()==="msa"&&(r=Common.a.ck[n]),isNullOrUndefined(r))return Diag.a.a(41961345,3e3,15,"Auth context not found. Ensure that your app [{0}] is listed in WacFrameImplicitAuthAADApplications or WacFrameImplicitAuthMSAApplications.",n),Promise.resolve((u=new Common.App.OAuth.c,u.IsSuccess=!1,u.Token=null,u.ErrorCode="DisallowedApp",u.ErrorMessage="Disallowed appName: "+n,u));this.b||(this.b=new Common.App.OAuth.g(r,this.f,this.e,Common.a.a));this.c||(e=this,h=this,this.c=this.b.b().then(function(){return e.d=!0,Diag.a.a(42084353,3e3,100,"OAuthManager initialized for app [{0}]",n),null},function(){return Diag.a.a(42267908,3e3,10,"OAuthManager failed to initialized for app [{0}], all future TryGetToken requests will fail.",n),null}));var o=this,s=function(){if(o.d)return o.b.a(n,r,t,i);var u;return Promise.resolve((u=new Common.App.OAuth.c,u.IsSuccess=!1,u.Token=null,u.ErrorCode="InitFailed",u.ErrorMessage="Package failed to initialize.",u))},c=this,l=this;return this.c=this.c.then(function(){return s()},function(){return s()})}};Common.App.OAuth.o=function(){};Common.App.OAuth.o.prototype={Token:null,ErrorCode:null,ErrorMessage:null};Common.App.OAuth.c=function(){};Common.App.OAuth.c.prototype={IsSuccess:!1,Token:null,ErrorCode:null,ErrorMessage:null};Common.App.OAuth.k=function(){};Common.App.OAuth.k.a=function(){Common.App.a.a().a(new Common.App.OAuth.k,0,!1)};Common.App.OAuth.k.prototype={a:function(){return"Common.App.OAuth.OAuthPackage"},c:function(n){var t=this;n.b(Common.App.OAuth.a).a().b(function(){return new Common.App.OAuth.j(n.a(Common.eV),n.a(Common.App.WopiIdentity.d),null)})},b:function(){}};Common.App.OAuth.b=function(){};Common.App.OAuth.l=function(n){this.a=n};Common.App.OAuth.l.prototype={d:"webauth.implicit",c:"Implicit",b:"es6-promise.auto",a:null,e:function(){var n=Common.a.cH(this.d,2),i=Common.a.cH(this.b,2),t;return window.self.WebAuthImplictScriptUrl=n,window.self.Es6PromisePolyfillJs=i,t=this,this.a.a(n).CW(function(){Common.App.OAuth.b.a=window.self[t.c];Diag.a.a(41003229,3e3,100,"WebAuth package loaded")})}};Common.App.OAuth.n.registerClass("Common.App.OAuth.n");Common.App.OAuth.e.registerClass("Common.App.OAuth.e",Common.App.OAuth.n);Common.App.OAuth.f.registerClass("Common.App.OAuth.f",Common.App.OAuth.n);Common.App.OAuth.o.registerClass("Common.App.OAuth.o");Common.App.OAuth.c.registerClass("Common.App.OAuth.c");Common.App.OAuth.b.a=null;Common.App.OAuth.k.a();Type.registerNamespace("Common.App.OAuth");Common.App.OAuth.h=function(){};Common.App.OAuth.h.prototype={d:null,a:function(){return"Common.App.OAuth.OAuthCommercialTokenRetrievalTestPackage"},c:function(n){this.d=n},b:function(){if(Common.a.a){var n=this;Common.a.a.g(function(){var r=n.d.a(Common.App.OAuth.a),t=Common.a.a.h.LokiAADAppId,i;Diag.a.a(42084354,3e3,50,"Attempting to retrieve a token for appName [{0}]: {1}","Loki",t);i=Common.g.c();r.a("Loki",t).then(function(n){var t={};t.IsSuccess=n.IsSuccess;t.TokenAquired=!!n.Token&&n.Token!=="";t.ErrorCode=n.ErrorCode;t.ErrorMessage=n.ErrorMessage;t.IsAnonymous=Common.a.a.a("IsAnonymousUser");t.TimeInMS=Common.g.c()-i;Diag.a.a(41964885,3e3,50,JSON.stringify(t))}).catch(function(n){Diag.a.a(42084355,3e3,15,JSON.stringify(n))})})}}};Common.App.OAuth.i=function(){};Common.App.OAuth.i.prototype={d:null,a:function(){return"Common.App.OAuth.OAuthConsumerTokenRetrievalTestPackage"},c:function(n){this.d=n},b:function(){if(Common.a.a){var n=this;Common.a.a.g(function(){var r=n.d.a(Common.App.OAuth.a),t="openid",i;Diag.a.a(50431968,3e3,50,"Attempting to retrieve a token for appName [{0}]: {1}","Loki",t);i=Common.g.c();r.a("Loki",t).then(function(n){var t={};t.IsSuccess=n.IsSuccess;t.TokenAquired=!!n.Token&&n.Token!=="";t.ErrorCode=n.ErrorCode;t.ErrorMessage=n.ErrorMessage;t.IsAnonymous=Common.a.a.a("IsAnonymousUser");t.TimeInMS=Common.g.c()-i;Diag.a.a(50431969,3e3,50,JSON.stringify(t))}).catch(function(n){Diag.a.a(50431970,3e3,15,JSON.stringify(n))})})}}};Common.App.OAuth.q=function(){};Common.App.OAuth.q.a=function(){Common.a.a.a("WordOAuthTestAppIsEnabled")&&Common.App.a.a().a(new Common.App.OAuth.m,0,!1);Common.a.a.a("WordOAuthTestAppAadTokenRetrievalIsEnabled")&&Common.App.a.a().a(new Common.App.OAuth.h,0,!1);Common.a.a.a("WordOAuthTestAppMsaTokenRetrievalIsEnabled")&&Common.App.a.a().a(new Common.App.OAuth.i,0,!1)};Common.App.OAuth.m=function(){};Common.App.OAuth.m.prototype={d:null,a:function(){return"Common.App.OAuth.OAuthTokenRetrievalTestPackage"},c:function(n){this.d=n},b:function(){if(Common.a.a){var n=this;Common.a.a.g(function(){var u=n.d.a(Common.App.OAuth.a),t=Common.a.dc,i=t.AppName,e=t.AuthorityType,f=t.TokenTarget,r;Diag.a.a(42084356,3e3,50,"Attempting to retrieve a token for appName [{0}]: {1}",i,JSON.stringify(t));r=Common.g.c();u.a(i,f).then(function(n){var t={};t.IsSuccess=n.IsSuccess;t.TokenAquired=!!n.Token&&n.Token!=="";t.ErrorCode=n.ErrorCode;t.ErrorMessage=n.ErrorMessage;t.TimeInMS=Common.g.c()-r;Diag.a.a(41460766,3e3,50,JSON.stringify(t))}).catch(function(n){Diag.a.a(42084357,3e3,15,JSON.stringify(n))})})}}};Common.App.OAuth.q.a();Type.registerNamespace("_Ewa");_Ewa.uI=function(n){_Ewa.uI.initializeBase(this);this.h=n;this.j()};_Ewa.uI.a=function(n){n.b().b(_Ewa.Vq.$$(Object),344,new _Ewa.uI(n))};_Ewa.uI.prototype={h:null,b:function(){this.i(this.h.b().a(Object,343,!1)||new _Ewa.IR(Common.Utils.a.a().a(Common.App.OAuth.a)))}};_Ewa.IR=function(n){this.b=n};_Ewa.IR.prototype={b:null,a:function(n,t){if(!this.b)return Diag.a.a(51401291,0,10,"Oauth manager is null"),Promise.resolve("");var i=this;return this.b.a(n,t).then(function(n){return n.IsSuccess?n.Token:(Diag.a.a(51401292,0,10,"Error retrieving auth token. Message: "+n.ErrorMessage+" Error code: "+n.ErrorCode),"")})}};_Ewa.uI.registerClass("_Ewa.uI",_Ewa.oQ.$$(Object));_Ewa.IR.registerClass("_Ewa.IR",null,_Ewa.Wv);Type.registerNamespace("_Ewa");_Ewa.Ww=function(){};_Ewa.Ww.a=function(){_Ewa.h.a(function(n){_Ewa.uI.a(n)})};_Ewa.Ww.a();