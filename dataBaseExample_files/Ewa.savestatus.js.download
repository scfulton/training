Type.registerNamespace("Common.App.SaveStatus");Common.App.SaveStatus.e=function(){this.h=Function.createDelegate(this,this.i)};Common.App.SaveStatus.e.prototype={d:null,g:null,e:null,f:null,a:function(){return"Common.App.SaveStatus"},c:function(n){var t,r,i;this.d=n;Common.a.a.a("PostMessageEmbedded")&&Common.a.C?(t=this,this.d.b(Common.App.SaveStatus.c).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.c(t.d.c(Common.App.HostNotification.b),t.d.c(Common.Q))})):Common.a.b().a().N()||(Common.a.b().a().e()?(r=this,this.d.b(Common.App.SaveStatus.b).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.b(r.d.c(Common.App.HostNotification.b))})):(i=this,this.d.b(Common.App.SaveStatus.d).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.d(Common.F.a(),i.d.c(Common.cx),i.d.c(Common.App.HostNotification.b),Common.a.g)})))},b:function(){Common.a.a.g(this.h)},i:function(){var n=Common.a.a,t=!!Common.a.b().a()&&Common.a.b().a().c()===4;(n.a("WordEditorAutoSaveImprovementIsEnabled")||n.a("PptEditorSaveStatusInHeaderEnabled")||t&&n.a("SimplifiedReactRibbonUxIsEnabled")||n.a("ExcelSaveStatusInHeaderEnabled")||n.a("VisioSaveStatusInHeaderEnabled"))&&(Common.a.a.a("PostMessageEmbedded")&&Common.a.C?(this.f=this.d.a(Common.App.SaveStatus.c),this.f&&this.f.p()):Common.a.b().a().N()||(Common.a.b().a().e()?(this.e=this.d.a(Common.App.SaveStatus.b),this.e&&this.e.p(n.a("IsSkyDrive"),n.h.HostNameToIncludeInSavedStatus)):(this.g=this.d.a(Common.App.SaveStatus.d),this.g&&this.g.C(n.a("IsSkyDrive"),n.h.HostNameToIncludeInSavedStatus))))}};Common.App.SaveStatus.f=function(){};Common.App.SaveStatus.f.a=function(){Common.App.a.a().a(new Common.App.SaveStatus.e,0,!1)};Common.App.SaveStatus.c=function(n,t){this.j=Function.createDelegate(this,this.q);this.m=$a.r;this.n=$a.I;this.k=$a.j;this.l=$a.H;this.i=t;this.f=n;this.h=3;this.d=!0};Common.App.SaveStatus.c.prototype={e:null,i:null,f:null,d:!1,h:0,p:function(){var n,t;this.f&&(n=this,this.f.a(function(t){t.b(n.j)}));t=this;this.i.a(function(n){t.e=n})},a:function(n,t){this.h=t;t===3?this.c(this.d):t===2?this.g(this.l):this.g(this.k)},q:function(){this.c(!1)},c:function(n){this.d=n;var t=this.d?this.m:this.n;this.g(t)},b:function(n){this.d=!1;this.g(n)},g:function(n){this.e&&this.e.a("UI_SaveStatus",this.o(n),"")},o:function(n){var t={};return t.StatusText=n,t}};Common.App.SaveStatus.d=function(n,t,i,r){this.x=Function.createDelegate(this,this.G);this.w=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.y);this.u=n;this.p=t;this.o=i;this.r=r;this.q=!0;this.f=!1;this.e=3;this.i=!0};Common.App.SaveStatus.d.prototype={u:null,p:null,o:null,l:null,m:null,j:null,k:null,q:!1,r:!1,f:!1,e:0,i:!1,h:0,t:null,n:null,g:null,s:null,d:null,C:function(n,t){return this.u?(this.l=this.B(n,t),this.m=$a.I,this.j=$a.j,this.k=$a.H,this.D(),!0):!1},B:function(n,t){return n?String.format($a.s,$a.D):t&&t.length?String.format($a.s,t):$a.r},D:function(){var n,t;this.p&&(n=this,this.p.a(function(t){t.d(n.v);t.f(n.w);t.b&&n.y(null,null)}));this.o&&(t=this,this.o.a(function(n){n.b(t.x)}))},E:function(n,t){this.a(t==="true",this.e)},a:function(n,t){this.f=n;this.e=t;this.n&&(this.n.style.display=this.f||this.e===3||!this.t?"none":"");this.g&&(this.g.style.display=this.f||this.e===3?"none":"",this.g.innerText=this.e===1?this.j:this.k,this.g.title=this.e===1?$a.fJ:$a.gg);this.s&&(this.s.style.display=this.f||this.e===1||!this.t&&!this.g?"none":"");this.d&&(this.d.style.display=this.f||this.e===1?"none":"",this.c(this.i),this.d.title=$a.gm)},y:function(n,t){var i=document.getElementById(Common.n.m),r=t,u=t?r.a:!1;!u&&i&&this.l!==""&&this.m!==""&&this.j!==""&&this.k!==""&&(this.t=document.getElementById("BreadcrumbTitle"),this.n=Common.n.a(i,"BreadcrumbAppModeDash","-",null,!1),this.g=Common.n.a(i,"BreadcrumbAppModeStatus",this.e===1?this.j:this.k,null,!1),this.A(this.g),this.s=Common.n.a(i,"BreadcrumbSaveStatusDash","-",null,!1),this.d=Common.n.a(i,"BreadcrumbSaveStatus",this.l,null,!1),this.A(this.d),this.a(this.f,this.e))},G:function(){this.c(!1)},c:function(n){this.i=n;this.F(this.i?this.l:this.m)},b:function(n){this.i=!1;this.z(n)},F:function(n){this.d&&(this.e===3||this.e===2)&&(this.q&&!this.i?(this.h=this.d.offsetWidth<this.h?this.h:this.d.offsetWidth,this.z(this.m),this.q=!1):this.d.innerText=n)},A:function(n){n.style.direction=this.r?"rtl":"ltr";n.style.width="auto";n.style.textAlign=this.r?"right":"left";n.style.display=this.f?"none":"";n.setAttribute("Unselectable","on")},z:function(n){if(this.d){this.d.style.width="";this.d.innerText=n;this.h=this.d.offsetWidth<this.h?this.h:this.d.offsetWidth;var t=Common.z.a(this.d);this.d.style.width=this.h-Common.l.a(t.paddingLeft)-Common.l.a(t.paddingRight)+1+"px"}}};Common.App.SaveStatus.b=function(n){this.l=Function.createDelegate(this,this.q);this.f=n;this.e=3;this.d=!0};Common.App.SaveStatus.b.prototype={f:null,j:null,k:null,h:null,i:null,e:0,d:!1,g:!1,p:function(n,t){if(this.j=this.o(n,t),this.k=$a.I,this.h=$a.j,this.i=$a.H,this.f){var i=this;this.f.a(function(n){n.b(i.l)})}return!0},a:function(n,t){this.g=n;this.e=t;this.c(this.d)},c:function(n){this.d=n;var t=null;this.e===3&&(t=this.d?this.j:this.k);this.m(t)},b:function(n){this.d=!1;this.m(n)},o:function(n,t){return n?String.format($a.s,$a.D):t&&t.length?String.format($a.s,t):$a.r},q:function(){this.c(!1)},n:function(){switch(this.e){case 1:return this.h;case 2:return this.i;default:return null}},m:function(n){Common.V.b()?appChrome.api.dispatch(appChrome.actions.updateDocumentTitleStatus(this.g,n,this.n())):Diag.a.a(51212686,340,15,"DispatchSaveStatusAction, AppChrome is not defined.")}};Common.App.SaveStatus.c.registerClass("Common.App.SaveStatus.c",null,Common.App.SaveStatus.a);Common.App.SaveStatus.d.registerClass("Common.App.SaveStatus.d",null,Common.App.SaveStatus.a);Common.App.SaveStatus.b.registerClass("Common.App.SaveStatus.b",null,Common.App.SaveStatus.a);Common.App.SaveStatus.f.a();Type.registerNamespace("_Ewa");_Ewa.vJ=function(n){_Ewa.vJ.initializeBase(this);this.h=n;this.j()};_Ewa.vJ.a=function(n){n.b().b(_Ewa.Vq.$$(Sys.IDisposable),298,new _Ewa.vJ(n))};_Ewa.vJ.prototype={h:null,b:function(){var n=Common.Utils.a.a(),t=this;n.b(_Ewa.oN).a().b(function(){return new _Ewa.oN(t.h,n.a(Common.App.SaveStatus.a))});this.i(n.a(_Ewa.oN))}};_Ewa.oN=function(n,t){this.d=Function.createDelegate(this,this.s);this.i=Function.createDelegate(this,this.u);this.h=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.y);this.l=Function.createDelegate(this,this.x);this.k=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.z);this.j=Function.createDelegate(this,this.v);this.b=t;this.a=n;this.a.g().b(this.j);this.a.D(this.n);this.a.c().cf(this.k);this.a.c().g(this.l);this.a.cx(this.m);this.a.c().H(this.h);this.a.c().K(this.i);this.c=this.a.q()?3:1;this.f(!1)};_Ewa.oN.prototype={b:null,a:null,c:0,e:!1,o:!1,y:function(n,t){t&&t.a&&_Ewa.j.J([t.a])&&this.q(!0)},t:function(){this.q(!1)},x:function(n,t){t&&t.a||this.f(!0);this.q(!1)},r:function(){return this.a.c()?this.a.c().bB():!1},p:function(n){return n?this.e=!0:_Ewa.b.a(this.a)&&_Ewa.b.a(this.a).b()&&(_Ewa.b.a(this.a).b().j()?this.e=!1:_Ewa.b.a(this.a).b().c(this.d)),this.g(),n},q:function(n){return this.o=n,this.g(),n},dispose:function(){this.a&&(this.a.F(this.n),this.a.cM(this.m),this.a.g()&&this.a.g().e(this.j),this.a.c()&&(this.a.c().cx(this.k),this.a.c().h(this.l),this.a.c().J(this.h),this.a.c().S(this.i)),_Ewa.b.a(this.a)&&_Ewa.b.a(this.a).b()&&_Ewa.b.a(this.a).b().e(this.d))},u:function(){if(this.a.bu()){var t=this.a.q()?3:1,i=_Ewa.k.a(Object,this.a.b(),154,this.a.i()),n=this;_Ewa.e.cw(i,function(){n.c!==t&&t===3?n.b.b($a.r):t===1&&n.b.b($a.j);n.c=t;n.f(!1)},this.a.i(),3)}},f:function(n){this.b.a(n,this.c);this.g()},g:function(){this.b.c(!this.e&&!this.r()&&!this.o)},z:function(){this.p(this.a.bg());this.f(!1)},w:function(){this.g()},v:function(){this.p(this.a.bg())},s:function(){_Ewa.b.a(this.a).b().e(this.d);this.p(this.a.bg())}};_Ewa.vJ.registerClass("_Ewa.vJ",_Ewa.oQ.$$(Sys.IDisposable));_Ewa.oN.registerClass("_Ewa.oN",null,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.XH=function(){};_Ewa.XH.a=function(){_Ewa.h.a(_Ewa.vJ.a)};_Ewa.XH.a();