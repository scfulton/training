typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.registerInterface("Common.App.Enrichment.k");Common.App.Enrichment.n=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.n.prototype={requestId:null,cellId:null};Common.App.Enrichment.h=function(){this.messageType=type};Common.App.Enrichment.h.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.h;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.j=function(){};Common.App.Enrichment.j.prototype={Query:null,TelemetryJson:null};Common.App.Enrichment.i=function(n){this.messageType=n};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.O);this.q=Function.createDelegate(this,this.M);this.o=Function.createDelegate(this,this.K);this.p=Function.createDelegate(this,this.L);this.w=Function.createDelegate(this,this.D);this.n=Function.createDelegate(this,this.J);this.g=n;this.y=t;this.x=i;this.j=r;this.s=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.i()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={g:null,y:null,e:null,d:null,x:null,j:null,s:null,t:null,u:null,k:null,h:null,i:null,v:!1,A:function(){return!0},l:function(){return Common.a.a.h.EnrichmentPaneUrl},dispose:function(){this.A()&&this.h&&this.g.b("click",this.h,this.n);this.h=null;this.d&&(this.Q(),this.d.parentNode.removeChild(this.d),this.d=null);var n=this.j.a("EnrichmentPaneId");n.a(this.i)},b:function(n,t,i){this.e=n;this.v||(this.k=this.E(),this.z().appendChild(this.k),this.N(),this.s.a(1520278933,2147483648,this.w),this.P(),this.v=!0);this.d.src=this.l()&&this.l().length?this.l()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.t=t;this.u=i;this.C()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.m(i)},P:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.g.d("EnrichmentPaneId",this.k,!1);n.b(this.i,1520278933)},O:function(){if(this.d){Common.o.b(this.d.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.m(n)}},J:function(){return this.a(),this.e&&this.e.f(),!0},E:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.A()&&n.appendChild(this.F()),this.I(n),n},F:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.U,i.title=$a.U,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.c,"ClosePaneGlyph_16x16x32",!1),this.g.a("click",n,this.n),t.appendChild(i),t.appendChild(n),this.h=n,t},I:function(n){this.d=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.d);this.d.id="EnrichmentContentFrame"},N:function(){Common.j.a(this.d,"load",this.p);Common.j.a(this.d,"error",this.o);$addHandler(window,"message",this.q)},Q:function(){Common.j.b(this.d,"load",this.p);Common.j.b(this.d,"error",this.o);$removeHandler(window,"message",this.q)},G:function(){this.d.src="about:blank"},a:function(){this.B();this.G()},D:function(n,t,i){return i!==1&&this.a(),32},L:function(){},K:function(){},M:function(n){var r=n.rawEvent,t,u,f,e,o,i,s,h,c;if(!this.d||this.d.src.indexOf(r.origin)!==-1){try{t=JSON.parse(r.data)}catch(y){return}if(!CommandUI.a.a(t.messageType)){u=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.m(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.t),this.u));break;case 1:this.m(new(Common.App.Enrichment.c.$$(String))(0,this.H()));break;case 3:f=t;this.e&&this.e.h(f.messageContent);break;case 5:e=t;this.e&&this.e.e(e.messageContent);break;case 8:o=t;this.e&&(i=JSON.parse(o.messageContent),this.e.g(i.Query,i.TelemetryJson));break;case 6:this.e&&this.e.b();break;case 11:var l=t,a=JSON.parse(l.messageContent),v=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,a,!0,!1,!1);this.d&&this.d.dispatchEvent(v);break;case 12:s=t;h=JSON.parse(s.messageContent);h.keyCode===27&&(c=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.d&&this.d.dispatchEvent(c))}window.g_badCastCallback=u}}},H:function(){return JSON.stringify([2,1,3,5,8,6])},m:function(n){var t=JSON.stringify(n);this.d.contentWindow.postMessage(t,Common.k.g(this.l()))}};Common.App.Enrichment.g=function(n){this.j=n};Common.App.Enrichment.g.prototype={j:null,i:null,d:function(n,t,i){this.i=n;this.j&&this.j.b(this,t,i)},a:function(n,t){this.j&&this.j.c(n,t)},c:function(){this.j&&this.j.a()},dispose:function(){this.j&&(this.j.dispose(),this.j=null)},h:function(n){return this.i?this.i.h(n):!1},g:function(n,t){this.i&&this.i.g(n,t)},e:function(n){return this.i?this.i.e(n):!1},f:function(){this.i&&this.i.f()},b:function(){this.i&&this.i.d()}};Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h");Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.l,Sys.IDisposable);Common.App.Enrichment.g.registerClass("Common.App.Enrichment.g",null,Common.App.Enrichment.k,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.Rh=function(){};_Ewa.Bf=function(n,t){this.b=t;this.a=n};_Ewa.Bf.prototype={b:null,a:null,u:function(){return!1},s:function(n,t,i){var u=$$sc.a.a(Boolean,!0),f=t.a,r;switch(f){case-1203788282:if(r=this.c(i.MenuItemId.toString()),!r){Diag.a.a(37340321,0,15,"Unknown MenuItemIdKey triggered RibbonCommand.ConvertToLinkedEntity, SourceKey: {0}",r);break}this.a.m(r);break;case 311599363:this.a.l();break;case 439914789:this.a.c();break;case 2127195269:this.a.o();break;case 1266950951:this.a.n(!0);break;default:u=_Ewa.J.a(f)}return u},r:function(n,t){return this.b.a(172)?t.a===-1203788282||t.a===439914789||t.a===2127195269?this.b.a(173):t.a===311599363||t.a===1266950951:!1},t:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&this.b.a(172)&&this.b.a(173)?this.a.q(n,t,i):!1},c:function(n){var t=_Ewa.ClientStringManager.a().a(1472),i=_Ewa.ClientStringManager.a().a(1473);return n===this.a.a()||n===this.a.b()?parseInt(n):_Ewa.i.b(n,t,!0)?parseInt(this.a.b()):_Ewa.i.b(n,i,!0)?parseInt(this.a.a()):0}};_Ewa.rt=function(n){_Ewa.rt.initializeBase(this,[n])};_Ewa.rt.a=function(n){_Ewa.Y.a(272,new _Ewa.rt(n))};_Ewa.rt.prototype={l:function(){var n=this;_Ewa.gW.a(_Ewa.gb,this.h,270,271,function(t){n.k([new _Ewa.Bf(t,n.h)],null)})}};_Ewa.Bg=function(n,t,i,r){this.r=Function.createDelegate(this,this.D);this.t=Function.createDelegate(this,this.F);this.g=Function.createDelegate(this,this.M);this.s=Function.createDelegate(this,this.E);this.u=Function.createDelegate(this,this.H);this.j=Function.createDelegate(this,this.J);this.v=Function.createDelegate(this,this.L);this.i=Function.createDelegate(this,this.G);this.k=Function.createDelegate(this,this.K);this.a=n;this.b=_Ewa.b.a(this.a);this.b.a().f(this.k);this.b.v(this.i);this.m=r;i.f(_Ewa.nV,t);var u=new _Ewa.Bh(t);this.f=new _Ewa.Bi(u)};_Ewa.Bg.prototype={a:null,l:!1,c:!1,d:!0,n:!1,e:null,m:null,b:null,f:null,dispose:function(){this.a&&(this.b.a().g(this.k),this.b.y(this.i))},O:function(n){var i=_Ewa.g.c(this.b.a().c(),this.a),t=this,r=function(r,u){return _Ewa.eW.i(t.a.d().a(),i,n,_Ewa.n.a(r,t.v),u,null,null)},u=this;return _Ewa.O.a(this.a.g(),r,function(n){return new _Ewa.G(109,0,n,0,null)},null),!0},N:function(n,t){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var r=_Ewa.g.c(this.b.a().c(),this.a),i=this,u=function(t,u){return _Ewa.eW.h(i.a.d().a(),r,n,_Ewa.n.a(t,i.j),u,null,null)},f=this;_Ewa.O.a(this.a.g(),u,function(n){return new _Ewa.G(110,0,n,16,null)},null);return},C:function(n){var t=_Ewa.g.c(this.b.a().c(),this.a);!t;this.d=!1;var i=this,r=function(r,u){return _Ewa.eW.f(i.a.d().a(),t,n,_Ewa.n.a(r,i.u),u,null,null)},u=this;return _Ewa.O.a(this.a.g(),r,function(n){return new _Ewa.G(111,0,n,16,null)},null),!0},I:function(){this.c=!1;this.l=!0;return},x:function(){var n=this.w();if(n){var t=this,i=function(i,r){return _Ewa.eW.c(t.a.d().a(),n,_Ewa.n.a(i,t.j),r,null,null)},r=this;_Ewa.O.a(this.a.g(),i,function(n){return new _Ewa.G(112,0,n,16,null)},null);return}},G:function(){(this.d||this.c)&&this.o(!1)},M:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},o:function(n){this.b.a().a()&&this.B(this.b.a().a(),n);return},A:function(){var n;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.w(),n){var t=this,i=function(i,r){return _Ewa.eW.a(t.a.d().a(),n,!0,_Ewa.n.a(i,t.s),r,null,null)},r=this;_Ewa.O.a(this.a.g(),i,function(n){return new _Ewa.G(113,0,n,16,null)},null)}},D:function(n){var t,i,u,r;if(_Ewa.j.b(n.Errors)){t=_Ewa.j.a(n.Errors,",");_Ewa.i.b(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(!n.WorkbookMetadataResult.Metadata&&this.n&&(i=_Ewa.k.b(_Ewa.cF,this.a.b(),4,3),u=this,_Ewa.e.cw(i,function(){i.a().g()},this.a.i(),3)),this.a.c().h(this.g),this.a.c().g(this.g),r=n.Result,this.e=r.SkydanceFeatureBitmask,this.q(r))},K:function(){(this.d||this.c)&&this.o(!1)},F:function(n){var t,i;if(_Ewa.j.b(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){if(t=n.Result,!t.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.e=t.SkydanceFeatureBitmask;i=t.DisambiguationJson;this.p(i)}return},E:function(n){var t,i;if(_Ewa.j.b(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){if(t=n.Result,!t.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.e=t.SkydanceFeatureBitmask;i=t.DisambiguationJson;this.p(i)}return},p:function(n){if(this.c)this.f.a(n,null);else{var t=3;this.e!=null?t=this.e:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set");this.f.d(this.m,this.z(n,t),null);this.c=!0}return},h:function(){this.c&&(this.f.c(),this.c=!1);return},H:function(n){if(_Ewa.j.b(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.j.a(n.Errors,","));this.d=!0;return}if(n.Result){var t=n.Result;this.e=t.SkydanceFeatureBitmask;this.q(t)}return},q:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){this.h();this.a.c().h(this.g);return}r=new _Ewa.p(t,i,t,i,!0,!1);this.b.a().e(r,r,60,0,!0,"",!1,!0);this.d=!0;this.p(u)},z:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.n,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.m,i.appCorrelationId=Common.O.a().a,r=Common.d.b(Common.a.k),u=r?r.a:null,i.uiLanguage=u,i.market=this.y(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},y:function(n){var t=n.split("-");return t[t.length-1]},B:function(n,t){var i;if(this.a.a(172)&&(i=this.a.j(),i&&n.m())){if(_Ewa.b.a(this.a).k().g(n)){if(this.l&&!t)return;t&&(this.d=!0);var u=_Ewa.g.c(n,this.a),r=this,f=function(n,t){return _Ewa.eW.a(r.a.d().a(),u,!1,_Ewa.n.a(n,r.t),t,null,null)},e=this;_Ewa.O.a(this.a.g(),f,function(n){return new _Ewa.G(114,0,n,0,null)},null)}else this.h();return}},L:function(n){if(_Ewa.j.b(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.j.a(n.Errors,",")),n.Result){var t=n.Result;this.q(t)}else this.h();return},J:function(n){if(_Ewa.j.b(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.f.a(t,null)}else this.h();return},w:function(){var n=this.b.a().a();return n.m()?_Ewa.g.c(n,this.a):null}};_Ewa.ru=function(n,t,i,r){this.I=Function.createDelegate(this,this.Y);this.J=Function.createDelegate(this,this.Z);this.Q=-1;this.u=n;this.v={};this.A=_Ewa.b.a(this.u);this.C=this.Q;this.R=this.u.m()+"Ribbon.Data.LinkedEntity";this.H=new _Ewa.rw(t,this,n);this.w=new _Ewa.Bg(n,i,r,this);n.b().b(_Ewa.gb,270,this)};_Ewa.ru.a=function(n,t,i){var r=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,_Ewa.t.a(11),i),u=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',t);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',r,u)};_Ewa.ru.prototype={u:null,H:null,w:null,v:null,G:null,B:null,y:0,A:null,E:null,S:2,F:null,C:0,D:8,T:2e3,R:null,x:null,b:function(){return this.x},z:null,a:function(){return this.z},O:null,L:null,P:null,M:null,N:null,K:null,dispose:function(){this.w.dispose()},h:function(n){return this.w.O(n)},g:function(n,t){this.w.N(n,t)},e:function(n){return this.w.C(n)},f:function(){this.w.I();return},d:function(){this.w.x();return},m:function(n){var i,f,t;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n),this.A){i=n.toString()===this.x;this.w.n=i;var r=this.A.a().a(),o=this.A.J(),u=r.l(o);if(u){if(f=this.A.k().p(u),f){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),this.u.a(629)){if(this.F||(this.F=new _Ewa.Bj(this.u)),_Ewa.q.a().a())t="[data-unique-id=LinkedEntity]";else if(t=document.getElementById(this.R),!t)return;this.F.e(t,this.U(n.toString()),this.W(n.toString()),i);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}var s=_Ewa.g.d(r,this.u),e=this,h=function(t,i){return _Ewa.eW.e(e.u.d().a(),s,n,_Ewa.n.a(t,e.w.r),i,null,null)},c=this;_Ewa.O.a(this.u.g(),h,function(n){return new _Ewa.bd(115,0,n,0,null)},null)}}},l:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),this.A){var n=_Ewa.g.d(this.A.a().a(),this.u),t=this,i=function(i,r){return _Ewa.eW.d(t.u.d().a(),n,i,r,null,null)},r=this;_Ewa.O.a(this.u.g(),i,function(n){return new _Ewa.G(116,0,n,0,null)},null)}},c:function(){var n;if(Diag.a.a(36234048,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities() - refresh attempted"),n=_Ewa.b.a(this.u),n){var t=_Ewa.g.c(n.a().c(),this.u),i=this,r=function(n,r){return _Ewa.eW.g(i.u.d().a(),t,n,r,null,null)},u=this;_Ewa.O.a(this.u.g(),r,function(n){return new _Ewa.G(117,0,n,16,null)},null)}},t:function(){return this.y===2?!this.x:!0},s:function(){return this.y===2?!this.z:!0},r:function(){return this.v?this.v.length<=this.S:!0},o:function(){this.w.A();return},q:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.G=i.MenuId,this.y&&this.y!==3)_Ewa.q.a().a()?(this.E=this.E||this.H.b(this.v,i.MenuId),i.MenuItems=this.E):(this.B=this.B||this.H.a(this.v,i.MenuId),i.PopulationXML=this.B);else if(this.C===this.Q){this.p();var r=this;this.C=window.setInterval(function(){r.p()},this.T)}return!0},p:function(){if(this.D--,Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.y=1,this.u.isChangeGateEnabled("OfficeVSO:3426869_GetLinkedEntityServiceDomainsCallsWebServiceProxyDirectly"))_Ewa.eW.b(this.u.d().a(),this.J,this.I,null,null);else{var n=this,t=function(t,i){return _Ewa.eW.b(n.u.d().a(),_Ewa.n.a(t,n.J),_Ewa.n.b(i,n.I),null,null)},i=this;_Ewa.O.a(this.u.g(),t,function(n){return new _Ewa.G(118,0,n,16,null)},null)}return},Z:function(n){var r,t,i,e,o;if(n.Result){if(this.v=n.Result,this.y=2,this.B=null,r=!1,this.v&&Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",this.v.length),this.v)for(var f=this.v,s=f.length,u=0;u<s;++u){if(t=f[u],i=t.Name,t.DomainBlocked){Diag.a.a(39120923,0,50,"Domain: {0} is telemetry only, do not show in menu",i);continue}r=!0;e=_Ewa.ClientStringManager.a().a(1471);o=_Ewa.ClientStringManager.a().a(1473);i===e?(this.x=t.ID.toString(),this.O=i,this.P=t.Description,this.N=t.ExampleEntities):i===o?(this.z=t.ID.toString(),this.L=i,this.M=t.Description,this.K=t.ExampleEntities):Diag.a.a(37340322,0,50,"GetLinkedentityDomains returned unrecognized Domain name, Domain: {0}",i)}r||(this.v=null)}else this.v=null,this.y=3,this.B=null,this.u.isChangeGateEnabled("OfficeVSO:3426869_GetLinkedEntityServiceDomainsCallsWebServiceProxyDirectly")&&this.D>0&&this.p(),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.V()},Y:function(n){var t=_Ewa.U.a(n.b);Diag.a.a(34415007,0,15,"GetLinkedentityDomains failed [Errors: {0}].",_Ewa.j.a(t,","));this.v=null;this.y=3;this.V()},n:function(n){this.w.o(n)},j:function(){return this.k(this.x)},i:function(){return this.k(this.z)},k:function(n){var t=this.X(n),i=this.U(n),r=this.ba(n);return _Ewa.ru.a(t,i,r)},U:function(n){return n===this.x?this.O:n===this.z?this.L:_Ewa.ClientStringManager.a().a(1460)},X:function(n){return n===this.x?"ewadata_StockLinkedEntity32":n===this.z?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},ba:function(n){return n===this.x?this.P:n===this.z?this.M:_Ewa.ClientStringManager.a().a(1468)},W:function(n){return n===this.x?this.N:n===this.z?this.K:_Ewa.ClientStringManager.a().a(1475)},V:function(){this.D<0&&Diag.a.a(37089859,0,10,"Out of GetLinkedEntityServiceDomain retries");(this.y===2||this.D<0)&&window.clearInterval(this.C);this.G&&this.u.y().v(this.G)}};_Ewa.rv=function(n){_Ewa.rv.initializeBase(this);this.h=n;this.j()};_Ewa.rv.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.gb),271,new _Ewa.rv(n))};_Ewa.rv.prototype={h:null,b:function(){var t=_Ewa.k.a(_Ewa.dG,this.h.b(),102,this.h.i()),i=_Ewa.k.b(_Ewa.nV,this.h.b(),256,257),r=_Ewa.cx.a(this.h),n=this;_Ewa.e.cw(_Ewa.e.ws([t,i,r],this.dm(),3),function(){n.i(n.h.b().a(_Ewa.gb,270,!1)||new _Ewa.ru(n.h,t.a(),i.a(),r.a()))},this.h.i(),3)}};_Ewa.rw=function(n,t,i){this.e=i;this.d=n;this.c=t};_Ewa.rw.a=function(n,t,i,r){return String.format('<GalleryButton InnerHTML="" Id="{0}" Command="{1}" QueryCommand="{2}" MenuItemId="{3}" ElementDimensions="{4}"/>',n,t,i,r,"Size64by48")};_Ewa.rw.prototype={e:null,d:null,c:null,b:function(n,t){var i=this.g(n,t);return i.b()},g:function(n,t){var r=this.d.c(t),u,f,i;if(n&&n.length>0){u=this.d.b();r.a().push(u);f=this.d.f("ConvertToLinkedEntitySeeMore",2,"Size64by48");for(var s=n,h=s.length,e=0;e<h;++e)if(i=s[e],!i.DomainBlocked){var o=i.ID.toString(),c=this.i(o),l=this.h(o),a=i.Name;f.a("Data.ConvertToLinkedEntityMenuItem_"+o,-1203788282,"QueryChartGalleryIcon",l,"Data.ConvertToLinkedEntityMenuItem_"+a,c,null,null,null)}Array.add(u.a(),f)}return r.a().length||Diag.a.a(34415008,0,15,"No domain data available"),r},i:function(n){return this.c?n===this.c.b()?"Bank_32":n===this.c.a()?"OpenMap_32":null:null},a:function(n,t){var u=[],i,e,o,s,h;if(n)for(var f=n,c=f.length,r=0;r<c;++r)(i=f[r],i.DomainBlocked)||(e=i.ID.toString(),o=i.Name,Array.add(u,_Ewa.rw.a(o,"-1203788282","QueryLinkedEntityMenuGalleryButtons",e)));return s=this.f(t,[Common.u.n("ConvertToLinkedEntitySeeMore","Size64by48","2",u)],!1),h=[s],Common.u.c(h)},f:function(n,t,i){return Common.u.b(n,i?Common.u.d(null,t):t[0],null,null,null,null,null)},h:function(n){return this.c?n===this.c.b()?1471:n===this.c.a()?1473:0:0}};_Ewa.eW=function(){};_Ewa.eW.e=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,o.serviceEndpoint=i,_Ewa.f.a(n,"ConvertToLinkedEntity",o,r,u,f,4,null)};_Ewa.eW.b=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.f.a(n,"GetLinkedEntityServiceDomains",f,t,i,r,4,null)};_Ewa.eW.d=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.f.a(n,"ConvertLinkedEntityToText",e,i,r,u,4,null)};_Ewa.eW.g=function(n,t,i,r,u,f){var e=n.a(1,f);return e.activeCell=t,_Ewa.f.a(n,"RefreshLinkedEntities",e,i,r,u,4,null)};_Ewa.eW.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isChangeObject=i,_Ewa.f.a(n,"GetLinkedEntityDisambiguationData",o,r,u,f,4,null)};_Ewa.eW.i=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,o.selectionIndex=i,_Ewa.f.a(n,"SelectLinkedEntityForDisambiguation",o,r,u,f,4,null)};_Ewa.eW.h=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.searchQuery=i,_Ewa.f.a(n,"SearchLinkedEntity",o,r,u,f,4,null)};_Ewa.eW.f=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isBackward=i,_Ewa.f.a(n,"MoveToNextAmbiguousLinkedEntity",o,r,u,f,4,null)};_Ewa.eW.c=function(n,t,i,r,u,f){var e=n.a(9,f);return e.activeCell=t,_Ewa.f.a(n,"CancelSearchLinkedEntity",e,i,r,u,4,null)};_Ewa.Bj=function(n){this.a=n};_Ewa.Bj.prototype={a:null,d:null,b:null,e:function(n,t,i,r){var f,u,e;(this.d=n,f=!this.a.a(630),this.b)||(u=this,e=function(){Common.UISurfaces.c().then(function(n){Diag.a.a(42467675,0,50,"LinkedEntityBlankCellConvertTeachingCallout:Show() - Showing callout.  Domain: {0};  Video type: {1}",r?"Stocks":"Geography",f?"gray bars":"text");var s=String.format(_Ewa.ClientStringManager.a().c(116),t),h=String.format(_Ewa.ClientStringManager.a().c(117),i),c=n.calloutNotificationButton(_Ewa.ClientStringManager.a().a(1476),function(){Diag.a.a(42467676,0,50,'LinkedEntityBlankCellConvertTeachingCallout:Show() - clicked "Got it" button');u.c()}),l=n.calloutNotificationButton(_Ewa.ClientStringManager.a().a(1477),function(){Diag.a.a(42467677,0,50,'LinkedEntityBlankCellConvertTeachingCallout:Show() - clicked "Learn more" button');var n=new _Ewa.R(-859308420,_Ewa.A.a,u.a.p()?2:1,9,"Help",null),t={CommandValueId:"HelpID=BlankCell",InputMethod:_Ewa.A.a,ShouldCanvasTakeFocus:!0,MenuItemId:"HelpArticle"};u.a.h().b(n,t,null);u.c()}),a=new _Ewa.Bj.a("TextAboveImage",new _Ewa.Bj.c([h],f,r)),v=n.teachingCallout(u.d,a,s,!0,l,c),e,o,y=(o=new Common.cV,o.onShow=function(){u.a.bw(!0)},o.expirationOptions=(e=new Common.dm,e.displayTimeoutSeconds=3600,e.onExpire=function(){u.c()},e),o);return u.b=n.addNotification(v,y),null})},_Ewa.ey.a(this.a,e))},c:function(){if(this.a.bZ()&&this.b){var n=this;Common.UISurfaces.c().then(function(t){return t.removeNotification(n.b),n.a.bw(!1),n.b=null,null})}}};_Ewa.Bj.a=function(n,t){this.id=n;this.customProps=t};_Ewa.Bj.a.prototype={id:null,customProps:null};_Ewa.Bj.c=function(n,t,i){this.paragraphs=n;var r;r=t?82:i?83:84;this.image=new _Ewa.Bj.b(_Ewa.t.b.a(r));this.type="CustomControlsProps";this.imageWidth=280};_Ewa.Bj.c.prototype={paragraphs:null,image:null,imageWidth:0,type:null};_Ewa.Bj.b=function(n){this.src=n};_Ewa.Bj.b.prototype={src:null};_Ewa.Bi=function(n){_Ewa.Bi.initializeBase(this,[n])};_Ewa.Bi.prototype={dispose:function(){Common.App.Enrichment.g.prototype.dispose.call(this)}};_Ewa.li=function(n,t,i){this.m=Function.createDelegate(this,this.n);this.a=this.co;this.d=this.cl;_Ewa.li.initializeBase(this,[n,null]);this.i=t;this.l=i;_Ewa.bn.a(t).a(this);this.i.H(this.m)};_Ewa.li.a=function(n,t){var u=n.m(),i=document.getElementById(u+"m_enrichmentTaskPane"),f,r,e;return i||(i=CommonUI.a.a("div",n.m()+"m_enrichmentTaskPane","cui-taskpane"),f=document.getElementById(u+"novTaskpaneBody"),f.appendChild(i)),r=n.b(),e=r.a(_Ewa.li,256,!1)||r.b(_Ewa.li,256,new _Ewa.li(i,n,t)),e};_Ewa.li.prototype={l:null,N:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},R:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cp("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cq("EnrichmentTaskPaneOnFocus",n)},co:function(){return _Ewa.PT.prototype.co.call(this)},cl:function(n){return _Ewa.PT.prototype.cl.call(this,n),this.ch("EnrichmentTaskPaneVilibilityChanged",null),n},bo:function(){return this.co()},V:function(){return"ETP"},b:function(){return 10},s:function(){return"ewanov_linkedrecordPane"},t:function(){return"Enrichment"},P:function(){return 300},A:function(){return this.cf()},k:!1,i:null,j:function(){},O:function(){},h:function(){return this.k},g:function(){return this.k},r:function(){},dispose:function(){this.i&&this.i.I(this.m);this.i=null;this.l=null;_Ewa.PT.prototype.dispose.call(this)},B:function(n,t){return t||this.ch("EnrichmentTaskPaneOnFocus",null),!t},dh:function(n){return _Ewa.a.g(this.A(),n)},ck:function(){},bA:function(){},c:function(n){this.k=n;var t=this.l;this.cl(n);n&&t.c().length>0&&(!t.a()||t.a().a().b()!==10||t.e())&&t.d(this,!0);t.b();n||(_Ewa.b.a(this.i).B(!0,!1),this.i.E())},Q:function(){return!1},n:function(){this.c(!1)}};_Ewa.rx=function(n){_Ewa.rx.initializeBase(this);this.h=n;this.j()};_Ewa.rx.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.nV),257,new _Ewa.rx(n))};_Ewa.rx.prototype={k:null,l:null,m:function(){if(!this.k){var n=this;this.k=_Ewa.e.cw(_Ewa.cx.a(this.h),function(t){n.l=_Ewa.li.a(n.h,t.a())},this.dm(),3)}return this.k},h:null,b:function(){var t=_Ewa.k.a(Sys.IDisposable,this.h.b(),202,this.dm()),i=_Ewa.k.a(Object,this.h.b(),154,this.dm()),r=this,n=this;_Ewa.e.cw(_Ewa.e.tc(_Ewa.e.ws([t,i],this.dm(),3),function(){return r.m()},this.dm()),function(){n.i(n.l)},this.dm(),3)},dispose:function(){this.h=null;this.k=null;this.l=null;_Ewa.cE.prototype.dispose.call(this)}};_Ewa.Bh=function(n){_Ewa.Bh.initializeBase(this,[Common.a.b().c(),Common.a.b().e(),Common.a.b().h(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.r)};_Ewa.Bh.prototype={f:null,z:function(){return this.f.A()},C:function(){this.f.a()||this.f.c(!0)},B:function(){this.f.c(!1)},dispose:function(){this.f&&(this.f.f(this.r),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.Bf.registerClass("_Ewa.Bf",null,_Ewa.iW);_Ewa.rt.registerClass("_Ewa.rt",_Ewa.Y);_Ewa.rv.registerClass("_Ewa.rv",_Ewa.oQ.$$(_Ewa.gb));_Ewa.Bj.a.registerClass("_Ewa.Bj.a");_Ewa.Bi.registerClass("_Ewa.Bi",Common.App.Enrichment.g);_Ewa.li.registerClass("_Ewa.li",_Ewa.PT,_Ewa.nV,Sys.IDisposable,_Ewa.Vz,_Ewa.UI);_Ewa.rx.registerClass("_Ewa.rx",_Ewa.oQ.$$(_Ewa.nV));_Ewa.Bh.registerClass("_Ewa.Bh",Common.App.Enrichment.a);Type.registerNamespace("_Ewa");_Ewa.Rf=function(){};_Ewa.Rf.a=function(){_Ewa.h.a(function(n){_Ewa.rx.a(n);_Ewa.rv.a(n);_Ewa.rt.a(n)})};_Ewa.Rf.a();