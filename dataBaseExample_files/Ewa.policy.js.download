Type.registerNamespace("Common.App.Policy.Contracts");Common.App.Policy.Contracts.j=function(){};Common.App.Policy.Contracts.j.registerInterface("Common.App.Policy.Contracts.j");Common.App.Policy.Contracts.a=function(){};Common.App.Policy.Contracts.a.prototype={"default":0,auto:1,recommended:2,manual:3,mandatory:4};Common.App.Policy.Contracts.a.registerEnum("Common.App.Policy.Contracts.a",!1);Common.App.Policy.Contracts.b=function(){};Common.App.Policy.Contracts.b.prototype={standard:0,privileged:1};Common.App.Policy.Contracts.b.registerEnum("Common.App.Policy.Contracts.b",!1);Common.App.Policy.Contracts.c=function(){};Common.App.Policy.Contracts.c.registerInterface("Common.App.Policy.Contracts.c");Common.App.Policy.Contracts.g=function(n,t,i){this.a=n.Id;i||(i="");this.b=t;this.d=i;this.c=n};Common.App.Policy.Contracts.g.prototype={a:null,d:null,b:!1,c:null};Common.App.Policy.Contracts.e=function(){this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.DefaultLabelId="";this.SensitivityLabels=new Array(0)};Common.App.Policy.Contracts.e.prototype={AreLabelsAvailable:!1,AppliedPolicyId:null,RequiredDowngradeJustification:!1,DefaultLabelId:null,CustomUrl:null,SensitivityLabels:null};Common.App.Policy.Contracts.p=function(){this.Id="";this.Enabled=!1;this.Name="";this.DisplayName="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=new Array(0)};Common.App.Policy.Contracts.p.prototype={Id:null,Enabled:!1,Name:null,DisplayName:null,Order:0,Tooltip:null,IsEndpointProtectionEnabled:!1,ParentId:null,RequiredDowngradeJustification:!1,LabelActions:null};Common.App.Policy.Contracts.o=function(){this.Name="";this.Font="";this.FontSize=0;this.FontColor="";this.Text="";this.Margin=0;this.Alignment="";this.Placement=""};Common.App.Policy.Contracts.o.prototype={Name:null,Font:null,FontSize:0,FontColor:null,Text:null,Margin:0,Alignment:null,Placement:null};Common.App.Policy.Contracts.l=function(n,t,i,r){Common.App.Policy.Contracts.l.initializeBase(this);this.d=n;this.c=t;this.a=i;this.b=r};Common.App.Policy.Contracts.l.prototype={c:null,d:null,a:null,b:null};Common.App.Policy.Contracts.h=function(){Common.App.Policy.Contracts.h.initializeBase(this)};Common.App.Policy.Contracts.d=function(){Common.App.Policy.Contracts.d.initializeBase(this)};Common.App.Policy.Contracts.n=function(n,t){Common.App.Policy.Contracts.n.initializeBase(this);this.a=n;this.b=t};Common.App.Policy.Contracts.n.prototype={a:null,b:0};Common.App.Policy.Contracts.f=function(n,t,i,r,u,f){Common.App.Policy.Contracts.f.initializeBase(this);this.e=n;this.d=t;this.c=i;this.a=r;this.b=u;this.f=f};Common.App.Policy.Contracts.f.prototype={e:0,d:null,c:null,a:null,b:null,f:!1};Common.App.Policy.Contracts.i=function(n,t){Common.App.Policy.Contracts.i.initializeBase(this);this.b=n;this.a=t};Common.App.Policy.Contracts.i.prototype={b:0,a:!1};Common.App.Policy.Contracts.k=function(n,t){this.a=n;this.b=t};Common.App.Policy.Contracts.k.prototype={a:0,b:null};Common.App.Policy.Contracts.m=function(){this.IsSuccessful=!1};Common.App.Policy.Contracts.m.prototype={IsSuccessful:!1};Common.App.Policy.Contracts.g.registerClass("Common.App.Policy.Contracts.g");Common.App.Policy.Contracts.e.registerClass("Common.App.Policy.Contracts.e");Common.App.Policy.Contracts.p.registerClass("Common.App.Policy.Contracts.p");Common.App.Policy.Contracts.l.registerClass("Common.App.Policy.Contracts.l",Sys.EventArgs);Common.App.Policy.Contracts.h.registerClass("Common.App.Policy.Contracts.h",Sys.EventArgs);Common.App.Policy.Contracts.d.registerClass("Common.App.Policy.Contracts.d",Sys.EventArgs);Common.App.Policy.Contracts.n.registerClass("Common.App.Policy.Contracts.n",Sys.EventArgs);Common.App.Policy.Contracts.f.registerClass("Common.App.Policy.Contracts.f",Sys.EventArgs);Common.App.Policy.Contracts.i.registerClass("Common.App.Policy.Contracts.i",Sys.EventArgs);Common.App.Policy.Contracts.k.registerClass("Common.App.Policy.Contracts.k");Common.App.Policy.Contracts.m.registerClass("Common.App.Policy.Contracts.m");Type.registerNamespace("Common.App.Policy");Common.App.Policy.g=function(n,t,i){this.IsPolicyTipAvailable=n;this.GeneralText=t;this.NavigateUrl=i};Common.App.Policy.d=function(){};Common.App.Policy.c=function(n,t,i,r){this.G=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.Z);this.z=Function.createDelegate(this,this.ba);this.x=Function.createDelegate(this,this.Y);this.A=Function.createDelegate(this,this.bb);this.u=Function.createDelegate(this,this.W);this.w=Function.createDelegate(this,this.X);this.t=Function.createDelegate(this,this.U);this.v=Function.createDelegate(this,this.J);this.c=n;this.e=t;this.B=i;this.b=r;this.h={};this.q={};this.n=new($$sc.q.$$(String))($$sc.f.b());this.l=new($$sc.q.$$(String))($$sc.f.b());this.k=i.a("WacApplyManualPolicyLabelIsEnabled");this.b.a().i(this.v);this.b.a().b(this.v);i.a("SupportsPolicies")&&i.c("AppliedPolicyId")&&(this.p=i.c("IrmPolicyTitle"),this.o=i.c("IrmPolicyDescription"));this.r=i.a("ProtectedFile")};Common.App.Policy.c.a=function(n){return n&&n.length?!1:!0};Common.App.Policy.c.b=function(n,t){t.Image16by16=Common.a.p;t.Image16by16Class=n?Common.x.b(Common.App.Policy.a.h):Common.x.b(Common.App.Policy.a.i);t.Visible=!0};Common.App.Policy.c.prototype={c:null,e:null,B:null,b:null,p:null,o:null,r:!1,C:!1,a:null,i:null,d:null,h:null,q:null,j:null,g:null,f:null,n:null,l:null,k:!1,m:null,L:function(){this.c.a(3427834559,2147483648,this.t);this.c.a(497870830,2147483648,this.w);this.c.a(1145315516,2147483648,this.u);this.c.a(2935633379,2147483648,this.A);this.c.a(3134802707,2147483648,this.x);this.c.a(991261903,2147483648,this.z);this.c.a(2875864574,2147483648,this.y);this.e.f(!1)},bd:function(){this.c.e(3427834559,2147483648,this.t);this.c.e(497870830,2147483648,this.w);this.c.e(1145315516,2147483648,this.u);this.c.e(2935633379,2147483648,this.A);this.c.e(3134802707,2147483648,this.x);this.c.e(991261903,2147483648,this.z);this.c.e(2875864574,2147483648,this.y)},W:function(n,t,i,r,u){if(i===1||!this.b.a().c())return 32;var f=u,e;return f.MenuItems=(e=new Common.cF,e.Id="SensitivityList",e.MenuSectionList=[],e.UpdateDynamically=!0,e),Array.add(f.MenuItems.MenuSectionList,this.S(!this.s())),this.a.CustomUrl&&Array.add(f.MenuItems.MenuSectionList,this.R(this.s()?this.a.CustomUrl:Common.e.b(this.a.CustomUrl))),this.s()||(f.PopulationXML=Common.u.g(f.MenuItems)),32},Y:function(n,t,i,r,u){if(i===1||!u||!this.k)return 32;if(this.a=this.b.a().a(),this.b.a().c()){var f=u;f[Common.App.Policy.a.k]=!0}return 32},ba:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o;return f[Common.App.Policy.a.j]=!!(e=f[Common.App.Policy.a.g])&&!!(o=this.h[e])&&o===this.a.AppliedPolicyId,32},Z:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o,s;return f[Common.App.Policy.a.d]=!!(e=f[Common.App.Policy.a.c])&&!!(o=this.h[e])&&!!(s=this.i[o])&&s.c(this.a.AppliedPolicyId),32},bb:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e=f[Common.App.Policy.a.c],o=this.h[e];return this.F(o,f,2)},F:function(n,t,i){var r=i===2||i===8;return this.m&&this.m(n)?(Diag.a.a(42860829,306,50,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call"),this.e.f(!1),32):(Common.App.Policy.a.a in t&&this.b.a().t(t[Common.App.Policy.a.a]),n?this.b.a().k()?(Diag.a.a(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",i),this.e.f(!1),r&&this.D(n,!0,$a.gG)):this.b.a().m(n)?r&&this.B.a("WacLabelingJustificationDialogIsEnabled")&&this.a.RequiredDowngradeJustification&&(n===this.a.AppliedPolicyId||this.d[n].RequiredDowngradeJustification)&&!this.j?this.bc(n):this.O(n===this.a.AppliedPolicyId?"":n,this.j,i):(Diag.a.a(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",i),this.e.f(!1),r&&this.D(n,!0,$a.gz)):(Diag.a.a(42796167,306,50,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",i),this.e.f(!1),r&&this.D("",!1,"")),32)},P:function(n,t,i,r){this.C=r;var u=Common.App.Policy.c.a(n)?null:this.d[n],f=Common.App.Policy.c.a(t)?null:this.d[t];return!u&&!f?(this.b.a().d(29),32):(u&&(this.g=new Common.App.Policy.Contracts.g(u,!1,null)),(!u||f&&u.Order<f.Order)&&(this.f=new Common.App.Policy.Contracts.g(f,!0,i)),this.J(null,null),32)},M:function(){var t;if(this.d={},this.a=this.b.a().a(),this.a)for(var i=this.a.SensitivityLabels,r=i.length,n=0;n<r;++n)t=i[n],this.d[t.Id]=t},N:function(){var i,n,e;if(this.i={},this.a=this.b.a().a(),this.a){for(var u=this.a.SensitivityLabels,o=u.length,t=0;t<o;++t)i=u[t],i.ParentId||(this.i[i.Id]=new($$sc.u.$$(String)));for(var f=this.a.SensitivityLabels,s=f.length,r=0;r<s;++r)(n=f[r],n.ParentId&&n.ParentId in this.i)&&(e=this.i[n.ParentId],e.b(n.Id))}},K:function(){this.k&&this.s()&&(this.a=this.b.a().a(),this.b.a().c())&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))},J:function(){var n,t,i,r;(this.g||this.f)&&(this.b.a().k()||(n=this.d[this.b.a().a().AppliedPolicyId],this.C&&this.g&&!this.H(this.g)&&(!n||n.Order<this.g.c.Order)&&(this.b.a().d(29),t=this.F(this.g.a,{},4),t!==32&&Diag.a.a(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+t)),this.f&&!this.H(this.f)&&(!n||n.Order<this.f.c.Order)&&(i=this.f.a,r=this,this.b.a().l(29,$a.E,String.format($a.fj,this.f.c.DisplayName)+" "+this.f.d,$a.fi,function(){r.F(i,{},8)})),this.g=null,this.f=null))},O:function(n,t,i){this.j=t;this.b.a().u(n);this.e.f(!1);var r=this.d[n],u=r?r.DisplayName:"",f=new Common.App.Policy.Contracts.k(i,u);this.b.a().v(n,this.j,f)},Q:function(n,t,i){n===1?this.O(t===this.a.AppliedPolicyId?"":t,i,2):this.e.f(!1)},bc:function(n){var t=new Common.App.Policy.b(n,this.G);t.X()},D:function(n,t,i){if(t){var r=new CommonUI.d;r.F=Common.a.bR;r.g(0);r.h(1,$a.b);r.bG($a.gw,i,null)}else this.b.a().o()},s:function(){return!!this.e&&!!this.e.a()&&this.e.a().a()},U:function(n,t,i){return i===1?32:(i===2,32)},X:function(n,t,i,r,u){var f,e,s;if(i===1||(this.a=this.b.a().a(),!this.a||!u))return 32;if(f=u,f.LabelText=null,f.Alt=null,f.Image16by16=null,f.Image16by16Class=null,f.Visible=!1,this.a.AreLabelsAvailable){e=null;for(var h=this.a.SensitivityLabels,c=h.length,o=0;o<c;++o)if(s=h[o],s.Id.toLowerCase()===this.a.AppliedPolicyId.toLowerCase()){e=s;break}e&&(f.LabelText=this.V(e),f.Alt=e.Tooltip,this.r=Common.a.s=e.IsEndpointProtectionEnabled)}else{if(!this.p)return 32;f.LabelText=this.p;this.o&&(f.Alt=this.o)}return f.LabelText&&Common.App.Policy.c.b(this.r,f),32},V:function(n){return this.d?n.ParentId&&this.d[n.ParentId]?this.d[n.ParentId].DisplayName+"\\"+n.DisplayName:n.DisplayName:(Diag.a.a(4282e4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),n.DisplayName)},R:function(n){var i=this.E("LearnMoreSection",!0),r="SensitivityLearnMore",t,u=(t=new Common.ce,t.Id=r,t.ExternalId=r,t.MenuItemId=n,t.LabelText=$a.bd,t.Command="1959943459",t.Image16by16=Common.a.p,t.Image16by16Class=Common.x.b(Common.App.Policy.a.e),t.Visible=!0,t.Alt=$a.L_LearnMoreTooltip,t.KeyTip="L",t);return Array.add(i.ControlList,u),i},I:function(n,t,i,r,u,f,e,o){var c="Toggle_"+e+"_"+t,h=o?Common.e.b(c):c,s,l=(s=new Common.cz,s.Id=h,s.ExternalId=h,s.LabelText=o?Common.e.b(i):i,s.Command="2935633379",s.MenuItemId=h,s.QueryCommand="991261903",s.CheckedImage=Common.a.p,s.CheckedImageClass=Common.x.b(Common.App.Policy.a.b),s.Image16by16=Common.a.p,s.Image16by16Class=Common.x.b(Common.App.Policy.a.b),s.Visible=!0,s.Alt=o?Common.e.b(r):r,s.IsChecked=u,s.AriaLabel="menuitemradio",s.KeyTip=f,s);return h=c,this.h[h]=n,this.q[n]=h,l},E:function(n,t){var i;return i=new Common.co,i.Title="",i.Id=n,i.DisplayMode=Common.App.Policy.a.f,i.ShowMenuSectionSeparator=t,i.ControlsId="Ctrl_"+n,i.ControlList=[],i},T:function(n,t,i){for(var u=this.E(n+"Sub",!1),f=1,e=t.$$lge(),o,r;e.$$mn();)o=e.$$cu(),r=this.d[o],r&&r.Enabled&&Array.add(u.ControlList,this.I(r.Id,r.Name,r.DisplayName,r.Tooltip,r.Id===this.a.AppliedPolicyId,f.toString(),n,i)),f++;return u},S:function(n){var e=this.E("SensitivitySection",!1),o=1,h=this.i,s,f,r,t,u;for(s in h){var c={key:s,value:h[s]},l=c.value,i=this.d[c.key];i&&i.Enabled&&(l.e.length?(f=n?Common.e.b(i.Name):i.Name,u=(t=new Common.cB,t.Id=f,t.ExternalId=f,t.LabelText=n?Common.e.b(i.DisplayName):i.DisplayName,t.Command="798637440",t.QueryCommand="2875864574",t.Menu=(r=new Common.cF,r.Title="",r.MenuSectionList=[],r.UpdateDynamically=!0,r),t.Image16by16=Common.a.p,t.Image16by16Class=Common.x.b(Common.App.Policy.a.b),t.ImageIsVisible=!1,t.ImageUsesSpaceWhileInvisible=!0,t.AriaLabel="menuitemradio",t.KeyTip=o.toString(),t),Array.add(u.Menu.MenuSectionList,this.T(f,l,n)),Array.add(e.ControlList,u),this.h[u.Id]=i.Id,this.q[i.Id]=u.Id):Array.add(e.ControlList,this.I(i.Id,i.Name,i.DisplayName,i.Tooltip,i.Id===this.a.AppliedPolicyId,o.toString(),"",n)),o++)}return e},H:function(n){return n.b&&this.n.b(n.a)||!n.b&&this.l.b(n.a)?!0:(n.b?this.n.a(n.a):this.l.a(n.a),!1)}};Common.App.Policy.a=function(){};Common.App.Policy.e=function(n,t,i,r,u){this.W=Function.createDelegate(this,this.bm);this.ba=Function.createDelegate(this,this.bq);this.bb=Function.createDelegate(this,this.br);this.Y=Function.createDelegate(this,this.bo);this.Z=Function.createDelegate(this,this.bp);this.V=Function.createDelegate(this,this.bl);this.X=Function.createDelegate(this,this.bn);this.w=new Common.T;this.B=n;this.G=t;this.y=i;this.H=r;this.x=new Common.App.Policy.Contracts.e;this.P=this.B.h.PolicyHandlerEndpointName||"PolicyHandler.ashx";this.K=u;this.R=n.a("WacApplyManualPolicyLabelIsEnabled")};Common.App.Policy.e.prototype={P:null,B:null,L:null,G:null,H:0,N:0,M:0,C:0,E:"",O:null,S:!1,F:null,D:null,x:null,K:null,y:null,I:null,z:null,A:null,J:null,g:function(n){this.w.q("PolicyTipEvent",n)},f:function(n){this.w.q("LabelInfoUpdateEvent",n)},i:function(n){this.w.q("SetPolicyLabelEventKey",n)},s:function(n){this.w.s("SetPolicyLabelEventKey",n)},b:function(n){this.w.q("SetPolicyLabelFailureEventKey",n)},r:function(n){this.w.s("SetPolicyLabelFailureEventKey",n)},e:function(n){this.w.q("AddAutoPolicyBusinessBarEntryEventKey",n)},p:function(n){this.w.s("AddAutoPolicyBusinessBarEntryEventKey",n)},h:function(n){this.w.q("RemoveAutoPolicyBusinessBarEntryEventKey",n)},q:function(n){this.w.s("RemoveAutoPolicyBusinessBarEntryEventKey",n)},R:!1,j:function(){this.y&&(this.I=this.y.a("WebServiceCall","Call Get Policy Endpoint On Server"));this.G.a(this.T("datalosspolicy",!1),1,null,null,!0,2,this.X,this.V,null,null,!1,null,null,null,null,!1,null,!1);this.N++;Diag.a.a(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.P,this.N)},n:function(n,t,i,r){if(this.B.a("WacLabelingGetPolicyLabelsIsEnabled")){this.E=n;this.F=t;this.D=i;this.y&&(this.z=this.y.a("WebServiceCall","Call Get Policy Endpoint On Server"));var u={};u["X-AppliedPolicyId"]=n;this.G.a(this.T("getpolicylabels",r),1,null,u,!0,2,this.Z,this.Y,null,null,!1,null,null,"22",null,!1,null,!1);this.M++;Diag.a.a(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.M)}},a:function(){if(!this.F)return this.x;var r=JSON.stringify(this.x),n,t,i;return(i=Common.bm.a(Common.App.Policy.Contracts.e,r,t={val:n}),n=t.val,i)?(this.F(n),n):(Diag.a.a(41754699,306,15,"PolicyManager.GetPolicyLabelsData - Trying to deserialize the policy data failed."),this.x)},bp:function(n){var t,i,r,u,f,e;(this.z&&(this.z.a(),this.z=null),t="",r=this.U(n,i={val:t}),t=i.val,r)&&(Diag.a.a(34996493,306,50,"Request to get label policy data succeeded."),u=this.bt(t),this.bv(new Common.App.Policy.Contracts.d),!this.S&&u&&this.B.a("WacApplyManualPolicyLabelIsEnabled")&&(f=!this.B.a("LicensingForAclpIsEnabled"),f?this.bf(new Common.App.Policy.Contracts.d):this.K&&(e=this,this.K.a(function(n){n.a("MsoClpSpTwo",!0).then(function(n){return n&&e.bf(new Common.App.Policy.Contracts.d),null})})),this.S=!0))},bo:function(n){if(this.z&&(this.z.a(),this.z=null),this.M<=this.H){this.n(this.E,this.F,this.D,!1);return}Diag.a.a(34996494,306,15,"Request to get label policy failed with error response: {0}.",n?n.b?n.b.i:null:null)},bn:function(n){this.bd();var t="",i,r;(r=this.U(n,i={val:t}),t=i.val,r)&&(Diag.a.a(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.y&&(this.J=this.y.a("Task","Parse and Handle Get Policy Response")),this.bs(t),this.J)&&(this.J.a(),this.J=null)},bl:function(n){if(this.bd(),this.N<=this.H){this.j();return}Diag.a.a(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",n?n.b?n.b.i:null:null)},k:function(){return this.C>0},u:function(n){this.x.AppliedPolicyId=n},v:function(n,t,i){if(this.R){this.y&&(this.A=this.y.a("WebServiceCall","Call Set Policy Endpoint On Server"));var r={};r["X-SelectedPolicyLabelId"]=n;t&&(r["X-SetPolicyLabelJustification"]=t);this.O&&(r["X-AppLockId"]=this.O);i?(r["X-SetPolicyLabelActionSource"]=this.bi(i),r["X-SetPolicyLabelAssignmentMethod"]=this.bj(i)):(r["X-SetPolicyLabelActionSource"]=Common.App.Policy.Contracts.a.toString(3),r["X-SetPolicyLabelAssignmentMethod"]=Common.App.Policy.Contracts.b.toString(1));this.G.a(this.T("setpolicylabel",!0),1,null,r,!0,2,this.bb,this.ba,i,null,!1,null,null,"32",null,!1,null,!1);this.C++;Diag.a.a(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.C)}},br:function(n){var t,u,f,e;this.A&&(this.A.a(),this.A=null);this.bc(n,f={val:t},e={val:u});t=f.val;u=e.val;var i=n.b.f,o=i?i.a:2,r="",s,h;if(!(h=this.U(n,s={val:r}),r=s.val,h)){this.Q(o);return}Diag.a.a(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",o);this.C=0;this.bu(r,t,i)},bq:function(n){var t,i,f,e,r,u;if(this.A&&(this.A.a(),this.A=null),this.bc(n,f={val:t},e={val:i}),t=f.val,i=e.val,this.C<=this.H){this.v(t,i,null);return}r=n.b.f;u=r?r.a:2;Diag.a.a(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",n?n.b?n.b.i:null:null,u);this.C=0;this.Q(u)},m:function(n){var i,r,t;if(!n)return!1;if(Common.a.F&&Common.a.F.a()||this.D&&this.D())return!0;i=null;r=null;for(var f=this.x.SensitivityLabels,e=f.length,u=0;u<e;++u)t=f[u],t.Id===n&&(i=t),t.Id===this.E&&(r=t);return i?i.IsEndpointProtectionEnabled===(!!r&&r.IsEndpointProtectionEnabled):!1},l:function(n,t,i,r,u){n===28?this.be(new Common.App.Policy.Contracts.f(n,t,i,r,u,!1)):this.be(new Common.App.Policy.Contracts.f(n,t,i,r,u,!0))},d:function(n){n===28?this.bh(new Common.App.Policy.Contracts.i(n,!1)):this.bh(new Common.App.Policy.Contracts.i(n,!0))},c:function(){var n=this;return!!this.x&&this.x.AreLabelsAvailable&&!!this.x.SensitivityLabels&&this.x.SensitivityLabels.length>0&&Common.bT.a(this.x.SensitivityLabels,function(n){return!!n&&n.Enabled})},T:function(n,t){var r=this.B.h.PolicyHandlerWebServiceBase||Common.a.b().a().i(),i=String.format("{0}{1}?action={2}&{3}",r,this.P,n,Common.a.e);return n==="setpolicylabel"&&Common.a.F&&Common.a.F.b()&&(i=Common.k.a(i,"sl","1",!1)),t&&(i=Common.k.a(i,"cbd","1",!1)),i},bc:function(n,t,i){t.val=i.val=null;n&&n.a()&&n.a().d&&n.a().d.get_headers()&&(t.val=n.a().d.get_headers()["X-SelectedPolicyLabelId"],i.val=n.a().d.get_headers()["X-SetPolicyLabelJustification"])},U:function(n,t){return(t.val=n?n.b?n.b.a:null:null,!t.val||!t.val.length||this.bk(t.val))?(Diag.a.a(25565152,306,10,"No response data from policy endpoint."),!1):!0},bs:function(n){var t;try{t=JSON.parse(n)}catch(i){Diag.a.a(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(!t){Diag.a.a(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.");return}if(!t.IsPolicyTipAvailable){Diag.a.a(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");return}switch(t.IsPolicyTipAvailable.toLowerCase()){case"false":Diag.a.a(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");return;case"true":Diag.a.a(25565186,306,50,"DLP Policy is enabled on this document.");this.L=t.NavigateUrl;this.by(t.GeneralText,this.W);break;default:Diag.a.a(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",t.IsPolicyTipAvailable)}},bu:function(n,t,i){var r=i?i.a:2,u,f,e,o;if(!(e=Common.bm.a(Common.App.Policy.Contracts.m,n,f={val:u}),u=f.val,e)){Diag.a.a(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",r);return}u?u.IsSuccessful?(Diag.a.a(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",r),this.bx(t,r),this.d(28),i&&r===4&&(o=this,this.l(28,$a.E,String.format($a.fh,i.b),$a.m,function(){})),this.n(t,this.F,this.D,!1)):(Diag.a.a(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",r),this.Q(r)):(Diag.a.a(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",r),this.Q(r))},Q:function(n){this.x.AppliedPolicyId=this.E;this.bg(new Common.App.Policy.Contracts.h);(n===2||n===8)&&this.o()},bx:function(n,t){var i;this.x.AppliedPolicyId=this.E=n;for(var u=this.x.SensitivityLabels,f=u.length,r=0;r<f;++r)if(i=u[r],i.Id===n){Common.a.bE=i.IsEndpointProtectionEnabled;Common.a.s=i.IsEndpointProtectionEnabled;break}this.bw(new Common.App.Policy.Contracts.n(n,t))},bt:function(n){var t,i,r;return(r=Common.bm.a(Common.App.Policy.Contracts.e,n,i={val:t}),t=i.val,r)?t?t.AreLabelsAvailable?(this.x=t,this.c()&&Diag.a.a(51197846,306,50,"Labels are available for display after GetPolicyLabels call."),this.bg(new Common.App.Policy.Contracts.h),!0):!1:(Diag.a.a(42467542,306,10,"policyData is null after deserializing label policy data response."),!1):(Diag.a.a(34996495,306,10,"Error when deserializing label policy data response."),!1)},bg:function(n){Diag.a.a(35393610,306,50,"Raising label info update event.");this.w.p("LabelInfoUpdateEvent",n,null)},bv:function(n){Diag.a.a(50676305,306,50,"Raising get policy label event.");this.w.p("GetPolicyLabelEventKey",n,null)},bf:function(n){Diag.a.a(50944077,306,50,"Raising get policy label event.");this.w.p("GetPolicyLabelEventKey",n,null)},bw:function(n){Diag.a.a(41799710,306,50,"Raising set policy label event.");this.w.p("SetPolicyLabelEventKey",n,null)},be:function(n){Diag.a.a(51128227,306,50,"Raising an add auto policy business bar entry event.");this.w.p("AddAutoPolicyBusinessBarEntryEventKey",n,null)},bh:function(n){Diag.a.a(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.w.p("RemoveAutoPolicyBusinessBarEntryEventKey",n,null)},by:function(n,t){Diag.a.a(34996496,306,50,"Showing policy tip to user.");this.w.p("PolicyTipEvent",new Common.App.Policy.Contracts.l($a.E,n,$a.fk,t),null)},o:function(){Diag.a.a(42074656,306,50,"Raising set policy label failure event.");this.w.p("SetPolicyLabelFailureEventKey",new Sys.EventArgs,null)},t:function(n){this.O=n},bm:function(){this.L?(Diag.a.a(25565187,306,50,"DLP override button was clicked."),Common.g.e(this.L)):Diag.a.a(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")},bk:function(n){return!n.startsWith("<")||n.indexOf("Error")===-1&&n.indexOf("Unavailable")===-1?!1:(Diag.a.a(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint."),!0)},bd:function(){this.I&&(this.I.a(),this.I=null)},bi:function(n){if(!n)return Common.App.Policy.Contracts.a.toString(3);var t=n.a;switch(t){case 0:return Common.App.Policy.Contracts.a.toString(3);case 4:return Common.App.Policy.Contracts.a.toString(1);case 1:return Common.App.Policy.Contracts.a.toString(0);case 16:return Common.App.Policy.Contracts.a.toString(4);case 2:return Common.App.Policy.Contracts.a.toString(3);case 8:return Common.App.Policy.Contracts.a.toString(2);default:return Common.App.Policy.Contracts.a.toString(3)}},bj:function(n){if(!n)return Common.App.Policy.Contracts.b.toString(1);var t=n.a,i=Common.App.Policy.Contracts.b.toString(1);return(t===4||t===1)&&(i=Common.App.Policy.Contracts.b.toString(0)),i}};Common.App.Policy.f=function(){this.l=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.v);this.k=Function.createDelegate(this,this.r);this.m=Function.createDelegate(this,this.t)};Common.App.Policy.f.a=function(){Common.App.a.a().a(new Common.App.Policy.f,0,!1)};Common.App.Policy.f.prototype={a:function(){return"Common.App.Policy"},d:null,f:null,g:null,e:null,h:null,i:null,b:function(){if(Common.a.a.a("ShouldInitCommonPolicyPackage")){if(Common.a.a.a("IsDataLossPreventionEnabledForUser")&&Common.a.b()){this.d=this.f.a(Common.App.Policy.Contracts.c);this.d.g(this.m);Diag.a.a(36537375,306,50,"PolicyManager is created successfully.");var n=this;Common.App.AppLifecycleManager.get_instance().a(6,function(){n.d.j()},3)}Common.a.a.a("WacLabelingPoliciesIsEnabled")&&Common.a.a.a("SupportsPolicies")&&(Common.a.D("Microsoft.Office.Web.SessionSettings.IWacApplyManualPolicyLabelSettings"),Common.App.AppLifecycleManager.get_instance().a(6,this.k,3))}},c:function(n){var i=this,t;n.b(Common.App.Policy.Contracts.c).a().b(function(){return new Common.App.Policy.e(Common.a.a,Common.a.d,Common.a.b().d(),Common.a.a.b("MaxGetPolicyRetries",1),n.c(Common.App.ApplicationFeatureHelper.a))});t=this;n.b(Common.App.Policy.c).c(Common.App.Policy.Contracts.j).a().b(function(){return new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,n.e(Common.App.Policy.Contracts.c))});this.f=n},r:function(){this.g=this.f.a(Common.App.Policy.c);this.g.L();this.e=this.f.d(CommonUI.s);this.d||(this.d=this.f.a(Common.App.Policy.Contracts.c));this.d.f(this.o);Common.a.a.a("WacApplyManualPolicyLabelIsEnabled")&&(this.d.b(this.n),this.d.e(this.j),this.d.h(this.l))},v:function(){this.g.N();this.g.M();this.g.K();Common.a.b().f(!1)},t:function(n,t){var i=this.p(t.d,t.c,null,t.b,t.a),r=Common.a.b().a();if(!r.r(i,!0)){Diag.a.a(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.");return}Diag.a.a(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")},u:function(){var n=this.p($a.gy,$a.gx,null,null,null),t=Common.a.b().a();if(!t.r(n,!0)){Diag.a.a(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.");return}Diag.a.a(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")},s:function(n,t){var i;i=t.a?this.i:this.h;i&&this.e&&this.e.d(t.b)&&this.e.a(i)},q:function(n,t){if(this.e){this.d.d(t.e);var i=new CommonUI.j(t.d,t.c,null);i.e(t.e);i.d(!0);i.k(3);i.c(t.a,t.b,t.a,!0);this.e.b(i,!1);t.f?this.i=i:this.h=i}},p:function(n,t,i,r,u){var f=new CommonUI.j(n,t,i);return f.e(21),f.d(!0),r&&f.c(u,r,"",!1),f}};Common.App.Policy.b=function(n,t){this.e=Function.createDelegate(this,this.V);this.O=Function.createDelegate(this,this.bg);this.d=Function.createDelegate(this,this.U);this.a=[$a.gC,$a.gA,$a.gD];Common.App.Policy.b.initializeBase(this);this.c=n;this.b=t;this.m=this.T();this.g(1);this.n=Common.App.Policy.b.d;this.h(1,$a.cO);this.C(1,!1)};Common.App.Policy.b.prototype={c:null,b:null,X:function(){for(var n={},t=0;t<this.a.length;t++)n[Common.App.Policy.b.b+t]=!1;n[Common.App.Policy.b.a]="";this.l($a.gF,this.d,n);this.W();Common.j.a($get(Common.App.Policy.b.a),"input",this.O)},bn:function(){var t=$get(Common.App.Policy.b.a);if(t.disabled)return!0;var n=t.value,i=n.length<2,r=n.length>500,u=new RegExp("[{|}|;|\\\\]").test(n),f=Common.e.K(n)==="";return!i&&!r&&!u&&!f},U:function(n,t){var r="",i;if(n===1)for(i=0;i<this.a.length;i++)if(t[Common.App.Policy.b.b+i]){r=i===this.a.length-1?t[Common.App.Policy.b.a]:this.a[i];break}this.b(n,this.c,r)},bg:function(n){var t=n.target;t&&this.C(1,this.bn())},T:function(){return CommonUI.b.a(Common.App.Policy.b.e,Common.a.p,Common.x.b(Common.App.Policy.b.c),$a.gB,this.a[0],this.a[1],this.a[2],$a.gE)},W:function(){for(var i,t=document.getElementsByName(Common.App.Policy.b.f),n=0;n<t.length;n++)i=t[n],Common.j.a(i,"focus",this.e)},V:function(n){var i=n.target,t;i&&(i.checked=!0,t=$get(Common.App.Policy.b.a),i.id===Common.App.Policy.b.b+(this.a.length-1)?(t.disabled=!1,Sys.UI.DomElement.setVisible(t,!0),t.focus()):(t.disabled=!0,i.focus()),this.C(1,this.bn()))}};Common.App.Policy.c.registerClass("Common.App.Policy.c",null,Common.App.Policy.Contracts.j);Common.App.Policy.b.registerClass("Common.App.Policy.b",CommonUI.b);Common.App.Policy.d.a="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> <\/div> <\/div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}<\/label> <\/div> <\/div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'><\/input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'><\/input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'><\/input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"><\/textarea> <\/div>";Common.App.Policy.a.h="sbProtectForm14";Common.App.Policy.a.i="SBStatusBarMarkAsReadOnly14";Common.App.Policy.a.e="Info_16x16x32";Common.App.Policy.a.b="QuickSearchCompletedToday_16x16x32";Common.App.Policy.a.j="On";Common.App.Policy.a.k="Visible";Common.App.Policy.a.d="ImageIsVisible";Common.App.Policy.a.c="SourceControlId";Common.App.Policy.a.g="MenuItemId";Common.App.Policy.a.f="Menu";Common.App.Policy.a.a="AppLockId";Common.App.Policy.b.e=Common.App.Policy.d.a;Common.App.Policy.b.f="ListRadioBox";Common.App.Policy.b.b="radiobox";Common.App.Policy.b.a="txtJustification";Common.App.Policy.b.c="Info_32x32x32";Common.App.Policy.b.d="JustificationDialog";Common.App.Policy.f.a();Type.registerNamespace("_Ewa");_Ewa.Jo=function(n,t,i,r){this.g=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.k);this.c=n;this.d=t;this.b=i;this.a=r;this.b.e(this.f);this.b.h(this.e);this.h()};_Ewa.Jo.prototype={c:null,b:null,a:null,d:null,dispose:function(){this.b.p(this.f);this.b.q(this.e);this.c=null;this.d=null;this.b=null;this.a.dispose()},i:function(n,t){var i,e;if(Diag.a.a(50935426,306,50,"LabellingAnnotation Called Successfully."),i=t.a,!i){Diag.a.a(50974996,306,50,"LabellingAnnotation is null.");return}var r=null,u=null,f=null;i.automatic&&i.automatic.sensitivityLabel&&i.automatic.sensitivityLabel.id&&(r=i.automatic.sensitivityLabel.id);i.recommended&&i.recommended.sensitivityLabel&&i.recommended.sensitivityLabel.id&&(u=i.recommended.sensitivityLabel.id,i.recommended.sensitivityLabel.policyTip&&(f=i.recommended.sensitivityLabel.policyTip));e=this.d.P(r,u,f,!0);Diag.a.a(51241992,306,50,"ApplyAutoPolicyLabel called from LabellingAnnotationHandler")},h:function(){this.c.b(_Ewa.pt.a(),this.g);var n=this;this.c.a(_Ewa.pt.a()).then(function(){})},j:function(n,t){if(!t){Diag.a.a(51241993,306,15,"RemoveAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.");return}t.a&&this.a.c(32)?(this.a.b(32),Diag.a.a(51241994,306,50,"Remove entry to RecommendedSensitivityLabelBusinessBarEntry succeeded.")):!t.a&&this.a.c(31)&&(this.a.b(31),Diag.a.a(51241995,306,50,"Remove entry to AutomaticSensitivityLabelBusinessBarEntry succeeded."))},k:function(n,t){var i,r;if(!t){Diag.a.a(51241996,306,15,"ShowAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.");return}t.f?(i=this,this.a.i(t.d,t.c,t.a,function(n){t.b(n);i.a.c(32)&&i.a.b(32)}),Diag.a.a(51241997,306,50,"Add entry to RecommendedSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):(r=this,this.a.f(t.d,t.c,t.a,function(n){t.b(n);r.a.c(31)&&r.a.b(31)}),Diag.a.a(51241998,306,50,"Add entry to AutomaticSensitivityLabelBusinessBarEntry succeeded. Message is shown to user."))}};_Ewa.uW=function(n,t){_Ewa.uW.initializeBase(this,[n,_Ewa.uW.a(n,t)])};_Ewa.uW.a=function(n,t){return n.s()&2?_Ewa.bc.a(3,1,0,t?1606:1608,0,t?-1237306487:-571684981,t?"SensitivityLabelBlockApplyLabelOpenInDesktop":"SensitivityLabelBlockRevertLabelOpenInDesktop"):_Ewa.bc.a(1,1,0,t?1607:1609,0,t?-313914360:392034310,t?"SensitivityLabelBlockApplyLabel":"SensitivityLabelBlockRevertLabel")};_Ewa.uW.prototype={D:function(){var t,n;_Ewa.dt.prototype.D.call(this);this.x.Appearance&1&&this.z.s()&2&&(t=this.n(0),_Ewa.a.W(t.get_element(),_Ewa.ClientStringManager.a().a(1096)),n=this,this.f(function(){0===n.G&&n.z.s()&2&&(Diag.a.a(50373725,306,50,"BlockSenitivityLabelActionDialog : Opening the book in excel desktop."),_Ewa.e.cw(_Ewa.k.b(_Ewa.fL,n.z.b(),55,56),function(n){n.a().a()},n.z.i(),3))}))}};_Ewa.uX=function(n){_Ewa.uX.initializeBase(this);this.h=n;this.j()};_Ewa.uX.a=function(n){n.b().b(_Ewa.Vq.$$(_Ewa.hS),274,new _Ewa.uX(n))};_Ewa.uX.prototype={h:null,b:function(){var t=_Ewa.k.b(_Ewa.cF,this.h.b(),4,3),i=Common.a.d,r=Common.a.a,n=this;_Ewa.e.cw(t,function(){try{var u=new($$sc.y.$$(Common.App.Policy.Contracts.c))(function(){return new Common.App.Policy.e(r,i,Common.a.b().d(),n.h.f().MaxGetPolicyRetries,null)}),f=new($$sc.y.$$(Common.App.Policy.c))(function(){return new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,u)});n.i(n.h.b().a(_Ewa.hS,273,!1)||new _Ewa.PolicyManagerWrapper(u.a(),f.a(),t.a(),n.h,Common.a.a));n.k(f.a(),t.a(),u.a())}catch(e){Diag.a.a(36444224,306,10,"PolicyManager was not created successfully [Exception: {0}]",e.toString());throw e;}},this.dm(),3)},k:function(n,t,i){if(this.h.a(522)&&this.h.a(525)&&this.h.a(442)){Diag.a.a(50935427,306,50,"Auto Labelling is enabled.");var r=this;_Ewa.e.cw(_Ewa.k.a(_Ewa.kV,this.h.b(),325,this.dm()),function(u){var f=u.a(),e;if(!f){Diag.a.a(50935428,306,10," Error occurred while creating an augmentationLoopManager instance");r.i(null);return}Diag.a.a(50935429,306,50,"AugmentationLoopManager instantiated successfully.");e=new _Ewa.Jo(f,n,i,t)},this.dm(),3)}}};_Ewa.PolicyManagerWrapper=function(n,t,i,r,u){if(this.A=Function.createDelegate(this,this.N),this.z=Function.createDelegate(this,this.I),this.C=Function.createDelegate(this,this.T),this.r=Function.createDelegate(this,this.M),this.s=Function.createDelegate(this,this.O),this.t=Function.createDelegate(this,this.R),this.y=Function.createDelegate(this,this.G),this.B=Function.createDelegate(this,this.Q),_Ewa.PolicyManagerWrapper.initializeBase(this,[!1]),Diag.a.a(34402886,306,50,"DataLossPrevention feature is Enabled and launched on Excel."),this.f=r,this.i=n,this.p=i,this.m=u,this.i.g(this.B),this.K(),this.l=t,this.f.a(521)&&this.m.a("SupportsPolicies")){this.g=this.m.c("AppliedPolicyId");this.l.L();var f=this;this.f.b().c(_Ewa.bP,29,function(n){f.n=n;n.c(f)});this.E();this.P();this.f.a(445)&&(this.l.m=this.y)}};_Ewa.PolicyManagerWrapper.prototype={i:null,f:null,m:null,n:null,l:null,o:!1,p:null,k:function(n){this.dn("LabelInfoChangedKey",n)},j:function(n){this.dp("LabelInfoChangedKey",n)},h:function(){return!0},d:function(n,t){if(n!=="QueryPolicyLabel")return!1;var i=Common.a.c().c(497870830,2,t,null);return i===32},dispose:function(){this.n&&(this.n.b(this),this.n=null);this.l.bd();this.o=!1;this.f.a(522)&&(this.i.r(this.t),this.i.s(this.s),this.f.c().v(this.r));_Ewa.cE.prototype.dispose.call(this)},x:null,e:function(){return this.x},w:null,c:function(){return this.w},u:null,a:function(){return this.u},v:null,b:function(){return this.v},g:null,E:function(){this.dk("LabelInfoChangedKey",null,null)},K:function(){this.i.j()},L:function(){return this.f.f().DocumentHostInfo.TenantId},P:function(){Common.a.D("Microsoft.Office.Excel.Server.Flighting.IDenyListApplyManualPolicyLabel");var n=this;Common.App.AppLifecycleManager.get_instance().a(10,function(){n.i.f(n.C);n.f.a(522)&&(n.i.b(n.t),n.i.i(n.s),n.f.c().u(n.r));n.g&&n.g.length?n.q(!0,!1):n.J(n.L())},3)},J:function(n){Diag.a.a(41740191,306,50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",n.length);var t=this.f.d().a().b(),i=this;_Ewa.uY.b(this.f.d().a(),n,function(n){i.S(n)},null,null,t)},S:function(n){Diag.a.a(41740192,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");n&&!_Ewa.T.a(n)&&(this.g=n.Result);this.q(!0,!1);this.g?Diag.a.a(41740193,306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.g.length):Diag.a.a(41740194,306,15,"PolicyManagerWrapper: LabelId is invalid")},q:function(n,t){n&&Diag.a.a(51238051,306,50,"PolicyManagerWrapper.GetDocumentPolicyLabels: Workbook info hasLabel:{0}, isProtectedFile:{1}",!!this.g&&this.g.length>0,this.m.a("ProtectedFile"));this.i.n(this.g,this.z,null,t)},Q:function(n,t){if(!t){Diag.a.a(34402887,306,15,"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.");return}this.x=t.d;this.w=t.c;this.u=t.a;this.v=t.b;this.p.a(25,null);Diag.a.a(34402888,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")},R:function(){this.p.a(37,null)},T:function(){this.l&&(Diag.a.a(41961095,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),this.l.N(),this.l.M(),this.f.a(522)&&this.l.K());this.H();this.E()},O:function(n,t){Diag.a.a(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label.");var r=this.i.a(),u=JSON.stringify(r),f=this.f.d().a(),i=this,e=function(n){return _Ewa.uY.a(f,u,t.a,i.f.f().DocumentHostInfo.TenantId,_Ewa.n.a.call(null,n,i.A),null,t.a,null)},o=this;_Ewa.O.a(this.f.g(),e,function(n){return new _Ewa.G(215,0,n,0,null)},null)},H:function(){this.o||(this.f.E(),this.o=!0)},N:function(n,t){Diag.a.a(42763015,306,100,"PolicyManagerWrapper.OnApplyManualPolicyLabelSuccessCallback: Invoking GetPolicyLabels to update UI.");this.g=t;this.q(!1,!0)},I:function(n){var i,e;if(!this.f.a(445))for(var u=n.SensitivityLabels,o=u.length,t=0;t<o;++t){i=u[t];for(var f=i.LabelActions,s=f.length,r=0;r<s;++r)if(e=f[r],_Ewa.i.a(e.Name,"ApplyWatermark",!1)){i.Enabled=!1;break}}},G:function(n){var u=this.i.a(),i,r,t;if(!u)return Diag.a.a(50341184,306,15,"PolicyManagerWrapper.BlockSetSensitivityCall: policyLabelsData is null."),!1;i=null;r=null;for(var e=u.SensitivityLabels,o=e.length,f=0;f<o;++f)t=e[f],_Ewa.i.a(t.Id,n,!1)&&(r=t),_Ewa.i.a(t.Id,u.AppliedPolicyId,!1)&&(i=t);return i&&this.D(i)?(Diag.a.a(50341185,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: currentAppliedSensitivityLabel has watermark label action."),this.F(!1),!0):r&&this.D(r)?(Diag.a.a(50341186,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: selectedSensitivityLabel has watermark label action."),this.F(!0),!0):!1},D:function(n){for(var r,i=n.LabelActions,u=i.length,t=0;t<u;++t)if(r=i[t],_Ewa.i.a(r.Name,"ApplyWatermark",!1))return!0;return!1},F:function(n){var t=new _Ewa.uW(this.f,n);t.v(!1)},M:function(){var n=this.f.c().D();n&&!_Ewa.i.a(n.AppliedPolicyLabelId,this.g,!1)&&(Diag.a.a(42844434,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),this.g=n.AppliedPolicyLabelId,this.q(!1,!0))}};_Ewa.uY=function(){};_Ewa.uY.b=function(n,t,i,r,u,f){var e=n.a(1,f);return e.tenantId=t,_Ewa.f.a(n,"GetPolicyLabelId",e,i,r,u,4,null)};_Ewa.uY.a=function(n,t,i,r,u,f,e,o){var s=n.a(41,o);return s.labelsInfoJson=t,s.appliedLabelId=i,s.tenantId=r,_Ewa.f.a(n,"ApplyManualPolicyLabel",s,u,f,e,0,null)};_Ewa.Jp=function(n){this.a=n};_Ewa.Jp.prototype={a:null,u:function(){return!1},s:function(n,t,i){var r;switch(t.a){case 2935633379:return this.a.k().FileCoauthorable||(i[Common.App.Policy.a.a]=this.a.k().ExclusiveLockId),r=Common.a.c().c(2935633379,2,i,null),$$sc.a.a(Boolean,r===32);case 2875864574:return r=Common.a.c().c(2875864574,2,i,null),$$sc.a.a(Boolean,r===32);case 991261903:return r=Common.a.c().c(991261903,2,i,null),$$sc.a.a(Boolean,r===32);default:return _Ewa.J.a(t.a)}},r:function(n,t){switch(t.a){case 2935633379:case 2875864574:case 991261903:return this.a.a(521)&&this.a.a(522);default:return!1}},t:function(n,t,i){switch(t){case"PopulateSensitivityFlyout":if(!this.a.a(521)||!this.a.a(522))return!1;var r=Common.a.c().c(1145315516,2,i,null);return r===32;default:return!1}}};_Ewa.uZ=function(n){_Ewa.uZ.initializeBase(this,[n])};_Ewa.uZ.a=function(n){_Ewa.Y.a(315,new _Ewa.uZ(n))};_Ewa.uZ.prototype={l:function(){this.k([new _Ewa.Jp(this.h)],null)}};_Ewa.NK=function(){};_Ewa.NK.prototype={match:null,offset:0,length:0};_Ewa.NN=function(){};_Ewa.NN.prototype={idMatch:null,offset:0,length:0,evidences:null};_Ewa.NS=function(){_Ewa.NS.initializeBase(this);var n;this.H_=(n=new _Ewa.gz,n.T_=_Ewa.NS.getTypeName(),n.B_=_Ewa.NS.getBaseTypes(),n)};_Ewa.NS.prototype={sensitiveItemId:null,displayName:null,uniqueCount:0,confidence:0,matches:null};_Ewa.NL=function(){};_Ewa.NL.prototype={name:null,placement:null,fontSize:null,text:null,fontColor:null,margin:null,alignment:null,encryptWith:null,templateId:null,availableForEncryption:null};_Ewa.NT=function(){};_Ewa.NT.prototype={id:null,name:null,description:null,toolTip:null,policyTip:null,isEndpointProtectionEnabled:null,labelActions:null,displayName:null,priority:null,applicationMode:null};_Ewa.NQ=function(){};_Ewa.NQ.prototype={id:null,name:null,description:null,rulePackageId:null,rulePackageType:null,publisherName:null};_Ewa.NP=function(){};_Ewa.NP.prototype={id:null,name:null};_Ewa.NM=function(){};_Ewa.NM.prototype={sensitivityLabel:null,responsibleSensitiveTypes:null,responsiblePolicy:null};_Ewa.NR=function(){};_Ewa.NR.prototype={id:null,name:null,description:null,matches:null};_Ewa.NO=function(){};_Ewa.NO.prototype={sensitivityLabel:null,responsiblePolicy:null,sensitiveItems:null};_Ewa.pt=function(){_Ewa.pt.initializeBase(this);var n;this.H_=(n=new _Ewa.gz,n.T_=_Ewa.pt.a(),n.B_=_Ewa.pt.getBaseTypes(),n)};_Ewa.pt.a=function(){return"AugLoop_Automatic_Clp_LabellingAnnotation"};_Ewa.pt.prototype={recommended:null,automatic:null};_Ewa.uW.registerClass("_Ewa.uW",_Ewa.dt);_Ewa.uX.registerClass("_Ewa.uX",_Ewa.oQ.$$(_Ewa.hS));_Ewa.PolicyManagerWrapper.registerClass("_Ewa.PolicyManagerWrapper",_Ewa.cE,_Ewa.tE,Common.IRootUser,_Ewa.hS);_Ewa.Jp.registerClass("_Ewa.Jp",null,_Ewa.iW);_Ewa.uZ.registerClass("_Ewa.uZ",_Ewa.Y);_Ewa.NS.registerClass("_Ewa.NS",_Ewa.ps);_Ewa.NT.registerClass("_Ewa.NT");_Ewa.NM.registerClass("_Ewa.NM");_Ewa.NO.registerClass("_Ewa.NO");_Ewa.pt.registerClass("_Ewa.pt",_Ewa.ps);Type.registerNamespace("_Ewa");_Ewa.WQ=function(){};_Ewa.WQ.a=function(){_Ewa.h.a(function(n){_Ewa.uX.a(n);n.a(521)&&_Ewa.uZ.a(n)})};_Ewa.WQ.a();