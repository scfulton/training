var excelOnlineCalc=function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=12)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(2);r.utils=n;var o=t(3);r.ULS=o.ULS,r.TraceLevel=o.TraceLevel,r.LogCategory=o.LogCategory,r.NulLogger=o.NulLogger,r.ConsoleLogger=o.ConsoleLogger;var a=t(4);r.browserSupport=a;var i=t(5);r.perfWatch=i;var u=t(6);r.initEwaUtils=u.initEwaUtils,r.ewaUtils=u.ewaUtils;var c=t(7);r.initStopwatchFactory=c.initStopwatchFactory;var s=t(8);r.getNewGuid=s.getNewGuid},function(e,r,t){"use strict";t.r(r),t.d(r,"__extends",(function(){return o})),t.d(r,"__assign",(function(){return a})),t.d(r,"__rest",(function(){return i})),t.d(r,"__decorate",(function(){return u})),t.d(r,"__param",(function(){return c})),t.d(r,"__metadata",(function(){return s})),t.d(r,"__awaiter",(function(){return l})),t.d(r,"__generator",(function(){return f})),t.d(r,"__exportStar",(function(){return d})),t.d(r,"__values",(function(){return h})),t.d(r,"__read",(function(){return v})),t.d(r,"__spread",(function(){return p})),t.d(r,"__spreadArrays",(function(){return g})),t.d(r,"__await",(function(){return m})),t.d(r,"__asyncGenerator",(function(){return E})),t.d(r,"__asyncDelegator",(function(){return S})),t.d(r,"__asyncValues",(function(){return T})),t.d(r,"__makeTemplateObject",(function(){return C})),t.d(r,"__importStar",(function(){return R})),t.d(r,"__importDefault",(function(){return I}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function o(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var a=function(){return(a=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function i(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t}function u(e,r,t,n){var o,a=arguments.length,i=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(r,t,i):o(r,t))||i);return a>3&&i&&Object.defineProperty(r,t,i),i}function c(e,r){return function(t,n){r(t,n,e)}}function s(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function l(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t((function(r){r(e.value)})).then(i,u)}c((n=n.apply(e,r||[])).next())}))}function f(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function d(e,r){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}function h(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}function v(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,a=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i}function p(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(v(arguments[r]));return e}function g(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var a=arguments[r],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function E(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=t.apply(e,r||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(r){return new Promise((function(t,n){a.push([e,r,t,n])>1||u(e,r)}))})}function u(e,r){try{(t=o[e](r)).value instanceof m?Promise.resolve(t.value.v).then(c,s):l(a[0][2],t)}catch(e){l(a[0][3],e)}var t}function c(e){u("next",e)}function s(e){u("throw",e)}function l(e,r){e(r),a.shift(),a.length&&u(a[0][0],a[0][1])}}function S(e){var r,t;return r={},n("next"),n("throw",(function(e){throw e})),n("return"),r[Symbol.iterator]=function(){return this},r;function n(n,o){r[n]=e[n]?function(r){return(t=!t)?{value:m(e[n](r)),done:"return"===n}:o?o(r):r}:o}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=h(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&function(r){return new Promise((function(n,o){(function(e,r,t,n){Promise.resolve(n).then((function(r){e({value:r,done:t})}),r)})(n,o,(r=e[t](r)).done,r.value)}))}}}function C(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}function R(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function I(e){return e&&e.__esModule?e:{default:e}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,t){return e.reduce((function(e,n){return e.then((function(){return t&&t.stop?Promise.resolve(void 0):r(n,t)}))}),Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,t){void 0===t&&(t=0);if(t<0||t>n)return r;if(null==r||"object"!=typeof r)return r;var o={};Object.getOwnPropertyNames(r).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])}));var a=Object.getPrototypeOf(r);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])}));var i={};Object.keys(o).forEach((function(r){i[r]=e(o[r],t+1)}));return i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var n=5;var o="_",a=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(a,o).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===o&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===o&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var t=Promise.reject(void 0),n=function(r){t=t.catch((function(t){return e(r,t)}))},o=1;o<=r;o+=1)n(o);return t},r.chainFallbackPromises=function(e,r){if(!e||0===e.length)return Promise.resolve();for(var t=r(e[0]),n=function(n){var o=e[n];t=t.catch((function(){return r(o)}))},o=1;o<e.length;o+=1)n(o);return t},r.getQueryParameterByName=function(e,r){var t=new RegExp("[?&]"+r+"(=([^&#]*)|&|#|$)").exec(e);if(t)return t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""},r.calcHashCode=function(e){if(!e)return 0;for(var r=5381,t=r,n=e.length,o=0;o<n&&(r=4294967295&((r<<5)+r^e.charCodeAt(o)),o!==n-1);o+=2)t=4294967295&((t<<5)+t^e.charCodeAt(o+1));var a=r+35685*t+(23896*t<<16)&4294967295;return a<0&&(a+=4294967296),a},r.getCharIndexInTextFromPoint=function(e,r){var t=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(t=o.offset,n=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,r))&&(t=o.startOffset,n=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer)}else try{var o;n=document.elementFromPoint(e,r),(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",o),t=a.text.length}catch(e){return t}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(t+=n.textContent.length);return t},r.getBoundingRectForText=function(e,r,t){function n(e,r,t){if(!e||!e.textContent)return r;if(r<0||r>e.textContent.length)return r-e.textContent.length;if(!e.hasChildNodes())return t(e,r),r-e.textContent.length;for(var o=e.childNodes,a=0;a<o.length&&r>=0;a+=1)r=n(o[a],r,t);return r}var o=document.createRange();return n(e,r,(function(e,r){return o.setStart(e,r)})),n(e,t,(function(e,r){return o.setEnd(e,r)})),o.getBoundingClientRect()}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,t,n){return r.traceTag(0,e,t,n)},traceTag:function(e,t,n,o){return r.traceTag(e,t,n,o)},debugTrace:function(e,t,n){return r.debugTraceTag(0,e,t,n)},debugTraceTag:function(e,t,n,o){return r.debugTraceTag(e,t,n,o)},assert:function(e,t,n){return r.assertTag(0,e,t,n)},assertTag:function(e,t,n,o){return r.assertTag(e,t,n,o)},shipAssert:function(e,t,n){return r.shipAssertTag(0,e,t,n)},shipAssertTag:function(e,t,n,o){return r.shipAssertTag(e,t,n,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,t,n){console.assert(t,"shipAssertTag:",e,r,n)},e.prototype.assertTag=function(e,r,t,n){console.assert(t,"assertTag",e,r,n)},e.prototype.traceTag=function(e,r,t,n){console.log("traceTag",e,n,r,t)},e.prototype.debugTraceTag=function(e,r,t,n){console.log("debugTraceTag",e,n,r,t)},e}();r.ConsoleLogger=n;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={},o="promises";r.promises=function(){return void 0===n[o]&&(n[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n[o]}},function(e,r,t){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,r,t){e[r]=n()-t}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=n(),t=e,a=r,i={},u=function(e,r,n){return function(e,r,t,n,a,i){o(e,"end",t);var u={sessionName:r,result:n?"success":"failure",message:i,marks:e},c=JSON.stringify(u);a(c)}(i,t,a,e,r,n)};return i.start=0,{mark:function(e){return function(e){return o(i,e,a)}(e)},end:function(e){return u(!0,e)},success:function(e,r){return u(!0,e,r)},failure:function(e,r){return u(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,t){void 0!==e&&e.success(r,t)},r.failure=function(e,r,t){void 0!==e&&e.failure(r,t)},r.timeStamp=n},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return n},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(t){var o=n(),a=t;return{reset:function(e){null!=e&&(a=e),o=n()},stop:function(){var t=n()-o,i=JSON.stringify({Target:a,Duration:t.toFixed(r)});e(i)}}}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getNewGuid=function(){var e=new Uint8Array(31),r=function(e){var r={crypto:!1,perfNow:!1,exceptions:[]},t=window.crypto||window.msCrypto;if(t){r.crypto=!0;try{return t.getRandomValues(e),r}catch(e){r.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,o=window.performance;try{o&&o.now&&o.now()!==1/0&&(n=!0)}catch(e){r.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(n){r.perfNow=!0;var i=Math.floor(100*o.now())%10;(i<0||i>9)&&(i=0);for(var u=0;u<i;u+=1)Math.random()}}catch(e){r.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return r}(e),t=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var n=15&e[t];return t+=1,("x"===r?n:3&n|8).toString(16)})),r]}},function(e,r,t){"use strict";t.r(r),function(e,n){t.d(r,"testEmitter",(function(){return o})),t.d(r,"allWorkersDestroyed",(function(){return u}));var o=void 0,a=0,i=void 0;function u(){return 0===a?Promise.resolve():new Promise((function(e){return i.addListener("noworkers",e)}))}function c(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var s=void 0!==e&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,l=void 0!==n&&n.global===n;if(s||l){var f,d;try{f=require}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{d=f("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}var h=f("events");if(o=new h.EventEmitter,i=new h.EventEmitter,n.Worker=function(){function e(e){var r=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=r._onmessage&&r._onmessage.call(r,c(e))},this._errorHandler=function(e){null!=r._onerror&&r._onerror.call(r,function(e,r){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:r}):{type:"error",message:e,error:r,preventDefault:function(){}}}(e.message,e))},this._worker=new d.Worker(e),this._worker.on("exit",(function(e){o.emit("workerdestroyed",r),0==(a-=1)&&i.emit("noworkers")})),a+=1,o.emit("workercreated",this)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!d.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var v=function(){function r(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(r){null!=e._onmessage&&e._onmessage.call(e,c(r))}}return Object.defineProperty(r.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?d.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&d.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),r.prototype.postMessage=function(e,r){d.parentPort.postMessage(e)},r.prototype.close=function(){e.exit()},r}();n.DedicatedWorkerGlobalScope=v,n.self=new v,n.importScripts=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=f("vm"),n=f("fs");e.forEach((function(e){var r=n.readFileSync(e,"utf-8");t.runInThisContext(r)}))}}}}}.call(this,t(10),t(11))},function(e,r){var t,n,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&h())}function h(){if(!l){var e=u(d);l=!0;for(var r=s.length;r;){for(c=s,s=[];++f<r;)c&&c[f].run();f=-1,r=s.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function v(e,r){this.fun=e,this.array=r}function p(){}o.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];s.push(new v(e,r)),1!==s.length||l||u(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r,t){"use strict";t.r(r);var n={};t.r(n),t.d(n,"createParseGlobals",(function(){return Dn})),t.d(n,"ReasonKind",(function(){return _n})),t.d(n,"notImplemented",(function(){return Ln})),t.d(n,"notFormulaString",(function(){return Mn})),t.d(n,"createParser",(function(){return _u})),t.d(n,"parseResultHelper",(function(){return xu}));var o={};t.r(o),t.d(o,"createAnalyzeGlobals",(function(){return qu})),t.d(o,"createAnalyzer",(function(){return ks}));var a={};t.r(a),t.d(a,"fastMathpack",(function(){return Bs})),t.d(a,"createCompiler",(function(){return hf})),t.d(a,"createEvaluator",(function(){return ov})),t.d(a,"createFormulaInspector",(function(){return hv})),t.d(a,"ReasonKind",(function(){return El})),t.d(a,"CellKind",(function(){return gl})),t.d(a,"Interrupt",(function(){return ml})),t.d(a,"notImplemented",(function(){return vl})),t.d(a,"finalValue",(function(){return Cl})),t.d(a,"pendingValue",(function(){return Rl})),t.d(a,"cellFormula",(function(){return Il})),t.d(a,"unavailable",(function(){return pl})),t.d(a,"unevaluated",(function(){return Al})),t.d(a,"stopped",(function(){return yl})),t.d(a,"nameCycle",(function(){return Ol})),t.d(a,"cellCycle",(function(){return kl})),t.d(a,"paused",(function(){return _l})),t.d(a,"previousFailure",(function(){return Ll})),t.d(a,"javaScriptError",(function(){return Dl})),t.d(a,"evalGlobals",(function(){return Nl})),t.d(a,"getEvalFailureReason",(function(){return Ml})),t.d(a,"illFormedFormula",(function(){return Tl})),t.d(a,"createCompileGlobals",(function(){return Sl})),t.d(a,"extractResultValue",(function(){return Kl})),t.d(a,"evalToCellValue",(function(){return jl})),t.d(a,"getBasicFirstOrderFunc",(function(){return yp})),t.d(a,"extension",(function(){return Cp}));var i={};t.r(i),t.d(i,"WorkerKind",(function(){return wg})),t.d(i,"ErrorKind",(function(){return Ug})),t.d(i,"isWorkerSupported",(function(){return Rm})),t.d(i,"createWorker",(function(){return ym})),t.d(i,"tryCreateWorker",(function(){return Am})),t.d(i,"dedicatedWorkerInsideInit",(function(){return Om})),t.d(i,"runSmokeTest",(function(){return wm})),t.d(i,"cancelSmokeTest",(function(){return Fm})),t.d(i,"smokeTestInsideDef",(function(){return km}));var u={};t.r(u),t.d(u,"getBasicFirstOrderFunc",(function(){return yp})),t.d(u,"makeGetFirstOrderFunc",(function(){return Ap}));var c={};t.r(c),t.d(c,"recalcMapper",(function(){return eg})),t.d(c,"mapperContext",(function(){return rg})),t.d(c,"formulaCacheGlobals",(function(){return fg})),t.d(c,"formulaCache",(function(){return dg})),t.d(c,"createFormatInfo",(function(){return lg})),t.d(c,"worksheetFunctionName",(function(){return gg})),t.d(c,"localeData",(function(){return Eg})),t.d(c,"numberFormat",(function(){return Sg})),t.d(c,"sheetName",(function(){return Tg})),t.d(c,"blankValue",(function(){return Cg})),t.d(c,"errorValue",(function(){return Rg})),t.d(c,"richValue",(function(){return Ig})),t.d(c,"cellLocation",(function(){return yg})),t.d(c,"rangeLocation",(function(){return Ag})),t.d(c,"sheetRangeLocation",(function(){return Ng})),t.d(c,"cellData",(function(){return Og})),t.d(c,"rangeUpdate",(function(){return kg})),t.d(c,"rangeWrite",(function(){return Lg})),t.d(c,"rangePromote",(function(){return Dg})),t.d(c,"arrayData",(function(){return _g})),t.d(c,"arrayUpdate",(function(){return Mg})),t.d(c,"arrayWrite",(function(){return Fg})),t.d(c,"arrayPromote",(function(){return bg})),t.d(c,"rangeFormulaEdit",(function(){return xg})),t.d(c,"arrayFormulaEdit",(function(){return Bg})),t.d(c,"inferredFormat",(function(){return Vg})),t.d(c,"cellDataDelta",(function(){return Wg})),t.d(c,"rangeDelta",(function(){return Hg})),t.d(c,"arrayDelta",(function(){return Kg})),t.d(c,"rangeFailure",(function(){return jg})),t.d(c,"recalcResults",(function(){return Jg})),t.d(c,"updateRequest",(function(){return qg})),t.d(c,"createRecalcService",(function(){return kT})),t.d(c,"RecalcServiceCreateMode",(function(){return AT})),t.d(c,"recalcServiceInsideDef",(function(){return OT}));var s={};t.r(s),t.d(s,"Workbook",(function(){return XT})),t.d(s,"DataCell",(function(){return LT})),t.d(s,"FormulaCell",(function(){return _T})),t.d(s,"FailedCell",(function(){return MT})),t.d(s,"emptyCell",(function(){return DT})),t.d(s,"Worksheet",(function(){return bT}));var l=t(0);function f(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function d(e,r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.apply(void 0,[e].concat(t))}}function h(e){return e}function v(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=p(e[t],t));return r}function p(e,r){if("string"==typeof r&&null!=E[r])return e;var t=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var t=e.kind;if("string"==typeof t)return t}return r}(e),n=S[t];return null!=n?n(e,r):"object"==typeof e?v(e):"<unexpected>"}function g(e){try{var r=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(r=e.kind)||"Array"===r||"App"===r||"Paren"===r||"Name"===r||"CellRef"===r||"Bad"===r||"Operator"===r))return"FormulaNode"}var r}(e);if(void 0!==r){var t=T[r](e);return void 0!==t?t:JSON.stringify(p(e,void 0))}return JSON.stringify(p(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var m,E={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},S={boolean:h,symbol:h,undefined:h,null:h,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:v,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(p):"<unexpected>"}},T={},C={ULS:new l.NulLogger};function R(e){C.ULS=e}function I(e,r){var t=e+": code should be unreachable because a value has type 'never'; given "+g(r);return C.ULS.assertTag(595980872,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}function y(e){return C.ULS.assertTag(595980873,l.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!f(r)||r<0)&&y(e+": expected natural number; given "+g(r))}function N(e,r){(!f(r)||r<=0)&&y(e+": expected positive integer; given "+g(r))}function O(e,r,t){(!f(r)||r<0||r>=t)&&y(e+": expected natural number less than "+g(t)+"; given "+g(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(m||(m={}));var k=L(void 0,"");function L(e,r){return{path:e,name:r}}function D(e,r,t){return{document:e,index:r,length:t}}function _(e,r,t){return A("calc.lang.sheetRange",r),N("calc.lang.sheetRange",t),D(e,r,t)}function M(e,r){return A("calc.lang.sheetIndex",r),D(e,r,1)}function F(e,r,t,n){return{row:e,col:r,rows:t,cols:n}}function b(e,r,t,n){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),N("calc.lang.gridRange",t),N("calc.lang.gridRange",n),F(e,r,t,n)}function w(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),F(e,r,1,1)}function U(e,r){return{sheet:e,range:r}}var P,G,x,B,V,W,H=U,K=U,j=U;function J(e){return{document:e,index:void 0}}function q(e,r){return{scope:e,name:r}}function Y(e,r,t,n,o,a){(A("calc.lang.functionType",e),0===t.length&&r.length<e)&&y("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:t,returnType:n,staticPrecs:o,flags:a}}function X(e,r,t,n){return{cells:e,names:r,special:t,isExact:n}}function Q(e){return{kind:P.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(P||(P={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(G||(G={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(B||(B={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=9]="FIELD"}(V||(V={})),function(e){e[e.First=1]="First",e[e.Last=9]="Last"}(W||(W={}));var z=Q(V.NULL),Z=Q(V.DIV0),$=Q(V.VALUE),ee=Q(V.REF),re=Q(V.NAME),te=Q(V.NUM),ne=Q(V.NA),oe=Q(V.GETTING_DATA),ae=Q(V.FIELD);function ie(e,r,t){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),t.length!==e?y("calc.lang.arrayOper: Inconsistent row number"):{kind:P.Array,rows:e,cols:r,opers:t}}function ue(e,r){return N("calc.lang.rangeSeqOper",r.length),{kind:P.Range,sheets:e,ranges:r}}function ce(e,r){return{kind:P.Range,sheets:e,ranges:[r]}}var se,le,fe,de,he,ve,pe={kind:P.Missing},ge={kind:P.Blank};function me(e){return void 0===e&&(e=0),{kind:le.Error,isQuoted:!1,label:e}}function Ee(e){return void 0===e&&(e=0),{kind:le.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(se||(se={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(le||(le={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(fe||(fe={})),function(e){e.Abs="Abs",e.Rel="Rel"}(de||(de={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(he||(he={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(ve||(ve={}));var Se=me(),Te=Ee();function Ce(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.Document,isQuoted:t,label:n,document:e,path:r}}function Re(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.Sheet,isQuoted:t,label:n,sheet:e,document:r}}function Ie(e,r,t){return void 0===r&&(r=!1),void 0===t&&(t=0),{kind:le.Ident,isQuoted:r,label:t,name:e}}function ye(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.SheetRange,isQuoted:t,label:n,sheet1:e,sheet2:r}}function Ae(e,r){return{kind:e,index:r}}function Ne(e){return void 0===e&&(e=0),{kind:fe.Error,label:e}}var Oe,ke=Ne();function Le(e,r,t){return void 0===t&&(t=0),{kind:fe.Single,label:t,row:e,col:r}}function De(e,r,t){return void 0===t&&(t=0),{kind:fe.Range,label:t,ref1:e,ref2:r}}function _e(e,r,t){return void 0===t&&(t=0),{kind:fe.Row,label:t,row1:e,row2:r}}function Me(e,r,t){return void 0===t&&(t=0),{kind:fe.Col,label:t,col1:e,col2:r}}function Fe(e,r){return{node:e,spans:r}}function be(e,r,t,n){var o,a;return A("calc.lang.formulaSpan",e),o="calc.lang.formulaSpan",f(a=r)||y(o+": expected integer; given "+g(a)),r<e&&y("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:t,post:n}}function we(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Literal,label:t,oper:e,isClosed:r}}function Ue(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Array,label:t,nodes:e,isClosed:r}}function Pe(e,r,t,n){return void 0===t&&(t=!0),void 0===n&&(n=0),{kind:he.App,label:n,head:e,args:r,isClosed:t}}function Ge(e,r){return void 0===r&&(r=0),{kind:he.Operator,label:r,id:e}}function xe(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Paren,label:t,node:e,isClosed:r}}function Be(e,r,t){return void 0===t&&(t=0),{kind:he.Name,label:t,whole:e,qualifier:r}}function Ve(e,r,t){return void 0===t&&(t=0),{kind:he.CellRef,label:t,ref:e,qualifier:r}}function We(e,r,t){return void 0===t&&(t=0),{kind:he.Bad,label:t,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.RECORDTEST=614]="RECORDTEST",e[e.GRF=615]="GRF",e[e.UNIT=616]="UNIT",e[e.RICHERROR=617]="RICHERROR",e[e.FILTER=618]="FILTER",e[e.FUN=619]="FUN",e[e.LET=620]="LET",e[e.ARRAYMAKE=621]="ARRAYMAKE",e[e.APPLY=622]="APPLY",e[e.ISFUN=623]="ISFUN",e[e.ARITY=624]="ARITY",e[e.RECURSE=625]="RECURSE",e[e.FIELDVALUE=626]="FIELDVALUE"}(Oe||(Oe={}));var He=[];He[Oe.COUNT]=Y(1,[],[57],1,0,0),He[Oe.IF]=Y(1,[36,575,575],[],567,0,0),He[Oe.ISNA]=Y(1,[15],[],4,0,0),He[Oe.ISERROR]=Y(1,[15],[],4,0,0),He[Oe.SUM]=Y(1,[],[49],1,0,0),He[Oe.AVERAGE]=Y(1,[],[49],1,0,0),He[Oe.MIN]=Y(1,[],[49],1,0,0),He[Oe.MAX]=Y(1,[],[49],1,0,0),He[Oe.ROW]=Y(0,[16],[],33,0,0),He[Oe.COLUMN]=Y(0,[16],[],33,0,0),He[Oe.NA]=Y(0,[],[],3,0,0),He[Oe.NPV]=Y(2,[1],[49],1,0,0),He[Oe.STDEV]=Y(1,[],[49],1,0,0),He[Oe.DOLLAR]=Y(1,[1,1],[],2,0,0),He[Oe.FIXED]=Y(1,[1,65,4],[],2,0,0),He[Oe.SIN]=Y(1,[1],[],1,0,0),He[Oe.COS]=Y(1,[1],[],1,0,0),He[Oe.TAN]=Y(1,[1],[],1,0,0),He[Oe.ATAN]=Y(1,[1],[],1,0,0),He[Oe.PI]=Y(0,[],[],1,0,0),He[Oe.SQRT]=Y(1,[1],[],1,0,0),He[Oe.EXP]=Y(1,[1],[],1,0,0),He[Oe.LN]=Y(1,[1],[],1,0,0),He[Oe.LOG10]=Y(1,[1],[],1,0,0),He[Oe.ABS]=Y(1,[1],[],1,0,0),He[Oe.INT]=Y(1,[1],[],1,0,0),He[Oe.SIGN]=Y(1,[1],[],1,0,0),He[Oe.ROUND]=Y(2,[1,1],[],1,0,0),He[Oe.LOOKUP]=Y(2,[7,48,48],[],7,0,0),He[Oe.INDEX]=Y(2,[48,1,1,1],[],55,0,0),He[Oe.REPT]=Y(2,[2,1],[],2,0,0),He[Oe.MID]=Y(3,[2,1,1],[],2,0,0),He[Oe.LEN]=Y(1,[2],[],1,0,0),He[Oe.VALUE]=Y(1,[7],[],1,0,0),He[Oe.TRUE]=Y(0,[],[],4,0,0),He[Oe.FALSE]=Y(0,[],[],4,0,0),He[Oe.AND]=Y(1,[],[52],4,0,0),He[Oe.OR]=Y(1,[],[52],4,0,0),He[Oe.NOT]=Y(1,[4],[],4,0,0),He[Oe.MOD]=Y(2,[1,1],[],1,0,0),He[Oe.DCOUNT]=Y(3,[16,83,18],[],1,0,0),He[Oe.DSUM]=Y(3,[16,19,18],[],1,0,0),He[Oe.DAVERAGE]=Y(3,[16,19,18],[],1,0,0),He[Oe.DMIN]=Y(3,[16,19,18],[],1,0,0),He[Oe.DMAX]=Y(3,[16,19,18],[],1,0,0),He[Oe.DSTDEV]=Y(3,[16,19,18],[],1,0,0),He[Oe.VAR]=Y(1,[],[49],1,0,0),He[Oe.DVAR]=Y(3,[16,19,18],[],1,0,0),He[Oe.TEXT]=Y(2,[7,2],[],2,0,0),He[Oe.LINEST]=Y(1,[48,112,84,84],[],32,0,0),He[Oe.TREND]=Y(1,[48,112,112,84],[],32,0,0),He[Oe.LOGEST]=Y(1,[48,112,84,84],[],32,0,0),He[Oe.GROWTH]=Y(1,[48,112,112,84],[],32,0,0),He[Oe.GOTO]=Y(1,[16],[],512,0,2),He[Oe.HALT]=Y(0,[4],[],512,0,2),He[Oe.RETURN]=Y(0,[575],[],512,0,2),He[Oe.PV]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.FV]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.NPER]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.PMT]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.RATE]=Y(3,[1,1,1,1,1,1],[],1,0,0),He[Oe.MIRR]=Y(3,[48,1,1],[],1,0,0),He[Oe.IRR]=Y(1,[48,1],[],1,0,0),He[Oe.RAND]=Y(0,[],[],1,4095,0),He[Oe.MATCH]=Y(2,[7,49,17],[],1,0,0),He[Oe.DATE]=Y(3,[1,1,1],[],1,0,0),He[Oe.TIME]=Y(3,[1,1,1],[],1,0,0),He[Oe.DAY]=Y(1,[1],[],1,0,0),He[Oe.MONTH]=Y(1,[1],[],1,0,0),He[Oe.YEAR]=Y(1,[1],[],1,0,0),He[Oe.WEEKDAY]=Y(1,[1,1],[],1,0,0),He[Oe.HOUR]=Y(1,[1],[],1,0,0),He[Oe.MINUTE]=Y(1,[1],[],1,0,0),He[Oe.SECOND]=Y(1,[1],[],1,0,0),He[Oe.NOW]=Y(0,[],[],1,4095,0),He[Oe.AREAS]=Y(1,[16],[],1,0,0),He[Oe.ROWS]=Y(1,[48],[],1,0,0),He[Oe.COLUMNS]=Y(1,[48],[],1,0,0),He[Oe.OFFSET]=Y(3,[16,65,65,65,65],[],16,4095,0),He[Oe.ABSREF]=Y(2,[2,16],[],16,0,2),He[Oe.RELREF]=Y(2,[16,16],[],2,0,2),He[Oe.ARGUMENT]=Y(0,[66,81,16],[],4,0,2),He[Oe.SEARCH]=Y(2,[2,2,1],[],1,0,0),He[Oe.TRANSPOSE]=Y(1,[39],[],32,0,0),He[Oe.ERROR]=Y(0,[1,24],[],4,0,2),He[Oe.STEP]=Y(0,[],[],4,0,2),He[Oe.TYPE]=Y(1,[47],[],1,0,0),He[Oe.ECHO]=Y(0,[4],[],4,0,2),He[Oe.SET_NAME]=Y(1,[2,63],[],4,0,2),He[Oe.CALLER]=Y(0,[],[],50,0,2),He[Oe.DEREF]=Y(1,[16],[],47,0,2),He[Oe.WINDOWS]=Y(0,[65,66],[],32,0,2),He[Oe.SERIES]=Y(4,[87,117,117,1,117],[],4,0,0),He[Oe.DOCUMENTS]=Y(0,[1,66],[],32,0,2),He[Oe.ACTIVE_CELL]=Y(0,[],[],16,0,2),He[Oe.SELECTION]=Y(0,[],[],16,0,2),He[Oe.RESULT]=Y(0,[1],[],4,0,2),He[Oe.ATAN2]=Y(2,[1,1],[],1,0,0),He[Oe.ASIN]=Y(1,[1],[],1,0,0),He[Oe.ACOS]=Y(1,[1],[],1,0,0),He[Oe.CHOOSE]=Y(2,[33],[575],567,0,0),He[Oe.HLOOKUP]=Y(3,[7,49,49,4],[],39,0,0),He[Oe.VLOOKUP]=Y(3,[7,49,49,4],[],39,0,0),He[Oe.LINKS]=Y(0,[66,65],[],32,0,2),He[Oe.INPUT]=Y(1,[2,65,66,67,65,65,2],[],575,0,2),He[Oe.ISREF]=Y(1,[63],[],4,0,0),He[Oe.GET_FORMULA]=Y(1,[18],[],2,0,2),He[Oe.GET_NAME]=Y(1,[2,4],[],6,0,2),He[Oe.SET_VALUE]=Y(2,[16,47],[],4,0,2),He[Oe.LOG]=Y(1,[1,1],[],1,0,0),He[Oe.EXEC]=Y(1,[2,1,4,4],[],7,0,2),He[Oe.CHAR]=Y(1,[1],[],2,0,0),He[Oe.LOWER]=Y(1,[2],[],2,0,0),He[Oe.UPPER]=Y(1,[2],[],2,0,0),He[Oe.PROPER]=Y(1,[2],[],2,0,0),He[Oe.LEFT]=Y(1,[2,9],[],2,0,0),He[Oe.RIGHT]=Y(1,[2,9],[],2,0,0),He[Oe.EXACT]=Y(2,[2,2],[],4,0,0),He[Oe.TRIM]=Y(1,[2],[],2,0,0),He[Oe.REPLACE]=Y(4,[2,1,1,2],[],2,0,0),He[Oe.SUBSTITUTE]=Y(3,[2,2,2,2],[],2,0,0),He[Oe.CODE]=Y(1,[2],[],1,0,0),He[Oe.NAMES]=Y(0,[66,65,66],[],32,0,2),He[Oe.DIRECTORY]=Y(0,[2],[],2,0,2),He[Oe.FIND]=Y(2,[2,2,1],[],1,0,0),He[Oe.CELL]=Y(1,[2,16],[],47,4095,0),He[Oe.ISERR]=Y(1,[15],[],4,0,0),He[Oe.ISTEXT]=Y(1,[143],[],4,0,0),He[Oe.ISNUMBER]=Y(1,[143],[],4,0,0),He[Oe.ISBLANK]=Y(1,[143],[],4,0,0),He[Oe.T]=Y(1,[23],[],2,0,0),He[Oe.N]=Y(1,[23],[],1,0,0),He[Oe.FOPEN]=Y(1,[2,1],[],1,0,2),He[Oe.FCLOSE]=Y(1,[1],[],1,0,2),He[Oe.FSIZE]=Y(1,[1],[],1,0,2),He[Oe.FREADLN]=Y(1,[1],[],2,0,2),He[Oe.FREAD]=Y(2,[1,1],[],2,0,2),He[Oe.FWRITELN]=Y(2,[1,2],[],1,0,2),He[Oe.FWRITE]=Y(2,[1,2],[],1,0,2),He[Oe.FPOS]=Y(1,[1,1],[],1,0,2),He[Oe.DATEVALUE]=Y(1,[3],[],1,0,0),He[Oe.TIMEVALUE]=Y(1,[3],[],1,0,0),He[Oe.SLN]=Y(3,[1,1,1],[],1,0,0),He[Oe.SYD]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.DDB]=Y(4,[1,1,1,1,1],[],1,0,0),He[Oe.GET_DEF]=Y(1,[2,66,65],[],2,0,2),He[Oe.REFTEXT]=Y(1,[16,4],[],2,0,2),He[Oe.TEXTREF]=Y(1,[2,4],[],16,0,2),He[Oe.INDIRECT]=Y(1,[2,4],[],16,4095,0),He[Oe.REGISTER]=Y(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),He[Oe.CALL]=Y(1,[3],[127],575,0,2),He[Oe.ADD_BAR]=Y(0,[3],[],1,0,2),He[Oe.ADD_MENU]=Y(2,[3,115,83,3],[],1,0,2),He[Oe.ADD_COMMAND]=Y(3,[3,83,115,83,3],[],1,0,2),He[Oe.ENABLE_COMMAND]=Y(4,[3,3,3,4,3],[],4,0,2),He[Oe.CHECK_COMMAND]=Y(4,[3,3,3,4,3],[],4,0,2),He[Oe.RENAME_COMMAND]=Y(4,[3,3,3,3,3],[],4,0,2),He[Oe.SHOW_BAR]=Y(0,[3],[],4,0,2),He[Oe.DELETE_MENU]=Y(2,[3,3,3],[],4,0,2),He[Oe.DELETE_COMMAND]=Y(3,[3,3,3,3],[],4,0,2),He[Oe.GET_CHART_ITEM]=Y(1,[1,67,66],[],1,0,2),He[Oe.DIALOG_BOX]=Y(1,[52],[],36,0,2),He[Oe.CLEAN]=Y(1,[2],[],2,0,0),He[Oe.MDETERM]=Y(1,[32],[],1,0,0),He[Oe.MINVERSE]=Y(1,[32],[],32,0,0),He[Oe.MMULT]=Y(2,[32,32],[],32,0,0),He[Oe.FILES]=Y(0,[2,2],[],32,0,2),He[Oe.IPMT]=Y(4,[1,1,1,1,1,1],[],1,0,0),He[Oe.PPMT]=Y(4,[1,1,1,1,1,1],[],1,0,0),He[Oe.COUNTA]=Y(1,[],[121],1,0,0),He[Oe.CANCEL_KEY]=Y(0,[1,16],[],4,0,2),He[Oe.FOR]=Y(3,[2,1,1,1],[],512,0,2),He[Oe.WHILE]=Y(1,[4],[],512,0,2),He[Oe.BREAK]=Y(0,[],[],512,0,2),He[Oe.NEXT]=Y(0,[],[],512,0,2),He[Oe.INITIATE]=Y(2,[2,2],[],1,0,2),He[Oe.REQUEST]=Y(2,[1,2],[],32,0,2),He[Oe.POKE]=Y(3,[1,18,18],[],4,0,2),He[Oe.EXECUTE]=Y(2,[1,2],[],4,0,2),He[Oe.TERMINATE]=Y(1,[1],[],4,0,2),He[Oe.RESTART]=Y(0,[1],[],512,0,2),He[Oe.HELP]=Y(0,[2],[],4,0,2),He[Oe.GET_BAR]=Y(0,[3,3,3,3],[],3,0,2),He[Oe.PRODUCT]=Y(1,[],[113],1,0,0),He[Oe.FACT]=Y(1,[1],[],1,0,0),He[Oe.GET_CELL]=Y(1,[1,16],[],47,0,2),He[Oe.GET_WORKSPACE]=Y(1,[1],[],47,0,2),He[Oe.GET_WINDOW]=Y(1,[1,2],[],47,0,2),He[Oe.GET_DOCUMENT]=Y(1,[1,2],[],63,0,2),He[Oe.DPRODUCT]=Y(3,[16,19,18],[],1,0,0),He[Oe.ISNONTEXT]=Y(1,[143],[],4,0,0),He[Oe.GET_NOTE]=Y(0,[82,65,65],[],2,0,2),He[Oe.NOTE]=Y(0,[66,82,17,17],[],1,0,2),He[Oe.STDEVP]=Y(1,[],[49],1,0,0),He[Oe.VARP]=Y(1,[],[49],1,0,0),He[Oe.DSTDEVP]=Y(3,[16,19,18],[],1,0,0),He[Oe.DVARP]=Y(3,[16,19,18],[],1,0,0),He[Oe.TRUNC]=Y(1,[1,1],[],1,0,0),He[Oe.ISLOGICAL]=Y(1,[143],[],4,0,0),He[Oe.DCOUNTA]=Y(3,[16,83,18],[],1,0,0),He[Oe.DELETE_BAR]=Y(1,[3],[],4,0,2),He[Oe.UNREGISTER]=Y(1,[3],[],4,0,2),He[Oe.USDOLLAR]=Y(1,[1,1],[],2,0,0),He[Oe.FINDB]=Y(2,[2,2,1],[],1,0,0),He[Oe.SEARCHB]=Y(2,[2,2,1],[],1,0,0),He[Oe.REPLACEB]=Y(4,[2,1,1,2],[],2,0,0),He[Oe.LEFTB]=Y(1,[2,9],[],2,0,0),He[Oe.RIGHTB]=Y(1,[2,9],[],2,0,0),He[Oe.MIDB]=Y(3,[2,1,1],[],2,0,0),He[Oe.LENB]=Y(1,[2],[],1,0,0),He[Oe.ROUNDUP]=Y(2,[1,1],[],1,0,0),He[Oe.ROUNDDOWN]=Y(2,[1,1],[],1,0,0),He[Oe.ASC]=Y(1,[2],[],2,0,0),He[Oe.DBCS]=Y(1,[2],[],2,0,0),He[Oe.RANK]=Y(2,[1,16,4],[],1,0,0),He[Oe.ADDRESS]=Y(2,[1,65,65,68,66],[],2,0,0),He[Oe.DAYS360]=Y(2,[1,1,4],[],1,0,0),He[Oe.TODAY]=Y(0,[],[],1,4095,0),He[Oe.VDB]=Y(5,[1,1,1,1,1,1,4],[],1,0,0),He[Oe.ELSE]=Y(0,[],[],512,0,2),He[Oe.ELSE_IF]=Y(1,[12],[],512,0,2),He[Oe.END_IF]=Y(0,[],[],512,0,2),He[Oe.FOR_CELL]=Y(1,[2,82,84],[],512,0,2),He[Oe.MEDIAN]=Y(1,[],[49],1,0,0),He[Oe.SUMPRODUCT]=Y(1,[],[32],1,0,0),He[Oe.SINH]=Y(1,[1],[],1,0,0),He[Oe.COSH]=Y(1,[1],[],1,0,0),He[Oe.TANH]=Y(1,[1],[],1,0,0),He[Oe.ASINH]=Y(1,[1],[],1,0,0),He[Oe.ACOSH]=Y(1,[1],[],1,0,0),He[Oe.ATANH]=Y(1,[1],[],1,0,0),He[Oe.DGET]=Y(3,[16,19,18],[],7,0,0),He[Oe.CREATE_OBJECT]=Y(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),He[Oe.VOLATILE]=Y(0,[4],[],4,0,2),He[Oe.LAST_ERROR]=Y(0,[],[],16,0,2),He[Oe.CUSTOM_UNDO]=Y(0,[2,2],[],4,0,2),He[Oe.CUSTOM_REPEAT]=Y(0,[2,2,2],[],4,0,2),He[Oe.FORMULA_CONVERT]=Y(2,[2,23,23,23,23],[],2,0,2),He[Oe.GET_LINK_INFO]=Y(2,[2,1,1,2],[],1,0,2),He[Oe.TEXT_BOX]=Y(1,[2,66,65,65],[],1,0,2),He[Oe.INFO]=Y(1,[2],[],3,4095,0),He[Oe.GROUP]=Y(0,[],[],2,0,2),He[Oe.GET_OBJECT]=Y(1,[1,2,1,1,1],[],47,0,2),He[Oe.DB]=Y(4,[1,1,1,1,1],[],1,0,0),He[Oe.PAUSE]=Y(0,[4],[],512,0,2),He[Oe.ERROR_CODE]=Y(0,[],[],2,0,2),He[Oe.ALLOC_COUNT]=Y(0,[],[],1,0,2),He[Oe.RESUME]=Y(0,[1],[],512,0,2),He[Oe.FREQUENCY]=Y(2,[48,48],[],32,0,0),He[Oe.ADD_TOOLBAR]=Y(0,[66,96],[],2,0,2),He[Oe.DELETE_TOOLBAR]=Y(1,[2],[],4,0,2),He[Oe._UDF]=Y(1,[17],[127],575,0,0),He[Oe.RESET_TOOLBAR]=Y(1,[3],[],4,0,2),He[Oe.EVALUATE]=Y(1,[2],[],63,0,2),He[Oe.GET_TOOLBAR]=Y(1,[1,3],[],47,0,2),He[Oe.GET_TOOL]=Y(1,[1,3,1],[],47,0,2),He[Oe.SPELLING_CHECK]=Y(1,[2,66,4],[],4,0,2),He[Oe.ERROR_TYPE]=Y(1,[15],[],1,0,0),He[Oe.APP_TITLE]=Y(0,[2],[],4,0,2),He[Oe.WINDOW_TITLE]=Y(0,[2],[],4,0,2),He[Oe.SAVE_TOOLBAR]=Y(0,[99,66],[],4,0,2),He[Oe.ENABLE_TOOL]=Y(3,[3,1,4],[],4,0,2),He[Oe.PRESS_TOOL]=Y(3,[3,1,4],[],4,0,2),He[Oe.REGISTER_ID]=Y(2,[2,3,66],[],1,0,2),He[Oe.GET_PROJECT]=Y(1,[1,2],[],35,0,2),He[Oe.AVEDEV]=Y(1,[],[49],1,0,0),He[Oe.BETADIST]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.GAMMALN]=Y(1,[1],[],1,0,0),He[Oe.BETAINV]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.BINOMDIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.CHIDIST]=Y(2,[1,1],[],1,0,0),He[Oe.CHIINV]=Y(2,[1,1],[],1,0,0),He[Oe.COMBIN]=Y(2,[1,1],[],1,0,0),He[Oe.CONFIDENCE]=Y(3,[1,1,1],[],1,0,0),He[Oe.CRITBINOM]=Y(3,[1,1,1],[],1,0,0),He[Oe.EVEN]=Y(1,[1],[],1,0,0),He[Oe.EXPONDIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.FDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.FINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.FISHER]=Y(1,[1],[],1,0,0),He[Oe.FISHERINV]=Y(1,[1],[],1,0,0),He[Oe.FLOOR]=Y(2,[1,1],[],1,0,0),He[Oe.GAMMADIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.GAMMAINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.CEILING]=Y(2,[1,1],[],1,0,0),He[Oe.HYPGEOMDIST]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.LOGNORMDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.LOGINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NEGBINOMDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.NORMDIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORMSDIST]=Y(1,[1],[],1,0,0),He[Oe.NORMINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NORMSINV]=Y(1,[1],[],1,0,0),He[Oe.STANDARDIZE]=Y(3,[1,1,1],[],1,0,0),He[Oe.ODD]=Y(1,[1],[],1,0,0),He[Oe.PERMUT]=Y(2,[1,1],[],1,0,0),He[Oe.POISSON]=Y(3,[1,1,4],[],1,0,0),He[Oe.TDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.WEIBULL]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.SUMXMY2]=Y(2,[32,32],[],1,0,0),He[Oe.SUMX2MY2]=Y(2,[32,32],[],1,0,0),He[Oe.SUMX2PY2]=Y(2,[32,32],[],1,0,0),He[Oe.CHITEST]=Y(2,[32,32],[],1,0,0),He[Oe.CORREL]=Y(2,[32,32],[],1,0,0),He[Oe.COVAR]=Y(2,[32,32],[],1,0,0),He[Oe.FORECAST]=Y(3,[1,32,32],[],1,0,0),He[Oe.FTEST]=Y(2,[32,32],[],1,0,0),He[Oe.INTERCEPT]=Y(2,[32,32],[],1,0,0),He[Oe.PEARSON]=Y(2,[32,32],[],1,0,0),He[Oe.RSQ]=Y(2,[32,32],[],1,0,0),He[Oe.STEYX]=Y(2,[32,32],[],1,0,0),He[Oe.SLOPE]=Y(2,[32,32],[],1,0,0),He[Oe.TTEST]=Y(4,[32,32,1,1],[],1,0,0),He[Oe.PROB]=Y(3,[32,32,1,65],[],1,0,0),He[Oe.DEVSQ]=Y(1,[],[49],1,0,0),He[Oe.GEOMEAN]=Y(1,[],[49],1,0,0),He[Oe.HARMEAN]=Y(1,[],[49],1,0,0),He[Oe.SUMSQ]=Y(1,[],[49],1,0,0),He[Oe.KURT]=Y(1,[],[49],1,0,0),He[Oe.SKEW]=Y(1,[],[49],1,0,0),He[Oe.ZTEST]=Y(2,[49,1,1],[],1,0,0),He[Oe.LARGE]=Y(2,[49,1],[],1,0,0),He[Oe.SMALL]=Y(2,[49,1],[],1,0,0),He[Oe.QUARTILE]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTILE]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTRANK]=Y(2,[49,1,65],[],1,0,0),He[Oe.MODE]=Y(1,[],[32],1,0,0),He[Oe.TRIMMEAN]=Y(2,[49,1],[],1,0,0),He[Oe.TINV]=Y(2,[1,1],[],1,0,0),He[Oe.MOVIE_COMMAND]=Y(3,[2,1,1,1],[],1,0,2),He[Oe.GET_MOVIE]=Y(2,[2,1,1],[],1,0,2),He[Oe.CONCATENATE]=Y(1,[],[2],2,0,0),He[Oe.POWER]=Y(2,[1,1],[],1,0,0),He[Oe.SPREADBASE_DATA_FIELD]=Y(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),He[Oe.GET_VIEW]=Y(1,[1,2],[],35,0,2),He[Oe.GET_FIELD]=Y(1,[1,66,2],[],35,0,2),He[Oe.GET_ITEM]=Y(1,[1,66,66,2],[],7,0,2),He[Oe.RADIANS]=Y(1,[1],[],1,0,0),He[Oe.DEGREES]=Y(1,[1],[],1,0,0),He[Oe.SUBTOTAL]=Y(2,[1],[16],1,0,0),He[Oe.SUMIF]=Y(2,[16,15,16],[],1,0,0),He[Oe.COUNTIF]=Y(2,[16,15],[],1,0,0),He[Oe.COUNTBLANK]=Y(1,[16],[],1,0,0),He[Oe.SCENARIO_GET]=Y(1,[1,2],[],19,0,2),He[Oe.OPTIONS_LISTS]=Y(1,[33],[],33,0,2),He[Oe.ISPMT]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.DATEDIF]=Y(3,[1,1,2],[],1,0,0),He[Oe.DATESTRING]=Y(1,[1],[],2,0,0),He[Oe.NUMBERSTRING]=Y(2,[1,1],[],2,0,0),He[Oe.ROMAN]=Y(1,[1,5],[],2,0,0),He[Oe.OPENDIALOG]=Y(0,[66,66,66,65],[],6,0,2),He[Oe.SAVEDIALOG]=Y(0,[66,66,66,66,65],[],6,0,2),He[Oe.VIEW_GET]=Y(1,[1,2],[],19,0,2),He[Oe.GETPIVOTDATA]=Y(2,[18,18],[2,79],15,0,0),He[Oe.HYPERLINK]=Y(1,[2,39],[],39,0,0),He[Oe.FURIGANA]=Y(1,[16],[],2,0,0),He[Oe.AVERAGEA]=Y(1,[],[49],1,0,0),He[Oe.MAXA]=Y(1,[],[49],1,0,0),He[Oe.MINA]=Y(1,[],[49],1,0,0),He[Oe.STDEVPA]=Y(1,[],[49],1,0,0),He[Oe.VARPA]=Y(1,[],[49],1,0,0),He[Oe.STDEVA]=Y(1,[],[49],1,0,0),He[Oe.VARA]=Y(1,[],[49],1,0,0),He[Oe.BAHTTEXT]=Y(1,[1],[],2,0,0),He[Oe.THAIDOW]=Y(1,[1],[],2,0,0),He[Oe.THAIDIGIT]=Y(1,[3],[],2,0,0),He[Oe.THAIMOY]=Y(1,[1],[],2,0,0),He[Oe.THAINUMSOUND]=Y(1,[1],[],2,0,0),He[Oe.THAINUMSTRING]=Y(1,[1],[],2,0,0),He[Oe.THAISTRINGLENGTH]=Y(1,[2],[],1,0,0),He[Oe.ISTHAIDIGIT]=Y(1,[2],[],4,0,0),He[Oe.ROUNDBAHTDOWN]=Y(1,[1],[],1,0,0),He[Oe.ROUNDBAHTUP]=Y(1,[1],[],1,0,0),He[Oe.THAIYEAR]=Y(1,[1],[],1,0,0),He[Oe.RTD]=Y(3,[],[2],2,0,0),He[Oe.CUBEVALUE]=Y(1,[2],[50],15,0,0),He[Oe.CUBEMEMBER]=Y(2,[2,50,2],[],10,0,0),He[Oe.CUBEMEMBERPROPERTY]=Y(3,[2,2,2],[],15,0,0),He[Oe.CUBERANKEDMEMBER]=Y(3,[2,2,1,2],[],10,0,0),He[Oe.HEX2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.HEX2DEC]=Y(1,[95],[],9,0,0),He[Oe.HEX2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2DEC]=Y(1,[95],[],9,0,0),He[Oe.BIN2DEC]=Y(1,[95],[],9,0,0),He[Oe.BIN2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.BIN2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.IMSUB]=Y(2,[95,95],[],9,0,0),He[Oe.IMDIV]=Y(2,[95,95],[],9,0,0),He[Oe.IMPOWER]=Y(2,[95,95],[],9,0,0),He[Oe.IMABS]=Y(1,[95],[],9,0,0),He[Oe.IMSQRT]=Y(1,[95],[],9,0,0),He[Oe.IMLN]=Y(1,[95],[],9,0,0),He[Oe.IMLOG2]=Y(1,[95],[],9,0,0),He[Oe.IMLOG10]=Y(1,[95],[],9,0,0),He[Oe.IMSIN]=Y(1,[95],[],9,0,0),He[Oe.IMCOS]=Y(1,[95],[],9,0,0),He[Oe.IMEXP]=Y(1,[95],[],9,0,0),He[Oe.IMARGUMENT]=Y(1,[95],[],9,0,0),He[Oe.IMCONJUGATE]=Y(1,[95],[],9,0,0),He[Oe.IMAGINARY]=Y(1,[95],[],9,0,0),He[Oe.IMREAL]=Y(1,[95],[],9,0,0),He[Oe.COMPLEX]=Y(2,[95,95,95],[],9,0,0),He[Oe.IMSUM]=Y(1,[],[127],9,0,0),He[Oe.IMPRODUCT]=Y(1,[],[127],9,0,0),He[Oe.SERIESSUM]=Y(4,[95,95,95,127],[],9,0,0),He[Oe.FACTDOUBLE]=Y(1,[95],[],9,0,0),He[Oe.SQRTPI]=Y(1,[95],[],9,0,0),He[Oe.QUOTIENT]=Y(2,[95,95],[],9,0,0),He[Oe.DELTA]=Y(1,[95,95],[],9,0,0),He[Oe.GESTEP]=Y(1,[95,95],[],9,0,0),He[Oe.ISEVEN]=Y(1,[95],[],9,0,0),He[Oe.ISODD]=Y(1,[95],[],9,0,0),He[Oe.MROUND]=Y(2,[95,95],[],9,0,0),He[Oe.ERF]=Y(1,[95,95],[],9,0,0),He[Oe.ERFC]=Y(1,[95],[],9,0,0),He[Oe.BESSELJ]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELK]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELY]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELI]=Y(2,[95,95],[],9,0,0),He[Oe.XIRR]=Y(2,[127,127,95],[],9,0,0),He[Oe.XNPV]=Y(3,[95,127,127],[],9,0,0),He[Oe.PRICEMAT]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.YIELDMAT]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.INTRATE]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.RECEIVED]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.DISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.PRICEDISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.YIELDDISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.TBILLEQ]=Y(3,[95,95,95],[],9,0,0),He[Oe.TBILLPRICE]=Y(3,[95,95,95],[],9,0,0),He[Oe.TBILLYIELD]=Y(3,[95,95,95],[],9,0,0),He[Oe.PRICE]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.YIELD]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.DOLLARDE]=Y(2,[95,95],[],9,0,0),He[Oe.DOLLARFR]=Y(2,[95,95],[],9,0,0),He[Oe.NOMINAL]=Y(2,[95,95],[],9,0,0),He[Oe.EFFECT]=Y(2,[95,95],[],9,0,0),He[Oe.CUMPRINC]=Y(6,[95,95,95,95,95,95],[],9,0,0),He[Oe.CUMIPMT]=Y(6,[95,95,95,95,95,95],[],9,0,0),He[Oe.EDATE]=Y(2,[95,95],[],9,0,0),He[Oe.EOMONTH]=Y(2,[95,95],[],9,0,0),He[Oe.YEARFRAC]=Y(2,[95,95,95],[],9,0,0),He[Oe.COUPDAYBS]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPDAYS]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPDAYSNC]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPNCD]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPNUM]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPPCD]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.DURATION]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.MDURATION]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.ODDLPRICE]=Y(7,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDLYIELD]=Y(7,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDFPRICE]=Y(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDFYIELD]=Y(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.RANDBETWEEN]=Y(2,[95,95],[],9,4095,0),He[Oe.WEEKNUM]=Y(1,[95,95],[],9,0,0),He[Oe.AMORDEGRC]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.AMORLINC]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.CONVERT]=Y(3,[95,95,95],[],9,0,0),He[Oe.ACCRINT]=Y(6,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ACCRINTM]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.WORKDAY]=Y(2,[95,95,127],[],9,0,0),He[Oe.NETWORKDAYS]=Y(2,[95,95,127],[],9,0,0),He[Oe.GCD]=Y(1,[],[127],9,0,0),He[Oe.MULTINOMIAL]=Y(1,[],[127],9,0,0),He[Oe.LCM]=Y(1,[],[127],9,0,0),He[Oe.FVSCHEDULE]=Y(2,[95,127],[],9,0,0),He[Oe.CUBEKPIMEMBER]=Y(3,[2,2,1,2],[],10,0,0),He[Oe.CUBESET]=Y(2,[2,50,2,1,2],[],10,0,0),He[Oe.CUBESETCOUNT]=Y(1,[2],[],9,0,0),He[Oe.IFERROR]=Y(2,[47,575],[],47,0,0),He[Oe.COUNTIFS]=Y(2,[],[16,15],1,0,0),He[Oe.SUMIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.AVERAGEIF]=Y(2,[16,15,16],[],1,0,0),He[Oe.AVERAGEIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.AGGREGATE]=Y(3,[1,1,48,17],[16],1,0,0),He[Oe.BINOM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.BINOM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.CONFIDENCE_NORM]=Y(3,[1,1,1],[],1,0,0),He[Oe.CONFIDENCE_T]=Y(3,[1,1,1],[],1,0,0),He[Oe.CHISQ_TEST]=Y(2,[32,32],[],1,0,0),He[Oe.F_TEST]=Y(2,[32,32],[],1,0,0),He[Oe.COVARIANCE_P]=Y(2,[32,32],[],1,0,0),He[Oe.COVARIANCE_S]=Y(2,[32,32],[],1,0,0),He[Oe.EXPON_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.GAMMA_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.GAMMA_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.MODE_MULT]=Y(1,[],[32],32,0,0),He[Oe.MODE_SNGL]=Y(1,[],[32],1,0,0),He[Oe.NORM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.PERCENTILE_EXC]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTILE_INC]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTRANK_EXC]=Y(2,[49,1,65],[],1,0,0),He[Oe.PERCENTRANK_INC]=Y(2,[49,1,65],[],1,0,0),He[Oe.POISSON_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.QUARTILE_EXC]=Y(2,[49,1],[],1,0,0),He[Oe.QUARTILE_INC]=Y(2,[49,1],[],1,0,0),He[Oe.RANK_AVG]=Y(2,[1,16,4],[],1,0,0),He[Oe.RANK_EQ]=Y(2,[1,16,4],[],1,0,0),He[Oe.STDEV_S]=Y(1,[],[49],1,0,0),He[Oe.STDEV_P]=Y(1,[],[49],1,0,0),He[Oe.T_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.T_DIST_2T]=Y(2,[1,1],[],1,0,0),He[Oe.T_DIST_RT]=Y(2,[1,1],[],1,0,0),He[Oe.T_INV]=Y(2,[1,1],[],1,0,0),He[Oe.T_INV_2T]=Y(2,[1,1],[],1,0,0),He[Oe.VAR_S]=Y(1,[],[49],1,0,0),He[Oe.VAR_P]=Y(1,[],[49],1,0,0),He[Oe.WEIBULL_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NETWORKDAYS_INTL]=Y(2,[95,95,75,127],[],9,0,0),He[Oe.WORKDAY_INTL]=Y(2,[95,95,75,127],[],9,0,0),He[Oe.ECMA_CEILING]=Y(2,[1,1],[],1,0,0),He[Oe.ISO_CEILING]=Y(1,[1,65],[],1,0,0),He[Oe.DEBUG]=Y(1,[2],[1151],1087,0,0),He[Oe.BETA_DIST]=Y(4,[1,1,1,4,65,65],[],1,0,0),He[Oe.BETA_INV]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.CHISQ_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.CHISQ_DIST_RT]=Y(2,[1,1],[],1,0,0),He[Oe.CHISQ_INV]=Y(2,[1,1],[],1,0,0),He[Oe.CHISQ_INV_RT]=Y(2,[1,1],[],1,0,0),He[Oe.F_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.F_DIST_RT]=Y(3,[1,1,1],[],1,0,0),He[Oe.F_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.F_INV_RT]=Y(3,[1,1,1],[],1,0,0),He[Oe.HYPGEOM_DIST]=Y(5,[1,1,1,1,4],[],1,0,0),He[Oe.LOGNORM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.LOGNORM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NEGBINOM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORM_S_DIST]=Y(2,[1,4],[],1,0,0),He[Oe.NORM_S_INV]=Y(1,[1],[],1,0,0),He[Oe.T_TEST]=Y(4,[32,32,1,1],[],1,0,0),He[Oe.Z_TEST]=Y(2,[49,1,1],[],1,0,0),He[Oe.ERF_PRECISE]=Y(1,[95],[],9,0,0),He[Oe.ERFC_PRECISE]=Y(1,[95],[],9,0,0),He[Oe.GAMMALN_PRECISE]=Y(1,[1],[],1,0,0),He[Oe.CEILING_PRECISE]=Y(1,[1,65],[],1,0,0),He[Oe.FLOOR_PRECISE]=Y(1,[1,65],[],1,0,0),He[Oe.ACOT]=Y(1,[1],[],1,0,0),He[Oe.ACOTH]=Y(1,[1],[],1,0,0),He[Oe.COT]=Y(1,[1],[],1,0,0),He[Oe.COTH]=Y(1,[1],[],1,0,0),He[Oe.CSC]=Y(1,[1],[],1,0,0),He[Oe.CSCH]=Y(1,[1],[],1,0,0),He[Oe.SEC]=Y(1,[1],[],1,0,0),He[Oe.SECH]=Y(1,[1],[],1,0,0),He[Oe.IMTAN]=Y(1,[95],[],9,0,0),He[Oe.IMCOT]=Y(1,[95],[],9,0,0),He[Oe.IMCSC]=Y(1,[95],[],9,0,0),He[Oe.IMCSCH]=Y(1,[95],[],9,0,0),He[Oe.IMSEC]=Y(1,[95],[],9,0,0),He[Oe.IMSECH]=Y(1,[95],[],9,0,0),He[Oe.BITAND]=Y(2,[1,1],[],1,0,0),He[Oe.BITOR]=Y(2,[1,1],[],1,0,0),He[Oe.BITXOR]=Y(2,[1,1],[],1,0,0),He[Oe.BITLSHIFT]=Y(2,[1,1],[],1,0,0),He[Oe.BITRSHIFT]=Y(2,[1,1],[],1,0,0),He[Oe.PERMUTATIONA]=Y(2,[1,1],[],1,0,0),He[Oe.COMBINA]=Y(2,[1,1],[],1,0,0),He[Oe.XOR]=Y(1,[],[52],4,0,0),He[Oe.PDURATION]=Y(3,[1,1,1],[],1,0,0),He[Oe.BASE]=Y(2,[1,1,65],[],2,0,0),He[Oe.DECIMAL]=Y(2,[2,1],[],1,0,0),He[Oe.DAYS]=Y(2,[3,3],[],1,0,0),He[Oe.BINOM_DIST_RANGE]=Y(3,[1,1,1,65],[],1,0,0),He[Oe.GAMMA]=Y(1,[1],[],1,0,0),He[Oe.SKEW_P]=Y(1,[],[49],1,0,0),He[Oe.GAUSS]=Y(1,[1],[],1,0,0),He[Oe.PHI]=Y(1,[1],[],1,0,0),He[Oe.RRI]=Y(3,[1,1,1],[],1,0,0),He[Oe.UNICHAR]=Y(1,[1],[],2,0,0),He[Oe.UNICODE]=Y(1,[2],[],1,0,0),He[Oe.MUNIT]=Y(1,[1],[],32,0,0),He[Oe.ARABIC]=Y(1,[2],[],1,0,0),He[Oe.ISOWEEKNUM]=Y(1,[1],[],1,0,0),He[Oe.NUMBERVALUE]=Y(1,[2,66,66],[],1,0,0),He[Oe.SHEET]=Y(0,[50],[],1,4095,0),He[Oe.SHEETS]=Y(0,[48],[],1,4095,0),He[Oe.FORMULATEXT]=Y(1,[16],[],2,4095,0),He[Oe.ISFORMULA]=Y(1,[16],[],4,0,0),He[Oe.IFNA]=Y(2,[47,575],[],47,0,0),He[Oe.CEILING_MATH]=Y(1,[1,65,65],[],1,0,0),He[Oe.FLOOR_MATH]=Y(1,[1,65,65],[],1,0,0),He[Oe.IMSINH]=Y(1,[95],[],9,0,0),He[Oe.IMCOSH]=Y(1,[95],[],9,0,0),He[Oe.FILTERXML]=Y(2,[2,2],[],47,0,0),He[Oe.WEBSERVICE]=Y(1,[2],[],10,0,0),He[Oe.ENCODEURL]=Y(1,[2],[],10,0,0),He[Oe.FORECAST_ETS]=Y(3,[1,48,48,65,65,65],[],1,0,0),He[Oe.FORECAST_ETS_CONFINT]=Y(3,[1,48,48,65,65,65,65],[],1,0,0),He[Oe.FORECAST_ETS_SEASONALITY]=Y(2,[48,48,65,65],[],1,0,0),He[Oe.FORECAST_LINEAR]=Y(3,[1,32,32],[],1,0,0),He[Oe.FORECAST_ETS_STAT]=Y(3,[48,48,1,65,65,65],[],1,0,0),He[Oe.MAXIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.MINIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.TEXTJOIN]=Y(3,[114,68],[114],2,0,0),He[Oe.CONCAT]=Y(1,[],[114],2,0,0),He[Oe.IFS]=Y(2,[],[44,575],575,0,0),He[Oe.SWITCH]=Y(3,[47,575],[575,575],575,0,0),He[Oe.SINGLE]=Y(1,[1079,4],[],1055,0,1),He[Oe.AVERAGE_WEIGHTED]=Y(2,[],[113,113],1,0,1),He[Oe.ANCHORARRAY]=Y(1,[16],[],48,0,1),He[Oe.IMAGE]=Y(1,[2],[],2,0,1),He[Oe.RECORD]=Y(2,[],[2,303],256,0,1),He[Oe.RECORDTEST]=Y(3,[15],[2,47],256,0,1),He[Oe.GRF]=Y(1,[15,2],[],15,0,1),He[Oe.UNIT]=Y(2,[15,2],[],15,0,1),He[Oe.RICHERROR]=Y(1,[1],[],10,0,1),He[Oe.FILTER]=Y(2,[48,48],[],32,0,1),He[Oe.FUN]=Y(1,[],[63],63,0,1),He[Oe.LET]=Y(3,[63,63,63],[],63,0,1),He[Oe.ARRAYMAKE]=Y(3,[1,1,63],[],32,0,1),He[Oe.APPLY]=Y(1,[],[63],63,0,1),He[Oe.ISFUN]=Y(1,[63],[],4,0,1),He[Oe.ARITY]=Y(1,[63],[],9,0,1),He[Oe.RECURSE]=Y(0,[],[],63,0,1),He[Oe.FIELDVALUE]=Y(2,[263,2],[],295,0,1);var Ke,je=Y(0,[],[G.All],G.All,x.All,B.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot"}(Ke||(Ke={}));var Je=P.Number|P.String|P.Boolean,qe=P.Number|P.String|P.Boolean|P.Blank,Ye=Y(2,[P.Number,P.Number],[],P.Number,x.None,B.None),Xe=Y(1,[P.Number],[],P.Number,x.None,B.None),Qe=Y(1,[Je],[],Je,x.None,B.None),ze=Y(2,[P.String,P.String],[],P.String,x.None,B.None),Ze=Y(2,[qe,qe],[],P.Boolean,x.None,B.None),$e=Y(2,[P.Range,P.Range],[],P.Range,x.AllCells,B.None),er=Y(2,[P.Range,P.Range],[],P.Range,x.None,B.None),rr=Y(2,[P.Boolean,P.Boolean],[],P.Boolean,x.None,B.None),tr=[];function nr(e){var r=tr[e];return null!=r?r:je}function or(e){var r=He[e];return null!=r?r:je}function ar(e,r){var t=He[e];null!=t&&(t.staticPrecs=r)}function ir(e,r){return{wrap:e,unwrap:r}}function ur(e){return e}function cr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function sr(e){var r=cr();for(var t in e)r[t]=e[t];return r}function lr(e){return null!=e}function fr(e){return null==e}function dr(e,r){return lr(e)?e:r}function hr(e,r){return[e,r]}function vr(e,r){return e<r?e:r}function pr(e,r){return e<r?r:e}function gr(e){return e<0?-e:e}function mr(e,r){return e===r?0:e.toLocaleUpperCase().localeCompare(r.toLocaleUpperCase())}function Er(e,r){return 0===mr(e,r)}tr[Ke.Add]=Ye,tr[Ke.Sub]=Ye,tr[Ke.Mul]=Ye,tr[Ke.Div]=Ye,tr[Ke.Pow]=Ye,tr[Ke.Percent]=Xe,tr[Ke.Neg]=Xe,tr[Ke.Pos]=Qe,tr[Ke.Concat]=ze,tr[Ke.Eq]=Ze,tr[Ke.Ne]=Ze,tr[Ke.Lt]=Ze,tr[Ke.Le]=Ze,tr[Ke.Gt]=Ze,tr[Ke.Ge]=Ze,tr[Ke.Range]=$e,tr[Ke.Isect]=er,tr[Ke.Union]=er,tr[Ke.And]=rr,tr[Ke.Or]=rr,tr[Ke.Xor]=rr,tr[Ke.Min]=Ye,tr[Ke.Max]=Ye,ar(Oe.ROW,x.OwnRow),ar(Oe.COLUMN,x.OwnCol),ar(Oe.SHEET,x.OwnDocSheets),ar(Oe.SHEETS,x.OwnDocSheets),ar(Oe.OFFSET,x.AllCells),ar(Oe.INDIRECT,x.AllCells),ar(Oe.SUMIF,x.AllCells),ar(Oe.NOW,x.Time),ar(Oe.TODAY,x.Time),ar(Oe.RAND,x.Calc),ar(Oe.RANDBETWEEN,x.Calc),ar(Oe.SUBTOTAL,x.CellProps),ar(Oe.CELL,x.CellProps|x.AllCells),ar(Oe.INFO,x.Calc),ar(Oe.FORMULATEXT,x.None);var Sr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Tr(e){return 1===e.length}function Cr(e){return e.isWellFormed}function Rr(e){return 1===e.rows&&1===e.cols}function Ir(e){return Tr(e.sheet)}function yr(e){return Rr(e.range)}function Ar(e,r){if(Rr(e))return r(e,0,0);for(var t=e.row,n=e.rows,o=e.col,a=e.cols,i=0;i<n;i+=1)for(var u=0;u<a;u+=1)if(!r(w(t+i,o+u),i,u))return!1;return!0}function Nr(e,r){return e===r||Er(e.name,r.name)&&(null==e.path&&null==r.path||null!=e.path&&null!=r.path&&Er(e.path,r.path))}function Or(e,r){return Nr(e.document,r.document)&&e.index===r.index}function kr(e,r){return e.row===r.row&&e.col===r.col}function Lr(e,r){return Or(e.sheet,r.sheet)&&kr(e.range,r.range)}function Dr(e){return Rr(e)?e:F(e.row,e.col,1,1)}function _r(e){return yr(e)?e:j(e.sheet,Dr(e.range))}function Mr(e,r){var t=e.row,n=e.col,o=r.row,a=r.col;return F(Math.min(t,o),Math.min(n,a),Math.abs(o-t)+1,Math.abs(a-n)+1)}function Fr(e,r){function t(t){var n=e.spans[t.label];return void 0!==n&&n.start<=r&&r<n.end}for(var n=e.node,o=!0;o;)switch(o=!1,n.kind){case he.Array:for(var a=n.nodes,i=a.length-1;!o&&i>=0;i-=1)for(var u=a[i],c=u.length-1;!o&&c>=0;c-=1){t(l=u[c])&&(n=l,o=!0)}break;case he.App:var s=n.args;for(c=s.length-1;!o&&c>=0;c-=1){t(l=s[c])&&(n=l,o=!0)}break;case he.Paren:var l;t(l=n.node)&&(n=l,o=!0);break;case he.Bad:case he.Name:case he.CellRef:case he.Literal:break;default:I("getSubExpressionFromPosition",n)}return n}function br(e,r){var t=-1,n=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(t=o.offset);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,r))&&(t=o.startOffset)}else try{var o;(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",o),t=a.text.length}catch(e){return t}for(;null!=n&&"SPAN"===n.nodeName;)null!=(n=n.previousSibling)&&null!=n.textContent&&(t+=n.textContent.length);return t}var wr,Ur,Pr=[];function Gr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===he.Literal&&Vr(r.oper)===P.Missing)return 0}return e.args.length}(e)?Pr:e.args}function xr(e,r){A("calc.runtime.getArgType",r);var t=e.headTypes,n=t.length;if(r<n)return t[r];var o=e.restTypes,a=o.length;return a>0?o[(r-n)%a]:G.None}function Br(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function Vr(e){switch(typeof e){case"number":return P.Number;case"string":return P.String;case"boolean":return P.Boolean;default:return e.kind}}function Wr(e){return"number"==typeof e&&isFinite(e)}function Hr(e){return{kind:wr.Success,value:e}}function Kr(e){return{kind:wr.Failure,reason:e}}function jr(e){return null!=e&&e.kind===wr.Success}function Jr(e){return{kind:Ur.NotImplemented,features:e}}function qr(e){return 0===e.length&&y("calc.lang.unavailable: expected nonempty array"),{kind:Ur.Unavailable,objects:e}}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(wr||(wr={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Ur||(Ur={}));var Yr=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Xr(e){if(null!=e){var r=e.path,t=e.name;return null!=r&&"string"!=typeof r?(C.ULS.traceTag(595969803,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Illegal document path: type is "+typeof r),k):"string"!=typeof t?(C.ULS.traceTag(595969804,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Illegal document name: type is "+typeof t),k):e}}(Yr.prototype=Object.create(Error.prototype)).constructor=Yr;var Qr=65;function zr(e){for(var r=e+1,t="";r>0;){var n=(r-1)%26;t=String.fromCharCode(Qr+n)+t,r=Math.floor((r-n)/26)}return t}function Zr(e,r,t){var n=t.kind,o=t.index;return n===de.Abs?r+e.formatNumber(o+1):0===o?r:r+e.leftBracket+e.formatNumber(o)+e.rightBracket}function $r(e,r,t,n){if(r===se.A1){if(null==t){return C.ULS.assertTag(595935437,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,r,t){var n=t.kind===de.Abs,o=e.formatNumber(t.index+(n?0:r)+1);return n?"$"+o:o}(e,t,n)}return Zr(e,e.rowLetter,n)}function et(e,r,t,n){if(r===se.A1){if(null==t){return C.ULS.assertTag(595935438,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,r){var t=r.kind===de.Abs,n=zr(r.index+(t?0:e));return t?"$"+n:n}(t,n)}return Zr(e,e.columnLetter,n)}function rt(e){return function(r,t,n,o,a){var i=e(r,t,n,o);return t===se.R1C1&&o.kind===a.kind&&o.index===a.index?i:i+":"+e(r,t,n,a)}}var tt=rt($r),nt=rt(et);function ot(e,r,t,n,o){var a=$r(e,r,null!=t?t.row:void 0,n),i=et(e,r,null!=t?t.col:void 0,o);return r===se.A1?i+a:a+i}var at,it=t(1),ut={ULS:new l.NulLogger},ct=Object(l.initStopwatchFactory)((function(e){return ut.ULS.traceTag(595948114,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,e)}));function st(e,r){return it.__awaiter(this,void 0,void 0,(function(){var t;return it.__generator(this,(function(n){switch(n.label){case 0:t=ct(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r()];case 2:return[2,n.sent()];case 3:return t.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch"}(at||(at={}));var lt=function(e){return!1},ft={};function dt(e){return void 0===ft[e]&&(ft[e]=lt(e)),ft[e]}var ht=100;function vt(e,r,t){return void 0===t&&(t=ht),r.maxDepth=t,r.level=0,pt(e,r)}function pt(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var t;switch(r.level+=1,e.kind){case he.Literal:t=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===P.Missing)return r.visitMissing(e);if(e.kind===P.Error)switch(e.type){case V.NULL:return r.visitNullError(e);case V.DIV0:return r.visitDiv0Error(e);case V.VALUE:return r.visitValueError(e);case V.REF:return r.visitRefError(e);case V.NAME:return r.visitNameError(e);case V.NUM:return r.visitNumError(e);case V.NA:return r.visitNAError(e);case V.GETTING_DATA:return r.visitDataError(e);case V.FIELD:return r.visitFieldError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case he.Array:t=r.visitArray(e);break;case he.App:t=r.visitApp(e);break;case he.Paren:t=r.visitParen(e);break;case he.Name:t=r.visitName(e);break;case he.CellRef:t=r.visitCellRef(e);break;case he.Bad:t=r.visitBad(e);break;case he.Operator:t=r.visitOperator(e);break;case fe.Error:t=r.visitRefError(e);break;case fe.Single:t=r.visitSingle(e);break;case fe.Range:t=r.visitRange(e);break;case fe.Row:t=r.visitRow(e);break;case fe.Col:t=r.visitCol(e);break;case le.Error:t=r.visitNameError(e);break;case le.Relative:t=r.visitRelative(e);break;case le.Document:t=r.visitDocument(e);break;case le.Sheet:t=r.visitSheet(e);break;case le.Ident:t=r.visitIdent(e);break;case le.SheetRange:t=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,t}function gt(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e,visitFieldError:e}}function mt(e,r,t){return{level:0,operVisitor:e,visitArray:dr(t.vArray,r),visitApp:dr(t.vApp,r),visitParen:dr(t.vParen,r),visitName:dr(t.vName,r),visitCellRef:dr(t.vCellRef,r),visitBad:dr(t.vBad,r),visitOperator:dr(t.vOperator,r),visitRefError:dr(t.vRefError,r),visitSingle:dr(t.vSingle,r),visitRange:dr(t.vRange,r),visitRow:dr(t.vRow,r),visitCol:dr(t.vCol,r),visitNameError:dr(t.vNameError,r),visitRelative:dr(t.vRelative,r),visitDocument:dr(t.vDocument,r),visitSheet:dr(t.vSheet,r),visitIdent:dr(t.vIdent,r),visitSheetRange:dr(t.vSheetRange,r)}}var Et,St=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","],Tt={localeInfo:void 0,range:void 0,refStyle:se.A1,source:m.Cell,level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"},visitFieldError:function(e){return"#FIELD"}},visitArray:function(e){var r=[];return e.nodes.forEach((function(e){var t=[];e.forEach((function(e){t.push(pt(e,Tt))})),r.push(t.join(","))})),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach((function(e){r.push(pt(e,Tt))}));var t=pt(e.head,Tt);if(e.head.kind===he.Operator){if(e.head.id===Ke.Percent)return r[0]+"%";if(1===r.length)return t+r[0];if(2===r.length)return r[0]+t+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return t+"("+r.join(",")+")"},visitParen:function(e){return"("+pt(e.node,Tt)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=pt(e.qualifier,this)+"!"),r+pt(e.ref,this)},visitBad:function(e){if(e.type===ve.Sequence){var r=[];return e.contents.forEach((function(e){r.push(pt(e,Tt))})),r.join("")}return e.contents},visitOperator:function(e){return St[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){var r=void 0===this.range?void 0:this.range.range;return ot(this.localeInfo,this.refStyle,r,e.row,e.col)},visitRange:function(e){return pt(e.ref1,Tt)+":"+pt(e.ref2,Tt)},visitRow:function(e){var r=void 0===this.range?void 0:this.range.range.row;return $r(this.localeInfo,this.refStyle,r,e.row1)+":"+$r(this.localeInfo,this.refStyle,r,e.row2)},visitCol:function(e){var r=void 0===this.range?void 0:this.range.range.col;return et(this.localeInfo,this.refStyle,r,e.col1)+":"+et(this.localeInfo,this.refStyle,r,e.col2)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?pt(e.document,Tt):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function Ct(e){return{kind:Et.VisitorFailure,message:e}}function Rt(){return{kind:Et.NoLocaleInfo}}function It(e,r,t,n,o){void 0===n&&(n=se.A1),void 0===o&&(o=m.Cell);try{return void 0===t&&n===se.A1?Kr(Rt()):(Tt.localeInfo=r,Tt.range=t,Tt.refStyle=n,Tt.source=o,Hr("="+vt(e,Tt)))}catch(e){if(C.ULS.traceTag(595964180,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Format failed: "+e),Tt.level=0,"string"==typeof e)return Kr(Ct(e));throw e}}!function(e){e.NoLocaleInfo="NoLocaleInfo",e.VisitorFailure="VisitorFailure"}(Et||(Et={}));var yt,At=K(M(L(void 0,"Book1"),0),b(0,0,1,1));function Nt(e,r){var t=It(r,e,At);if(t.kind===wr.Success){return t.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp("[^[object Object][object Object][object Object]d]","g"),"w")}}function Ot(e,r){return Nt(e,r.node)}function kt(e){return T.FormulaNode=d(e,Nt),T.Formula=d(e,Ot),{localeInfo:e}}var Lt=!1,Dt=void 0;function _t(e,r,t){if(Lt){var n="calc.config.initCalc: Calc is already initialized";C.ULS.traceTag(595910878,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)}else{var o;if(R(e),function(e){ut.ULS=e}(e),"function"==typeof(o=r)&&(lt=o),null!=t&&!/(^https:\/\/)|(^http:\/\/)/.test(t)){n="calc.config.initCalc: calcAbsUrl is not absolute: "+t;C.ULS.traceTag(595910879,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)}Dt=t,Lt=!0}}function Mt(){return Lt}function Ft(){return Dt}function bt(e,r,t,n,o,a,i,u,c,s,l,f,d,h,v,p,g,m,E,S,T,C){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:t,getWorksheetFuncName:n,isNumeral:o,getOrdinal:a,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:s,trueName:l,falseName:f,rowLetter:d,columnLetter:h,leftBrace:v,rightBrace:p,leftBracket:g,rightBracket:m,decimalSeparator:E,listSeparator:S,columnSeparator:T,rowSeparator:C}}function wt(e){return Number(e)}function Ut(e){return String(e)}function Pt(e){return e>="0"&&e<="9"}function Gt(e){return Pt(e)||y("calc.config.getOrdinal: expected numeral; given "+g(e)),e.charCodeAt(0)-"0".charCodeAt(0)}function xt(e){return O("calc.config.getNumeral",e,10),String(e)}function Bt(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}var Vt=[void 0,"#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA","#FIELD"],Wt=((yt={})[Oe.ARRAYMAKE]="ARRAY.MAKE",yt),Ht=void 0;function Kt(){if(null==Ht)for(var e in Ht=[],Oe){var r=Number(e);if(!isNaN(r)){var t=Wt[r],n=null!=t?t:Oe[e].replace("_",".");Ht[r]=n}}return Ht}function jt(e){var r=function(e){var r={};return e.forEach((function(e,t){null!=e&&(r[e.toLocaleUpperCase()]=t)})),r}(e);return{getWorksheetFuncId:function(e){return r[e.toLocaleUpperCase()]},getWorksheetFuncName:function(r){var t=e[r];return null==t?y("calc.config.getWorksheetFuncName: unknown function ID "+r):t}}}function Jt(){var e=jt(Kt());return bt(wt,Ut,e.getWorksheetFuncId,e.getWorksheetFuncName,Pt,Gt,xt,Bt,mr,Vt,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")}var qt,Yt,Xt,Qt,zt,Zt,$t,en,rn,tn,nn,on,an=fe,un=de,cn=le,sn=Ce,ln=w,fn=M,dn=_,hn=H,vn=J,pn=q,gn=Mr,mn=jr,En=Ur,Sn=Jr;function Tn(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case En.NotImplemented:case En.Unavailable:return!0}return!1}function Cn(e,r,t){return function(n,o){return void 0===o?r(n):Tn(o)?t(o,n):e(o)}}function Rn(e,r){return function(t){if(Array.isArray(t)){for(var n=void 0,o=0;o<t.length;o+=1){var a=t[o];if(void 0!==(n=e(a)))return[a,n]}return r}var i=e(t);return void 0===i?r:[t,i]}}function In(e,r){return r.kind===un.Abs?r.index:e+r.index}function yn(e,r){var t=In(e.row,r.row),n=In(e.col,r.col);return ln(t,n)}function An(e,r){switch(r.kind){case an.Error:return;case an.Single:var t=yn(e,r);return ln(t.row,t.col);case an.Range:var n=yn(e,r.ref1),o=yn(e,r.ref2);return gn(n,o);case an.Row:return Sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case an.Col:return Sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function Nn(e){function r(r){var t=e.getDocumentLoc(r.path,r.document);return lr(t)?t:void 0}function t(t,n){var o=lr(n.document)?r(n.document):t;if(!fr(o)){var a=e.getSheetIndex(o,n.sheet);return mn(a)?lr(a.value)?fn(o,a.value):void 0:a.reason}}return{resolveName:function(n,o,a){if(fr(o)||o.kind===cn.Relative)return[pn(n.sheet,a),pn(vn(n.sheet.document),a)];var i=function(n,o){switch(o.kind){case cn.Document:var a=r(o);return lr(a)?vn(a):a;case cn.Sheet:return t(n.sheet.document,o);case cn.Ident:var i=n.sheet.document,u=e.getSheetIndex(i,o.name);if(mn(u)){if(lr(u.value))return fn(i,u.value);var c=r(sn(o.name));return lr(c)?vn(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",o)}}(n,o);return Tn(i)?i:pn(i,a)},resolveGridRef:An,resolveCellRef:function(r,n,o){var a=An(r.range,o);if(Tn(a))return a;var i=fr(n)?r.sheet:function(r,n){switch(n.kind){case cn.Error:return;case cn.Sheet:return t(r.document,n);case cn.SheetRange:var o=r.document,a=e.getSheetIndex(o,n.sheet1);if(!mn(a))return a.reason;var i=e.getSheetIndex(o,n.sheet2);if(!mn(i))return i.reason;var u=a.value,c=i.value;if(fr(u)||fr(c))return;return u===c?fn(o,u):dn(o,Math.min(u,c),Math.abs(c-u)+1);case cn.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",n)}}(r.sheet,n);return Tn(i)?i:hn(i,a)}}}(Yt=qt||(qt={})).FormulaSource=m,Yt.documentLoc=L,Yt.sheetIndex=M,Yt.sheetRange=_,Yt.gridCell=w,Yt.gridRange=b,Yt.sheetGridCell=j,Yt.sheetGridRange=K,Yt.sheetGridCube=H,Yt.documentScope=J,Yt.nameLoc=q,(Qt=Xt||(Xt={})).SpecialPrecs=x,Qt.OperKind=P,Qt.ErrorType=V,Qt.ErrorTypeBounds=W,Qt.precedents=X,Qt.errorOper=Q,Qt.nullErrorOper=z,Qt.div0ErrorOper=Z,Qt.valueErrorOper=$,Qt.refErrorOper=ee,Qt.nameErrorOper=re,Qt.numErrorOper=te,Qt.naErrorOper=ne,Qt.gettingDataErrorOper=oe,Qt.fieldErrorOper=ae,Qt.arrayOper=ie,Qt.rangeSeqOper=ue,Qt.range3DOper=ce,Qt.missingOper=pe,Qt.blankOper=ge,(Zt=zt||(zt={})).RefStyle=se,Zt.QualifierKind=le,Zt.CellRefKind=fe,Zt.PosKind=de,Zt.NodeKind=he,Zt.BadType=ve,Zt.errorQualifierLabeled=me,Zt.relativeQualifierLabeled=Ee,Zt.errorQualifier=Se,Zt.relativeQualifier=Te,Zt.documentQualifier=Ce,Zt.sheetQualifier=Re,Zt.identQualifier=Ie,Zt.sheetRangeQualifier=ye,Zt.pos=Ae,Zt.cellRefErrorLabeled=Ne,Zt.cellRefError=ke,Zt.cellRefSingle=Le,Zt.cellRefRange=De,Zt.cellRefRow=_e,Zt.cellRefCol=Me,Zt.formula=Fe,Zt.formulaSpan=be,Zt.literalNode=we,Zt.arrayNode=Ue,Zt.appNode=Pe,Zt.operatorNode=Ge,Zt.parenNode=xe,Zt.nameNode=Be,Zt.cellRefNode=Ve,Zt.badNode=We,(en=$t||($t={})).SignatureType=G,en.FunctionFlags=B,en.OperatorId=Ke,en.WorksheetFuncId=Oe,en.SpecialPrecs=x,en.functionType=Y,en.unknownFunctionType=je,en.getOperatorType=nr,en.getWorksheetFuncType=or,(tn=rn||(rn={})).isSheetIndex=Tr,tn.isSheetGridRange=Ir,tn.isGridCell=Rr,tn.isSheetGridCell=yr,tn.isDocumentLocEqual=Nr,tn.isSheetIndexEqual=Or,tn.isGridCellEqual=kr,tn.isSheetGridCellEqual=Lr,tn.gridRangeAnchor=Dr,tn.sheetGridRangeAnchor=_r,tn.gridCellRange=Mr,tn.getArguments=Gr,tn.getArgType=xr,tn.isValidArgsLength=Br,tn.operKind=Vr,tn.ResultKind=wr,tn.success=Hr,tn.failure=Kr,tn.FailureError=Yr,tn.isSuccess=jr,tn.ReasonKind=Ur,tn.notImplemented=Jr,tn.unavailable=qr,tn.columnName=zr,tn.formatRow=$r,tn.formatCol=et,tn.formatRowRange=tt,tn.formatColRange=nt,tn.formatCellPos=ot,tn.getSubExpressionFromPosition=Fr,tn.getFormulaCharIndexFromPoint=br,tn.createResolver=Nn,tn.createResolutionHandler=Cn,tn.createNameFinder=Rn,tn.defaultLiteralVisitor=gt,tn.defaultFormulaVisitor=mt,tn.dispatch=pt,tn.startVisit=vt,tn.prettyPrinter=It,tn.visitorFailure=Ct,tn.noLocaleInfo=Rt,(on=nn||(nn={})).localeInfo=bt,on.calcConfig=kt,on.initCalc=_t,on.createSimpleLocaleInfo=Jt,on.isCalcInit=Mt,on.getCalcAbsUrl=Ft;var On,kn=rn.ReasonKind,Ln=rn.notImplemented;function Dn(e){return{config:e}}!function(e){e.BadFormulaString="BadFormulaString"}(On||(On={}));var _n=it.__assign({},kn,On);function Mn(e){return{kind:_n.BadFormulaString,message:e}}var Fn=" \t\n\r";function bn(e){return Fn.indexOf(e)>=0}function wn(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Un(e,r){return"."===r||wn(e,r)||e.isNumeral(r)}function Pn(e,r){var t=r-1;return function(r){if(r<=t){var n=e+": internal error: no progress made at index "+r;return C.ULS.assertTag(595980821,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}t=r}}function Gn(e,r,t){for(var n=r;n<e.length&&t(e[n]);n+=1);return[e.substring(r,n),n]}function xn(e,r,t,n,o){var a=e[r];return t(a)?1:a===n&&o(e[r+1])?2:0}function Bn(e,r,t,n,o){for(var a=[],i=r,u=r;u<e.length;){var c=xn(e,u,t,n,o);if(0===c)break;2===c&&(i!==u&&a.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&a.push(e.substring(i,u)),[a.join(""),u]}var Vn,Wn,Hn,Kn,jn=Xt.nullErrorOper,Jn=Xt.div0ErrorOper,qn=Xt.valueErrorOper,Yn=Xt.refErrorOper,Xn=Xt.nameErrorOper,Qn=Xt.numErrorOper,zn=Xt.naErrorOper,Zn=Xt.gettingDataErrorOper,$n=Xt.fieldErrorOper,eo=$t.OperatorId;function ro(e,r,t){return{kind:e,start:r,chars:t}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(Vn||(Vn={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Wn||(Wn={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Hn||(Hn={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Kn||(Kn={}));var to=function(e){return ro(Vn.End,e,"")},no=function(e,r){return ro(Vn.Spaces,e,r)},oo=function(e,r){return ro(Vn.Unexpected,e,r)},ao=function(e,r){return ro(Vn.Ident,e,r)};function io(e,r,t,n){return{kind:e,start:r,chars:t,value:n}}var uo=function(e){return io(Vn.Left,e,"(",Wn.Paren)},co=function(e,r){return io(Vn.Left,e,r,Wn.Bracket)},so=function(e,r){return io(Vn.Left,e,r,Wn.Brace)},lo=function(e){return io(Vn.Left,e,"'",Wn.SQuote)},fo=function(e){return io(Vn.Right,e,")",Wn.Paren)},ho=function(e,r){return io(Vn.Right,e,r,Wn.Bracket)},vo=function(e,r){return io(Vn.Right,e,r,Wn.Brace)},po=function(e){return io(Vn.Right,e,"'",Wn.SQuote)},go=function(e,r){return io(Vn.Sep,e,r,Hn.List)},mo=function(e,r){return io(Vn.Sep,e,r,Hn.Col)},Eo=function(e,r){return io(Vn.Sep,e,r,Hn.Row)},So=function(e){return io(Vn.Sep,e,"!",Hn.Qual)},To={"#ALL":function(e,r){return io(Vn.SpecialRef,e,r,Kn.All)},"#DATA":function(e,r){return io(Vn.SpecialRef,e,r,Kn.Data)},"#HEADERS":function(e,r){return io(Vn.SpecialRef,e,r,Kn.Headers)},"#TOTALS":function(e,r){return io(Vn.SpecialRef,e,r,Kn.Totals)},"#THIS ROW":function(e,r){return io(Vn.SpecialRef,e,r,Kn.ThisRow)}};function Co(e,r,t,n,o,a,i,u){return{kind:Vn.CellRef,start:e,chars:r,row:t,col:n,refStyle:o,isName:a,isNumber:i,isQualPart:u}}function Ro(e,r,t,n){void 0===n&&(n=!0);var o="number"==typeof t&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:Vn.Literal,start:e,chars:r,oper:t,hasRight:n,isQualPart:o}}var Io=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return Ro(e,r,jn)},function(e,r){return Ro(e,r,Jn)},function(e,r){return Ro(e,r,qn)},function(e,r){return Ro(e,r,Yn)},function(e,r){return Ro(e,r,Xn)},function(e,r){return Ro(e,r,Qn)},function(e,r){return Ro(e,r,zn)},function(e,r){return Ro(e,r,Zn)},function(e,r){return Ro(e,r,$n)}];function yo(e,r,t){return 0===e.stringCompareCI(e.falseName,t)?Ro(r,t,!1):0===e.stringCompareCI(e.trueName,t)?Ro(r,t,!0):ao(r,t)}var Ao=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function No(e){var r=Ao[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(t){return{kind:Vn.Operator,start:t,chars:r,value:e}}}var Oo=No(eo.Add),ko=No(eo.Sub),Lo=No(eo.Mul),Do=No(eo.Div),_o=No(eo.Pow),Mo=No(eo.Percent),Fo=No(eo.Concat),bo=No(eo.Eq),wo=No(eo.Lt),Uo=No(eo.Gt),Po=No(eo.Ne),Go=No(eo.Le),xo=No(eo.Ge),Bo=No(eo.Range);No(eo.And),No(eo.Or),No(eo.Xor),No(eo.Dot);function Vo(e,r,t){return t.push(r),r.start+e}var Wo=zt.PosKind,Ho=zt.pos,Ko=zt.RefStyle;function jo(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function Jo(e){return e.toUpperCase().charCodeAt(0)-65+1}function qo(e,r,t,n){for(var o=0,a=n,i=Math.min(t.length,n+r);a<i;a+=1){var u=t[a];if(!e.isNumeral(u))break;o=10*o+e.getOrdinal(u)}return a===i&&e.isNumeral(t[a])?[0,n]:[o,a]}function Yo(e,r,t){return function(n,o,a,i){var u=function(e,r){return"$"===e[r]?[Wo.Abs,r+1]:[Wo.Rel,r]}(a,i),c=u[0],s=u[1],l=e(n,t,a,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;var h=c===Wo.Rel?f-o:f;return[Ho(c,h-1),!1,d]}return[void 0,!1,i]}}function Xo(e,r,t){return function(n,o,a,i){var u=e?n.rowLetter:n.columnLetter;if(i>=a.length||0!==n.stringCompareCI(u,a[i]))return[void 0,!1,i];var c=i+1,s=qo(n,t,a,c),l=s[0],f=s[1];if(f>c){if(l<1||l>r)return;return[Ho(Wo.Abs,l-1),!1,f]}if(a[c]===n.leftBracket){var d=1;"+"===a[c+=1]?c+=1:"-"===a[c]&&(d=-1,c+=1);var h=qo(n,t,a,c),v=h[0],p=h[1];if(p>c&&v<r&&a[p]===n.rightBracket)return[Ho(Wo.Rel,v*d),!0,p+1]}return[!1,!1,f]}}function Qo(e,r,t,n,o,a,i){var u=n(e,r,a,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],s=u[1],l=u[2];if(l>i){var f=o(e,t,a,l);if(null==f)return s?[c,void 0,!0,l]:[void 0,void 0,!1,i];var d=f[0],h=f[1],v=f[2];return v>l?[c,d,h,v]:[c,void 0,s,l]}var p=o(e,t,a,i);if(null==p)return[void 0,void 0,!1,i];var g=p[0],m=p[1],E=p[2];return E>i?[void 0,g,m,E]:[void 0,void 0,!1,i]}var zo=Yo(qo,1048576,7),Zo=Yo((function(e,r,t,n){return function(e,r,t){for(var n=0,o=t,a=Math.min(r.length,t+e);o<a;o+=1){var i=r[o];if(!jo(i))break;n=26*n+Jo(i)}return o===a&&jo(r[o])?[0,t]:[n,o]}(r,t,n)}),16384,3),$o=Xo(!0,1048576,7),ea=Xo(!1,16384,5);function ra(e,r,t,n,o,a){var i,u,c,s,l,f=function(e,r,t,n,o){if(r===Ko.A1&&null!=t){var a=t.range,i=Qo(e,a.col,a.row,Zo,zo,n,o),u=i[0],c=i[1],s=i[2],l=i[3];if((null!=c&&null!=u||null!=c&&c.kind===Wo.Abs||null!=u&&u.kind===Wo.Abs||(null!=c||null!=u)&&(":"===n[o-1]||":"===n[l]))&&(s||l>=n.length||!Un(e,n[l])))return[Ko.A1,c,u,l]}var f=Qo(e,void 0,void 0,$o,ea,n,o),d=f[0],h=f[1],v=f[2],p=f[3];if((null!=d||null!=h)&&(v||p>=n.length||!Un(e,n[p])))return[Ko.R1C1,d,h,p]}(e,r,t,n,o);if(null!=f){var d=f[0],h=f[1],v=f[2],p=f[3],g=n.substring(p,o);return Vo(p-o,d===Ko.A1?function(e,r,t,n){var o=null==t&&null!=n&&n.kind===zt.PosKind.Rel,a=null==n&&null!=t&&t.kind===zt.PosKind.Rel,i=!(null!=t&&t.kind!==zt.PosKind.Rel||null!=n&&n.kind!==zt.PosKind.Rel);return Co(e,r,t,n,zt.RefStyle.A1,o,a,i)}(o,g,h,v):(i=o,u=g,s=v,l=!(!1!==(c=h)&&null!=c&&c.kind!==zt.PosKind.Abs||!1!==s&&null!=s&&s.kind!==zt.PosKind.Abs),Co(i,u,!1===c?zt.pos(zt.PosKind.Rel,0):c,!1===s?zt.pos(zt.PosKind.Rel,0):s,zt.RefStyle.R1C1,!1,!1,l)),a)}}var ta=Xt.numErrorOper,na="+-*/^%&=<>:";function oa(e){return na.indexOf(e)>=0}var aa={"+":Oo,"-":ko,"*":Lo,"/":Do,"^":_o,"%":Mo,"&":Fo,"=":bo,"<":wo,">":Uo,":":Bo},ia={"<>":Po,"<=":Go,">=":xo};function ua(e,r,t){if(r<e.length-1){var n=ia[e.substr(r,2)];if(null!=n)return Vo(2,n(r),t)}var o=aa[e[r]];if(null!=o)return Vo(1,o(r),t);return C.ULS.assertTag(595980822,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function ca(e,r,t,n){function o(t){var n=t,o=r[n];if("e"!==o&&"E"!==o)return t;if((n+=1)>=r.length)return t;if("+"===(o=r[n])||"-"===o){if((n+=1)>=r.length)return t;o=r[n]}if(!e.isNumeral(o))return t;for(n+=1;n<r.length&&e.isNumeral(r[n]);n+=1);return n}function a(t,n){var a=t,i=r[a];if(i===e.decimalSeparator){if((a+=1)>=r.length)return n?t:a;i=r[a]}if(!e.isNumeral(i))return n?t:o(a);for(a+=1;a<r.length;a+=1)if(!e.isNumeral(r[a]))return o(a);return a}for(var i=t;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=a(i,i===t);break}if(i>t){var u=r.substring(t,i),c=e.parseNumber(u);return Vo(i-t,Ro(t,u,Wr(c)?c:ta,!0),n),i}}function sa(e,r,t){var n=Bn(e,r+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),o=n[0],a=n[1],i=e.substring(r,a+1);return a<e.length?Vo(a+1-r,Ro(r,i,o,!0),t):Vo(a-r,Ro(r,i,o,!1),t)}function la(e,r,t,n){for(var o=1;o<e.errorNames.length;o+=1){var a=e.errorNames[o],i=r.substr(t,a.length),u=Io[o];if(0===e.stringCompareCI(a,i)&&null!=u)return Vo(a.length,u(t,i),n)}}var fa=Object.getOwnPropertyNames(To);function da(e,r,t,n){for(var o=0;o<fa.length;o+=1){var a=fa[o],i=r.substr(t,a.length);if(i.toUpperCase()===a)return Vo(a.length,To[a](t,i),n)}}function ha(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function va(e,r,t,n){var o=Vo(1,co(t,r[t]),n);"#"===r[o]&&(null!=(s=da(0,r,o,n))&&(o=s));for(var a=function(r){return ha(e,r)},i=function(r){return!ha(e,r)},u=Pn("calc.parse.tokenizeBracketedColRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Vo(1,ho(o,c),n);if(xn(r,o,a,"'",i)>0){var s,l=Bn(r,o,a,"'",i),f=l[0];o=Vo((s=l[1])-o,ao(o,f),n)}else o=Vo(1,oo(o,c),n)}return o}function pa(e,r){return!bn(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function ga(e,r,t,n){var o=Vo(1,co(t,r[t]),n);"#"===r[o]&&(null!=(f=da(0,r,o,n))&&(o=f));for(var a=function(r){return pa(e,r)},i=function(r){return!pa(e,r)},u=Pn("calc.parse.tokenizeBracketedRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Vo(1,ho(o,c),n);if(xn(r,o,a,"'",i)>0){var s=Bn(r,o,a,"'",i),l=s[0];o=Vo((f=s[1])-o,ao(o,l),n)}else if(bn(c)){var f,d=Gn(r,o,bn);l=d[0];o=Vo((f=d[1])-o,no(o,l),n)}else o=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Vo(1,oo(o,c),n):va(e,r,o,n):Vo(1,go(o,c),n):Vo(1,Bo(o),n)}return o}var ma,Ea="':*?";function Sa(e,r,t,n){for(var o=Vo(1,lo(t),n),a=function(r){return function(e,r){return Ea.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=Pn("calc.parse.tokenizeQuotedQualifier",o);o<r.length;){u(o);var c=r[o];if("'"===c&&"'"!==r[o+1])return Vo(1,po(o),n);if(":"!==c)if(c!==e.leftBracket)if(xn(r,o,a,"'",i)>0){var s=Bn(r,o,a,"'",i),l=s[0];o=Vo(s[1]-o,ao(o,l),n)}else o=Vo(1,oo(o,c),n);else o=ga(e,r,o,n);else o=Vo(1,Bo(o),n)}return o}function Ta(e,r,t,n){for(var o=e[r],a=r+1;a<e.length;a+=1){var i=e[a];if(i.kind!==t)break;o=n(o,i)}return[o,a]}function Ca(e,r){return oo(e.start,e.chars+r.chars)}function Ra(e,r,t,n,o){for(var a=function(e,r,t,n,o){for(var a=[],i=[],u=ma.Decimal,c=o,s=Pn("calc.parse.tokenize",c);c<n.length;){s(c);var f=ra(e,r,t,n,c,a);if(null==f){var d=n[c];if(u===ma.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var h=ca(e,n,c,a);if(null!=h){c=h,u=ma.FieldAccess;continue}if(d!==e.decimalSeparator){var v="calc.parse.tokenize: failed to tokenize numeral at "+c;return C.ULS.assertTag(595980823,l.LogCategory.msoulscat_ES_EWAJS,!1,v)}}if('"'!==d)if(wn(e,d)){var p=Gn(n,c,(function(r){return Un(e,r)})),g=p[0];c=Vo(p[1]-c,yo(e,c,g),a),u=ma.FieldAccess}else if("#"!==d)if(oa(d))c=ua(n,c,a),u=ma.Decimal;else if(bn(d)){var m=Gn(n,c,bn);g=m[0];c=Vo(m[1]-c,no(c,g),a),u=ma.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===Wn.Brace){if(d===e.columnSeparator){c=Vo(1,mo(c,d),a),u=ma.Decimal;continue}if(d===e.rowSeparator){c=Vo(1,Eo(c,d),a),u=ma.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(c=Vo(1,oo(c,d),a),u=ma.Decimal):(c=Sa(e,n,c,a),u=ma.Decimal):(c=Vo(1,So(c),a),u=ma.Decimal):(c=Vo(1,go(c,d),a),u=ma.Decimal)}else c=Vo(1,ho(c,d),a),u=ma.FieldAccess;else c=ga(e,n,c,a),u=ma.FieldAccess;else i.length>0&&i[i.length-1]===Wn.Brace&&i.pop(),c=Vo(1,vo(c,d),a),u=ma.FieldAccess;else i.push(Wn.Brace),c=Vo(1,so(c,d),a),u=ma.Decimal;else i.length>0&&i[i.length-1]===Wn.Paren&&i.pop(),c=Vo(1,fo(c),a),u=ma.FieldAccess;else i.push(Wn.Paren),c=Vo(1,uo(c),a),u=ma.Decimal;else{var E=la(e,n,c,a);if(null!=E){c=E,u=ma.FieldAccess;continue}c=Vo(1,oo(c,d),a),u=ma.Decimal}else c=sa(n,c,a),u=ma.FieldAccess}else c=f,u=ma.FieldAccess}return a}(e.config.localeInfo,r,t,n,o),i=[],u=0;u<a.length;){var c=a[u];if(c.kind!==Vn.Unexpected)i.push(c),u+=1;else{var s=Ta(a,u,Vn.Unexpected,Ca),f=s[0],d=s[1];i.push(f),u=d}}return i.push(to(n.length)),i}function Ia(e,r,t,n){var o=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,t,n,(function(e,r){o=[e,r]}),(function(){o=!1}))),null==o){var a="calc.parse.runParser: internal error: parser did not call resolve or reject on "+g(r);return C.ULS.assertTag(595980827,l.LogCategory.msoulscat_ES_EWAJS,!1,a)}return o}function ya(e){return function(r,t,n,o,a){return o(e,t)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(ma||(ma={}));var Aa,Na=function(e,r,t,n,o){return o};function Oa(e,r){return function(t,n,o,a,i){return e(t,n,o,(function(e,n){return r(o,e)(t,n,o,a,i)}),i)}}function ka(e,r){return function(t,n,o,a,i){return e(t,n,o,a,(function(){return r(t,n,o,a,i)}))}}function La(e){return 0===e.length?Na:e.reduce(ka)}function Da(e,r){return function(t,n,o,a,i){return e(t,n,o,a,(function(){return a(r,n)}))}}function _a(e,r){return function(t,n,o,a,i){var u=t[n];if(null==u)return i;var c=e(o,u);return null==c?i:a(c,n+r)}}function Ma(e){return _a(e,1)}function Fa(e){return _a(e,0)}function ba(e){return function(r,t,n,o,a){var i=r[t],u=r[t+1];if(null==i||null==u)return a;var c=e(n,i,u);return null==c?a:o(c,t+1)}}function wa(e,r,t){return function(n,o,a,i,u){var c=t,s=o;function f(){return e(n,s,a,d,h)}function d(e,t){if(t<=s){var o=g(n),i="calc.parse.reduce: internal error: no progress made at index "+s+" on "+o;return C.ULS.assertTag(595980829,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return c=r(a,e,c),s=t,f}function h(){return i(c,s)}return f}}function Ua(e,r){return wa(e,(function(e,r,t){return t.push(r),t}),r)}function Pa(e){return function(r,t,n,o,a){return Ua(e,[])(r,t,n,o,a)}}function Ga(e,r){return Oa(e,(function(e,t){return Ua(r,[t])}))}function xa(e){var r=e.length;return function(t,n,o,a,i){var u=n,c=[];function s(){return e[c.length](t,u,o,l,i)}function l(e,t){return u=t,c.push(e),c.length<r?s:a(c,u)}return s}}function Ba(e,r){return xa([e,r])}function Va(e,r,t,n,o){return xa([e,r,t,n,o])}function Wa(e,r){return function(t,n,o,a,i){return e(t,n,o,(function(e,t){return a(r(o,e),t)}),i)}}function Ha(e,r,t){return Wa(xa([e,r]),(function(e,r){return t(e,r[0],r[1])}))}function Ka(e,r,t,n){return Wa(xa([e,r,t]),(function(e,r){return n(e,r[0],r[1],r[2])}))}function ja(e,r,t,n,o){return Wa(xa([e,r,t,n]),(function(e,r){return o(e,r[0],r[1],r[2],r[3])}))}function Ja(e,r,t,n,o,a){return Wa(xa([e,r,t,n,o]),(function(e,r){return a(e,r[0],r[1],r[2],r[3],r[4])}))}function qa(e,r){return Ha(e,r,(function(e,r,t){return r}))}function Ya(e,r){return Ha(e,r,(function(e,r,t){return t}))}function Xa(e,r){var t=e.spans[r.label];if(null==t){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+g(r);return C.ULS.assertTag(595980824,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}return t}function Qa(e,r,t,n,o){var a=e.label;return e.label+=1,e.spans[a]=zt.formulaSpan(r,t,n,o),a}function za(e,r,t,n){var o=Xa(e,t);return o.pre=r,o.post=n,t}function Za(e,r,t){return function(n,o,a,i,u){var c=a.leftDelim,s=a.listSep;return a.leftDelim=e,a.listSep=r,t(n,o,a,(function(e,r){return a.leftDelim=c,a.listSep=s,i(e,r)}),(function(){return a.leftDelim=c,a.listSep=s,u}))}}function $a(e,r){return r.kind===Vn.Spaces||r.kind===Vn.End?r.start:Xa(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(Aa||(Aa={}));var ei=Da(Ma((function(e,r){return r.kind===Vn.Spaces?r.chars:void 0})),"");function ri(e){return Ka(ei,Ma(e),ei,za)}var ti=ri((function(e,r){return r.kind!==zt.NodeKind.Operator||r.id!==$t.OperatorId.Add&&r.id!==$t.OperatorId.Sub?void 0:r})),ni=Ha(Ma((function(e,r){if(r.kind===zt.NodeKind.Operator){if(r.id===$t.OperatorId.Add)return zt.operatorNode($t.OperatorId.Pos,r.label);if(r.id===$t.OperatorId.Sub)return zt.operatorNode($t.OperatorId.Neg,r.label)}})),ei,(function(e,r,t){return za(e,"",r,t)})),oi=ri((function(e,r){return r.kind!==zt.NodeKind.Operator||r.id!==$t.OperatorId.Mul&&r.id!==$t.OperatorId.Div?void 0:r})),ai=ri((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Pow?r:void 0})),ii=function(e){return Ha(ei,Ma(e),(function(e,r,t){return za(e,r,t,"")}))}((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Percent?r:void 0})),ui=ri((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Concat?r:void 0})),ci=ri((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id>=$t.OperatorId.Eq&&r.id<=$t.OperatorId.Ge?r:void 0})),si=ri((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Range?r:void 0})),li=ri((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Union?r:void 0})),fi=ba((function(e,r,t){if(r.kind===Vn.Spaces&&t.kind!==Vn.End&&t.kind!==zt.NodeKind.Operator){var n=Qa(e,r.start,$a(e,t),r.chars,"");return zt.operatorNode($t.OperatorId.Isect,n)}}));function di(e,r,t){return Ha(e,Pa(Ba(r,e)),(function(e,r,n){return 0===n.length?r:n.reduce(t(e),r)}))}function hi(e){return function(r,t){var n=t[0],o=t[1],a=Xa(e,r).start,i=Xa(e,o).end,u=Qa(e,a,i,"","");return zt.appNode(n,[r,o],!0,u)}}function vi(e,r){var t=Qa(e,Xa(e,r[0]).start,Xa(e,r[r.length-1]).end,"","");return zt.badNode(zt.BadType.Sequence,r,t)}var pi,gi,mi=di(Ha((function(e,r,t,n,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+g(e);return C.ULS.assertTag(595980864,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return n($a(t,a),r)}),Pa(Ma((function(e,r){return r.kind!==zt.NodeKind.Operator&&r.kind!==Vn.Spaces&&r.kind!==Vn.End?r:void 0}))),(function(e,r,t){return 0===t.length?zt.literalNode(Xt.missingOper,!0,Qa(e,r,r,"","")):1===t.length?t[0]:vi(e,t)})),si,hi),Ei=di(mi,fi,hi),Si=di(Ei,li,hi),Ti=di(function(e,r,t){return Ha(e,Pa(r),(function(e,r,n){return 0===n.length?r:n.reduce(t(e),r)}))}((pi=Si,gi=function(e){var r=!0;return function(t,n){var o=Xa(e,n).start,a=Xa(e,t).end,i=Qa(e,o,a,"","");if(r&&(r=!1,t.kind===zt.NodeKind.Literal&&"number"==typeof t.oper)){var u=n.id===$t.OperatorId.Pos?t.oper:-t.oper;return zt.literalNode(u,!0,i)}return zt.appNode(n,[t],!0,i)}},Ha(Pa(ni),pi,(function(e,r,t){return 0===r.length?t:r.reduceRight(gi(e),t)}))),ii,(function(e){return function(r,t){var n=Xa(e,r).start,o=Xa(e,t).end,a=Qa(e,n,o,"","");return zt.appNode(t,[r],!0,a)}})),ai,hi),Ci=di(Ti,oi,hi),Ri=di(Ci,ti,hi),Ii=di(Ri,ui,hi),yi=di(Ii,ci,hi),Ai=Ha(yi,Pa(Ya(Fa((function(e,r){return r.kind===Vn.End?void 0:r})),yi)),(function(e,r,t){return 0===t.length?r:vi(e,[r].concat(t))}));var Ni=Da(Ma((function(e,r){return r.kind===Vn.Spaces?r.chars:void 0})),""),Oi=function(e,r,t,n,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+g(e);return C.ULS.assertTag(595980830,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return n(a.start,r)};function ki(e){return Ma((function(r,t){return t.kind===Vn.Sep&&t.value===e||void 0}))}function Li(e){return Ma((function(r,t){return t.kind===Vn.Left&&t.value===e?t.start:void 0}))}function Di(e){return Ma((function(r,t){return t.kind===Vn.Right&&t.value===e||void 0}))}var _i,Mi=ki(Hn.List),Fi=ki(Hn.Row),bi=ki(Hn.Col),wi=ki(Hn.Qual),Ui=Li(Wn.Paren),Pi=Di(Wn.Paren),Gi=Li(Wn.Brace),xi=Di(Wn.Brace),Bi=Li(Wn.SQuote),Vi=Di(Wn.SQuote),Wi=Ma((function(e,r){return r.kind===Vn.Operator&&r.value===$t.OperatorId.Range||void 0})),Hi=_i={impl:function(e,r,t,n,o){return C.ULS.assertTag(595980828,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,r,t,n,o){return function(){return _i.impl(e,r,t,n,o)}}},Ki=Ka(Ni,Hi.parser,Ni,za),ji=ja(Ui,Za(Wn.Paren,Aa.Union,Ki),Da(Pi,!1),Oi,(function(e,r,t,n,o){var a=Qa(e,r,o,"","");return zt.parenNode(t,n,a)})),Ji=Ga(Ki,Ya(bi,Ki)),qi=Ga(Ji,Ya(Fi,Ji)),Yi=ja(Gi,Za(Wn.Brace,Aa.Union,qi),Da(xi,!1),Oi,(function(e,r,t,n,o){var a=Qa(e,r,o,"","");return zt.arrayNode(t,n,a)})),Xi=Ma((function(e,r){if(r.kind===Vn.Ident||r.kind===Vn.CellRef&&r.isQualPart||r.kind===Vn.Literal&&r.isQualPart||r.kind===Vn.Operator&&r.value===$t.OperatorId.Dot)return r.chars})),Qi=Ga(Xi,Xi),zi=Ma((function(e,r){return r.kind===Vn.Ident?r.chars:void 0}));function Zi(e){return e.kind===Vn.Literal&&"object"==typeof e.oper&&e.oper.kind===Xt.OperKind.Error&&e.oper.type===Xt.ErrorType.REF}function $i(e,r,t,n){return null==r?[zt.identQualifier(e,t,n),t?"'"+e+"'":e]:[zt.sheetRangeQualifier(e,r,t,n),t?"'"+e+":"+r+"'":e+":"+r]}var eu=ja(Oi,Qi,Da(Ya(Wi,Qi),void 0),Oi,(function(e,r,t,n,o){var a=Qa(e,r,o,"","");return $i(t.join(""),null!=n?n.join(""):void 0,!1,a)})),ru=Ja(Bi,zi,Da(Ya(Wi,zi),void 0),Vi,Oi,(function(e,r,t,n,o,a){return $i(t,n,!0,Qa(e,r,a,"",""))})),tu=ja(Bi,Pa(Ma((function(e,r){return r.kind===Vn.End||r.kind===Vn.Right&&r.value===Wn.SQuote?void 0:r.chars}))),Da(Ba(Vi,Da(qa(wi,Ni),!1)),[!1,!1]),Oi,(function(e,r,t,n,o){var a=n[0],i=n[1],u="'"+t.join("")+(a?"'":"")+(i?"!":""),c=Qa(e,r,o,"","");return[zt.badNode(zt.BadType.Qualifier,u,c),u]})),nu=ba((function(e,r,t){if(Zi(r)){var n=Qa(e,r.start,t.start,"","");return[zt.errorQualifierLabeled(n),r.chars]}})),ou=Ha(La([eu,ru,Fa((function(e,r){var t=Qa(e,r.start,r.start,"","");return[zt.relativeQualifierLabeled(t),""]}))]),qa(wi,Ni),(function(e,r,t){return[r[0],r[1]+"!"]})),au=La([nu,ou,tu]);function iu(e,r){return r.kind===Vn.CellRef&&e.refStyle===r.refStyle}var uu=ba((function(e,r,t){return iu(e,r)?[r,t.start]:void 0}));function cu(e,r){if(null!=e.row&&null!=e.col)return zt.cellRefSingle(e.row,e.col,r);if(null!=e.row)return zt.cellRefRow(e.row,e.row,r);if(null!=e.col)return zt.cellRefCol(e.col,e.col,r);var t="calc.parse.cellRefToken2cellRef: bad token "+g(e);return C.ULS.assertTag(595980831,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var su=ba((function(e,r,t){if(iu(e,r)&&(r.refStyle!==zt.RefStyle.A1||null!=r.row&&null!=r.col))return cu(r,n=Qa(e,r.start,t.start,"",""));if(Zi(r)){var n=Qa(e,r.start,t.start,"","");return zt.cellRefErrorLabeled(n)}})),lu=ka(Oa(Va(uu,Ni,Wi,Ni,uu),(function(e,r){var t=r[0],n=t[0],o=t[1],a=r[1],i=(r[2],r[3]),u=r[4],c=u[0],s=u[1],l=Qa(e,n.start,o,"",a),f=Qa(e,c.start,s,i,""),d=cu(n,l),h=cu(c,f),v=void 0;if(d.kind===zt.CellRefKind.Single&&h.kind===zt.CellRefKind.Single){var p=Qa(e,n.start,s,"","");v=zt.cellRefRange(d,h,p)}else if(0===a.length&&0===i.length)if(d.kind===zt.CellRefKind.Row&&h.kind===zt.CellRefKind.Row){p=Qa(e,n.start,s,"","");v=zt.cellRefRow(d.row1,h.row1,p)}else if(d.kind===zt.CellRefKind.Col&&h.kind===zt.CellRefKind.Col){p=Qa(e,n.start,s,"","");v=zt.cellRefCol(d.col1,h.col1,p)}return null==v?Na:n.isQualPart&&c.isQualPart?Fa((function(e,r){return r.kind===Vn.Sep&&r.value===Hn.Qual?void 0:v})):ya(v)})),su),fu=Ma((function(e,r){return r.kind===Vn.Ident||r.kind===Vn.CellRef&&r.isName?r.chars:void 0})),du=Oa(Va(Oi,au,Oi,Da(ka(lu,fu),void 0),Oi),(function(e,r){var t=r[0],n=r[1],o=n[0],a=n[1],i=r[2],u=r[3],c=r[4];if(null==u)return o.kind!==zt.QualifierKind.SheetRange||o.isQuoted?o.kind===zt.QualifierKind.Error?ya(zt.literalNode(Xt.refErrorOper,!0,o.label)):ya(o.kind===zt.NodeKind.Bad?o:zt.badNode(zt.BadType.Qualifier,a,o.label)):Na;if("string"==typeof u){if(o.kind===zt.QualifierKind.SheetRange&&!o.isQuoted)return Na;var s=Qa(e,t,c,"","");if(o.kind===zt.NodeKind.Bad||o.kind===zt.QualifierKind.Error||o.kind===zt.QualifierKind.SheetRange){var l=o.kind===zt.NodeKind.Bad?o:zt.badNode(zt.BadType.Qualifier,a,o.label),f=zt.nameNode(u,void 0,Qa(e,i,c,"",""));return ya(zt.badNode(zt.BadType.Sequence,[l,f],s))}return ya(zt.nameNode(u,o,s))}var d=Qa(e,t,c,"","");if(o.kind===zt.NodeKind.Bad||o.kind===zt.QualifierKind.Document){var h=o.kind===zt.NodeKind.Bad?o:zt.badNode(zt.BadType.Qualifier,a,o.label);f=zt.cellRefNode(u,void 0,Qa(e,i,c,"",""));return ya(zt.badNode(zt.BadType.Sequence,[h,f],d))}var v=o.kind===zt.QualifierKind.Ident?zt.sheetQualifier(o.name,void 0,o.isQuoted,o.label):o;return ya(zt.cellRefNode(u,v,d))})),hu=Ka(Oi,ka(lu,fu),Oi,(function(e,r,t,n){var o=Qa(e,r,n,"","");return"string"==typeof t?zt.nameNode(t,void 0,o):t.kind===zt.CellRefKind.Error?zt.literalNode(Xt.refErrorOper,!0,o):zt.cellRefNode(t,void 0,o)})),vu=ba((function(e,r,t){if(r.kind===Vn.Literal)return zt.literalNode(r.oper,r.hasRight,Qa(e,r.start,t.start,"",""));if(r.kind===Vn.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var n=r.row.index+e.range.range.row+1;return zt.literalNode(n,!0,Qa(e,r.start,t.start,"",""))}}));function pu(e){return ba((function(r,t,n){if(e(t)){var o=Qa(r,t.start,n.start,"","");return zt.badNode(zt.BadType.Unexpected,t.chars,o)}}))}var gu=pu((function(e){return e.kind===Vn.Left&&e.value===Wn.Bracket})),mu=pu((function(e){return e.kind===Vn.Right&&e.value===Wn.Bracket})),Eu=Ja(Oi,gu,Za(Wn.Bracket,Aa.Union,Ki),Da(mu,void 0),Oi,(function(e,r,t,n,o,a){var i=[t,n];null!=o&&i.push(o);var u=Qa(e,r,a,"","");return zt.badNode(zt.BadType.Sequence,i,u)})),Su=ba((function(e,r,t){switch(r.kind){case Vn.End:case Vn.Operator:case Vn.Spaces:return;case Vn.Sep:if(r.value!==Hn.Qual&&(e.leftDelim===Wn.Brace||r.value!==Hn.Col&&r.value!==Hn.Row))return;break;case Vn.Right:if(r.value===e.leftDelim)return}var n=r.kind===Vn.CellRef?zt.BadType.CellRef:zt.BadType.Unexpected,o=Qa(e,r.start,t.start,"","");return zt.badNode(n,r.chars,o)})),Tu=ba((function(e,r,t){if((r.kind===Vn.Ident||r.kind===Vn.CellRef||r.kind===Vn.Literal&&"boolean"==typeof r.oper)&&t.kind===Vn.Left&&t.value===Wn.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var n=Qa(e,r.start,t.start,"","");return zt.nameNode(r.chars,void 0,n)}})),Cu=ja(Ui,Za(Wn.Paren,Aa.Arg,Ga(Ki,Ya(Mi,Ki))),Da(Pi,!1),Oi,(function(e,r,t,n,o){return[t,n,o]})),Ru=Ha(Tu,Cu,(function(e,r,t){var n=t[0],o=t[1],a=t[2],i=Qa(e,Xa(e,r).start,a,"","");return zt.appNode(r,n,o,i)})),Iu=Ha(La([Ru,du,hu,vu,ji,Yi,Eu,Su]),Pa(Cu),(function(e,r,t){var n=Xa(e,r).start;return t.reduce((function(r,t){var o=t[0],a=t[1],i=t[2],u=Qa(e,n,i,"","");return zt.appNode(r,o,a,u)}),r)})),yu=ba((function(e,r,t){var n=void 0;if(r.kind===Vn.Operator&&(n=r.value),r.kind===Vn.Sep&&r.value===Hn.List&&e.listSep===Aa.Union&&(n=$t.OperatorId.Union),null!=n){var o=Qa(e,r.start,t.start,"","");return zt.operatorNode(n,o)}})),Au=Ma((function(e,r){return r.kind===Vn.Spaces?r:void 0})),Nu=ka(Iu,yu),Ou=Oa(Nu,(function(e,r){return wa(Ba(Da(Au,void 0),Nu),(function(e,r,t){var n=r[0],o=r[1];return null!=n&&t.push(n),t.push(o),t}),[r])})),ku=Ha(Da(Ou,void 0),Oi,(function(e,r,t){if(null==r){var n=Qa(e,t,t,"","");return zt.literalNode(Xt.missingOper,!0,n)}if(1===r.length){var o=r[0];if(o.kind!==zt.NodeKind.Operator&&o.kind!==Vn.Spaces)return o}return r.push(to(t)),function(e,r){var t=e.length-1;if(t<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return C.ULS.assertTag(595980865,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===Vn.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+g(e);return C.ULS.assertTag(595980866,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t-1>=0&&e[t-1].kind===Vn.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+g(e);return C.ULS.assertTag(595980867,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[t].kind!==Vn.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+g(e);return C.ULS.assertTag(595980868,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var o=Ia(Ai,e,0,r);if(!1===o){n="calc.parse.parseTerms: internal error: failed to parse "+g(e);return C.ULS.assertTag(595980869,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=o[0],i=o[1];if(i<t){n="calc.parse.parseTerms: internal error: consumed "+i+" out of "+t+" in "+g(e);return C.ULS.assertTag(595980870,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}return a}(r,e)}));function Lu(e,r,t,n,o){var a=o.length-1;if(a<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return C.ULS.assertTag(595980832,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(o[a].kind!==Vn.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+g(o);return C.ULS.assertTag(595980833,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,t,n){return{localeInfo:e,refStyle:r,range:t,source:n,leftDelim:void 0,listSep:Aa.Union,label:1,spans:{}}}(e.config.localeInfo,r,t,n),c=Ia(Ki,o,0,u);if(!1===c){i="calc.parse.parseTokens: internal error: failed to parse "+g(o);return C.ULS.assertTag(595980834,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}var s=c[0],f=c[1];if(f<a){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+a+" in "+g(o);return C.ULS.assertTag(595980835,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return zt.formula(s,u.spans)}Hi.impl=ku;var Du={"=":1,"+":0,"-":0,"@":-1};function _u(e){return{parseFormula:function(r,t,n,o){return function(e,r,t,n,o){var a=o[0],i=null!=a?Du[a]:void 0;if(null==i)return rn.failure(Mn("first character is not '=', '+', '-' or '@'"));if(i<0)return rn.failure(Ln(["Lotus 1-2-3 syntax"]));if(r===zt.RefStyle.A1&&null==t){return C.ULS.assertTag(595980825,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined")}var u=Lu(e,r,t,n,Ra(e,r,t,o,i));return rn.success(u)}(e,r,t,n,o)},formatFormula:function(r,t,n,o){return rn.prettyPrinter(o.node,e.config.localeInfo,t,r,n)}}}var Mu=zt.QualifierKind,Fu=zt.CellRefKind,bu=zt.NodeKind,wu=rn.ResultKind;function Uu(e){return e.kind===wu.Success}function Pu(e,r){var t=e[r];return null==t?y("ParseResultHelper.getFormulaSpan: expected span for label "+r+" to be defined"):t}function Gu(e,r,t){return!!Uu(e)&&(function(e,r,t){if(null==e||null==t)return;var n={};null!=r?r.forEach((function(e){n[e]=!0})):n["*"]=!0;var o=[];o.push(e.node);for(;o.length>0;){var a=o.pop();if(null!=a)switch(a.kind){case bu.Literal:c("literal")&&t("literal",{label:a.label,value:a});break;case bu.Array:a.nodes.map((function(e){return e.map((function(e){o.push(e)}))}));break;case bu.App:if("object"!=typeof a.head)c("literal")&&t("literal",{label:a.label,value:a.head});else{var i=a.head;switch(i.kind){case bu.Operator:c("operator")&&t("operator",{label:a.label,value:i.id});break;case bu.Name:c("function")&&t("function",{label:a.label,name:i.whole,isClosed:a.isClosed,args:a.args});break;default:o.push(i)}}a.args.map((function(e){o.push(e)}));break;case bu.Paren:o.push(a.node);break;case bu.Name:if(c("namedRange")){var u=a.whole.split(".");t("namedRange",{label:a.label,name:u[0],names:u.slice(1),qualifier:s(a)})}break;case bu.CellRef:c("range")&&l(a);break;case bu.Bad:break;default:return I("calc.parse.traverseFormula",a)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case Mu.Sheet:var t=e.qualifier;r.type=Mu.Sheet,r.sheet=t.sheet,null!=t.document&&(r.document=t.document.document,null!=t.document.path&&(r.documentPath=t.document.path));break;case Mu.SheetRange:var n=e.qualifier;r.type=Mu.SheetRange,r.sheet1=n.sheet1,r.sheet2=n.sheet2;break;case Mu.Ident:var o=e.qualifier;r.type=Mu.Ident,r.name=o.name;break;case Mu.Document:var a=e.qualifier;r.document=a.document,null!=a.path&&(r.documentPath=a.path)}return r}}function l(r){if(null!=e&&null!=t)switch(r.ref.kind){case Fu.Error:break;case Fu.Col:var n=r.ref;t("range",{label:r.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:Pu(e.spans,n.label),qualifier:s(r)});break;case Fu.Row:var o=r.ref;t("range",{label:r.label,type:"row",startIndex:o.row1,endIndex:o.row2,span:Pu(e.spans,o.label),qualifier:s(r)});break;case Fu.Single:var a=r.ref;t("range",{label:r.label,type:"cell",row:a.row,col:a.col,span:Pu(e.spans,a.label),qualifier:s(r)});break;case Fu.Range:var i=r.ref;t("range",{label:r.label,type:"range",top:i.ref1.row,left:i.ref1.col,bottom:i.ref2.row,right:i.ref2.col,topLeftSpan:Pu(e.spans,i.ref1.label),bottomRightSpan:Pu(e.spans,i.ref2.label),qualifier:s(r)})}}}(e.value,r,t),!0)}var xu={isSuccess:Uu,traverse:Gu,extractReferences:function(e){if(Uu(e)){var r=[];return Gu(e,["range","namedRange"],(function(t,n){var o={kind:t,ref:n,span:Pu(e.value.spans,n.label)};r.push(o)})),r.sort((function(e,r){return e.span.start-r.span.start})),r}}};var Bu,Vu,Wu=rn.ReasonKind,Hu=rn.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(Bu||(Bu={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula",e.JavaScriptError="JavaScriptError"}(Vu||(Vu={}));var Ku,ju=it.__assign({},Wu,Vu),Ju=Hu;function qu(e,r,t,n,o){return{config:e,getDocumentLoc:r,getSheetIndex:t,getCellFormat:n,getKnownFormat:o}}!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Ku||(Ku={}));var Yu={Unclosed_expression:{code:1,category:Ku.SyntaxError},Illegal_array_literal_element:{code:2,category:Ku.SyntaxError},Empty_array_literal:{code:3,category:Ku.SyntaxError},Irregular_array_shape:{code:4,category:Ku.SyntaxError},Empty_parenthesis:{code:5,category:Ku.SyntaxError},Missing_operation_argument:{code:6,category:Ku.SyntaxError},Bad_node:{code:7,category:Ku.SyntaxError},Invalid_binder:{code:8,category:Ku.SyntaxError},Empty_formula:{code:9,category:Ku.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Ku.SyntaxError},Types_not_related:{code:1001,category:Ku.TypeError},Unexpected_application_head:{code:1002,category:Ku.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Ku.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Ku.TypeError},Excess_function_arguments:{code:1005,category:Ku.TypeError},Insufficient_function_arguments:{code:1006,category:Ku.TypeError}},Xu=zt.NodeKind,Qu=zt.QualifierKind,zu=zt.BadType,Zu=zt.CellRefKind,$u=qt.FormulaSource,ec=Xt.OperKind,rc=Xt.ErrorType,tc=$t.SignatureType,nc=$t.SpecialPrecs,oc=$t.getOperatorType,ac=$t.WorksheetFuncId,ic=$t.getWorksheetFuncType,uc=rn.operKind,cc=rn.getArguments,sc=rn.getArgType,lc=rn.defaultLiteralVisitor,fc=rn.defaultFormulaVisitor,dc=rn.dispatch,hc=rn.startVisit,vc={};function pc(e,r){return{context:e,result:r}}function gc(e){return function(r){return r.kind===Xu.Literal&&e(r.oper)}}var mc=gc((function(e){return uc(e)===ec.Missing})),Ec=gc((function(e){return uc(e)===ec.Error&&e.type===rc.REF})),Sc=gc((function(e){return 0!=(uc(e)&(ec.String|ec.Error|ec.Boolean))}));function Tc(e){return e.kind===Xu.Name&&void 0===e.qualifier}function Cc(e,r,t,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(r,t,e.errorData))}function Rc(e,r){return r!==ec.Range||0!=(e&ec.Range)}function Ic(e,r){if(r.kind===Xu.Literal)switch(Cc(e,r,Yu.Unclosed_expression,r.isClosed),uc(r.oper)){case ec.Number:case ec.Boolean:case ec.String:case ec.Error:return;default:return void Cc(e,r,Yu.Illegal_array_literal_element)}Cc(e,r,Yu.Illegal_array_literal_element)}function yc(e,r,t){Cc(e,r,Yu.Types_not_related,Rc(ec.Array,t)),Cc(e,r,Yu.Unclosed_expression,r.isClosed);var n=r.nodes.length>0;if(Cc(e,r,Yu.Empty_array_literal,n),!n)return pc(e,t);for(var o=r.nodes[0].length,a=0;a<r.nodes.length;a+=1){var i=r.nodes[a],u=i.length;Cc(e,r,Yu.Irregular_array_shape,u===o);for(var c=0;c<u;c+=1)Ic(e,i[c])}return pc(e,t)}function Ac(e,r,t){if(e.earlyExit&&!e.isOk())throw vc;switch(r.kind){case Xu.Array:return yc(e,r,t);case Xu.Paren:return Cc(e,r,Yu.Unclosed_expression,r.isClosed),Cc(e,r,Yu.Empty_parenthesis,!mc(r.node)),Ac(e,r.node,t);case Xu.Bad:case Xu.Name:case Xu.CellRef:case Xu.App:case Xu.Literal:var n=kc(e,r);return Cc(e,r,Yu.Types_not_related,Rc(n.result,t)),n.result=t,n;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function Nc(e,r,t){var n,o=ic(r),a=t.args,i=a.length,u=cc(t),c=u.length,s=e.isOk();c<o.minArgs&&Cc(e,void 0===(n=a[i-1])?t:n,Yu.Insufficient_function_arguments);0===o.restTypes.length&&c>o.headTypes.length&&Cc(e,void 0===(n=a[i-1])?t:n,Yu.Excess_function_arguments);o.restTypes.length>1&&r!==ac.SWITCH&&((c-o.headTypes.length)%o.restTypes.length!=0&&Cc(e,void 0===(n=a[i-1])?t:n,Yu.Insufficient_function_arguments));for(var l=0;l<c;l+=1)Ac(e,u[l],sc(o,l));var f=!s||e.isOk();return f&&(e.specialDependencies|=o.staticPrecs,function(e,r,t){switch(r){case ac.LET:var n=t[0];return void 0!==n?Cc(e,n,Yu.Invalid_binder,Tc(n)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",n);case ac.FUN:for(var o=0;o<t.length-1;o+=1){var a=t[o];Cc(e,a,Yu.Invalid_binder,Tc(a))}}}(e,r,a)),pc(e,f?o.returnType:tc.All)}function Oc(e,r){Cc(e,r,Yu.Unclosed_expression,r.isClosed);var t=r.args;if(r.head.kind===Xu.Operator)return function(e,r,t){var n=oc(r.id),o=t.length,a=o===n.minArgs;Cc(e,r,Yu.Incorrect_number_of_operator_arguments,a);for(var i=0;i<o;i+=1){var u=t[i];mc(u)&&(a=!1,Cc(e,u,Yu.Missing_operation_argument)),Ac(e,u,sc(n,i))}return a?(e.specialDependencies|=n.staticPrecs,pc(e,n.returnType)):pc(e,tc.All)}(e,r.head,t);if(Tc(r.head)){var n=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==n)return Nc(e,n,r)}for(var o=0;o<t.length;o+=1)Ac(e,t[o],tc.All);var a=r.head,i=kc(e,a);return Rc(i.result,ec.Range)||i.result===ec.Error&&function(e){for(var r=e;r.kind===Xu.Paren;)r=r.node;return Ec(r)}(a)?pc(e,tc.All):(Cc(e,a,Sc(a)||a.kind===Xu.Array?Yu.Unexpected_application_head:Yu.Unexpected_application_head_with_fix),pc(e,tc.All))}function kc(e,r){if(e.earlyExit&&!e.isOk())throw vc;switch(r.kind){case Xu.App:return Oc(e,r);case Xu.Array:return yc(e,r,ec.Array);case Xu.Bad:return Cc(e,r,Yu.Bad_node),pc(e,tc.All);case Xu.CellRef:return e.source!==$u.Cell&&e.source!==$u.Range||void 0===r.qualifier||r.qualifier.kind!==Qu.Relative?pc(e,ec.Range):(Cc(e,r,Yu.Invalid_rel_sheet_qualifier_in_cell),pc(e,tc.All));case Xu.Literal:return Cc(e,r,Yu.Unclosed_expression,r.isClosed),pc(e,uc(r.oper));case Xu.Name:return pc(e,tc.All);case Xu.Paren:return Cc(e,r,Yu.Unclosed_expression,r.isClosed),Cc(e,r,Yu.Empty_parenthesis,!mc(r.node)),kc(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var Lc={ok:!0,isOk:ur,collect:function(e,r,t){return!1}};function Dc(e,r,t,n,o){void 0===o&&(o=!0);var a={globals:e,location:r,source:t,reportError:n.collect,isOk:function(){return n.isOk(a.errorData)},earlyExit:o,specialDependencies:nc.None,errorData:n.ok};return a}function _c(e,r){try{return Cc(e,r.node,Yu.Empty_formula,!mc(r.node)),Ac(e,r.node,tc.All)}catch(r){return r!==vc&&C.ULS.traceTag(595952020,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+g(r)),pc(e,tc.All)}}function Mc(e,r){if(r.kind!==Xu.Bad||r.type!==zu.Sequence||3!==r.contents.length)return!1;var t=r.contents[0],n=r.contents[2];return t.kind===Xu.Bad&&t.type===zu.Unexpected&&t.contents===e.leftBracket&&(n.kind===Xu.Bad&&n.type===zu.Unexpected&&n.contents===e.rightBracket)}function Fc(e,r){if(2===r.length){var t,n=r[0],o=r[1];return Mc(e,n)?(t=o).kind===Xu.Name&&null!=t.qualifier&&t.qualifier.kind===Qu.Ident?Xu.Name:function(e){return e.kind===Xu.CellRef&&null!=e.qualifier&&e.qualifier.kind===Qu.Sheet&&null==e.qualifier.document}(o)?Xu.CellRef:void 0:function(e,r){return r.kind===Xu.Bad&&r.type===zu.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,n)?Tc(o)?Xu.Name:function(e){return e.kind===Xu.CellRef&&null==e.qualifier}(o)?Xu.CellRef:void 0:void 0}}function bc(e){if(e.kind===Xu.Literal&&e.isClosed)switch(uc(e.oper)){case ec.Number:case ec.Boolean:case ec.String:case ec.Error:return!0;default:return!1}return!1}function wc(e,r){var t=r.head,n=t.kind!==Xu.Operator;if(!r.isClosed||r.args.some((function(r){return!Uc(e,r,n)})))return!1;if(t.kind===Xu.Operator)return(a=oc(t.id)).minArgs===r.args.length;if(!Uc(e,t,!1))return!1;if(Tc(t)){var o=e.config.localeInfo.getWorksheetFuncId(t.whole.toLocaleUpperCase());if(void 0!==o){var a=ic(o),i=cc(r).length;if(i<a.minArgs)return!1;if(0===a.restTypes.length&&i>a.headTypes.length)return!1;if(a.restTypes.length>1&&o!==ac.SWITCH)if((i-a.headTypes.length)%a.restTypes.length!=0)return!1;return function(e,r){switch(e){case ac.LET:return Tc(r[0]);case ac.FUN:return r.slice(0,r.length-1).every(Tc);default:return!0}}(o,r.args)}}return!0}function Uc(e,r,t){switch(r.kind){case Xu.Literal:return r.isClosed&&(!!t||uc(r.oper)!==ec.Missing);case Xu.Name:case Xu.CellRef:return!0;case Xu.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every(bc);var t,n}));case Xu.App:return wc(e,r);case Xu.Paren:return r.isClosed&&Uc(e,r.node,!1);case Xu.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function Pc(e,r,t){switch(r.kind){case Xu.Literal:case Xu.Name:break;case Xu.CellRef:r.ref.kind===Zu.Row&&(t.rowRef+=1),r.ref.kind===Zu.Col&&(t.colRef+=1);break;case Xu.Array:r.nodes.forEach((function(r){return r.forEach((function(r){return Pc(e,r,t)}))}));break;case Xu.App:r.head.kind!==Xu.Operator&&Pc(e,r.head,t),r.args.forEach((function(r){return Pc(e,r,t)}));break;case Xu.Paren:Pc(e,r.node,t);break;case Xu.Bad:if(r.type===zu.Sequence){var n=r.contents;if(function(e,r){return 2===r.length&&Tc(r[0])&&Mc(e,r[1])}(e,n))t.structRef+=1;else{var o=Fc(e,n);null!=o?(o===Xu.Name?t.docQualName+=1:o===Xu.CellRef&&(t.docQualCellRef+=1),Pc(e,n[1],t)):n.forEach((function(r){return Pc(e,r,t)}))}}else r.type===zu.Qualifier&&(t.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var Gc=fc(lc((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var r=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var t=dc(e,Gc);r=Math.max(r,t)}))})),1+r},vRange:function(e){var r=dc(e.ref1,Gc),t=dc(e.ref2,Gc);return 1+Math.max(r,t)},vBad:function(e){if(e.type===zu.Sequence){var r=-1;return e.contents.forEach((function(e){var t=dc(e,Gc);r=Math.max(r,t)})),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var t=dc(e.qualifier,Gc);r=Math.max(r,t)}return 1+Math.max(r,dc(e.ref,Gc))},vParen:function(e){return 1+dc(e.node,Gc)},vApp:function(e){var r=-1;return e.args.forEach((function(e){var t=dc(e,Gc);r=Math.max(r,t)})),1+r}});var xc,Bc=[];function Vc(e,r,t,n,o){var a,i={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(Pc(e.config.localeInfo,n.node,i),i.rowRef+i.colRef+i.structRef+i.docQualName+i.docQualCellRef+i.badQual>0&&C.ULS.traceTag(595961670,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+o+"; anonymize: "+g(n.node)+"; stats = "+JSON.stringify(i)),dt(at.CalcStrictFormulaChecking))if(Bc.length<10){var u=(a=n.node,hc(a,Gc,-1));Bc.push(u)}else C.ULS.traceTag(595957962,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+Bc.join("; ")),Bc=[];var c=dt(at.CalcStrictFormulaChecking)?function(e,r,t,n){return _c(Dc(e,r,t,Lc),n).context.errorData}(e,r,t,n):Uc(e,n.node,!1);return c||function(e){e.kind!==Xu.App||e.isClosed||C.ULS.traceTag(595949718,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(n.node),it.__assign({},n,{isWellFormed:c})}var Wc=zt.NodeKind,Hc=Xt.OperKind,Kc=$t.OperatorId,jc=$t.getWorksheetFuncType,Jc=$t.WorksheetFuncId,qc=rn.success,Yc=rn.failure,Xc=rn.operKind,Qc=rn.isSuccess,zc=rn.getArguments,Zc=rn.unavailable,$c=rn.sheetGridRangeAnchor,es=rn.createResolutionHandler,rs=rn.createResolver,ts=rn.isSheetGridRange,ns={kind:ju.BadOperation},os={kind:ju.BadFormula},as={getDocumentLoc:function(){},getSheetIndex:function(){return Yc(Zc(["defaultInferenceGlobals getSheetIndex"]))},getCellFormat:function(){return Yc(Zc(["defaultInferenceGlobals getCellFormat"]))},getKnownFormat:function(){return Yc(Zc(["defaultInferenceGlobals getKnownFormat"]))}};function is(e){return{getDocumentLoc:dr(e.getDocumentLoc,as.getDocumentLoc),getSheetIndex:dr(e.getSheetIndex,as.getSheetIndex)}}function us(e){return{getDocumentLoc:dr(e.getDocumentLoc,as.getDocumentLoc),getSheetIndex:dr(e.getSheetIndex,as.getSheetIndex),getCellFormat:dr(e.getCellFormat,as.getCellFormat),getKnownFormat:dr(e.getKnownFormat,as.getKnownFormat)}}function cs(e,r,t,n){return{strongFormat:e,category:r,iformat:t,decimals:n}}var ss,ls={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(ss||(ss={}));var fs=((xc={})[Jc.INT]=ss.Propagate,xc[Jc.MOD]=ss.Propagate,xc[Jc.ROUND]=ss.Propagate,xc[Jc.SUM]=ss.Propagate,xc[Jc.TRUNC]=ss.Propagate,xc[Jc.AVERAGE]=ss.Propagate,xc[Jc.MAX]=ss.Propagate,xc[Jc.MEDIAN]=ss.Propagate,xc[Jc.MIN]=ss.Propagate,xc[Jc.ROUNDUP]=ss.Propagate,xc[Jc.ROUNDDOWN]=ss.Propagate,xc[Jc.NPV]=Bu.CoCurrencyDec,xc[Jc.PV]=Bu.CoCurrencyDec,xc[Jc.FV]=Bu.CoCurrencyDec,xc[Jc.PMT]=Bu.CoCurrencyDec,xc[Jc.RATE]=Bu.Percentage0,xc[Jc.MIRR]=Bu.Percentage0,xc[Jc.IRR]=Bu.Percentage0,xc[Jc.DATE]=Bu.MMDDYY,xc[Jc.TIME]=Bu.HHMMAP,xc[Jc.NOW]=Bu.MDYHMS,xc[Jc.SLN]=Bu.CoCurrencyDec,xc[Jc.SYD]=Bu.CoCurrencyDec,xc[Jc.DDB]=Bu.CoCurrencyDec,xc[Jc.IPMT]=Bu.CoCurrencyDec,xc[Jc.PPMT]=Bu.CoCurrencyDec,xc[Jc.TODAY]=Bu.MMDDYY,xc[Jc.VDB]=Bu.CoCurrencyDec,xc[Jc.DB]=Bu.CoCurrencyDec,xc);var ds=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],hs=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function vs(e,r,t){if(2===r.length)return t(e,Rs(e,r[0]),Rs(e,r[1]));throw new Ju(os)}function ps(e,r,t,n){var o=t.iformat,a=n.iformat,i=t.category,u=n.category,c=ls[i],s=ls[u],l=c<=s?r[c][s]:r[s][c],f=ls[l],d=n.decimals>t.decimals?n.decimals:t.decimals;switch(f){case c:return cs(!0,i,o,d);case s:return cs(!0,u,a,d);default:return e.unitlessFormat}}function gs(e,r,t){return ps(e,hs,r,t)}function ms(e,r,t){var n=r.iformat,o=t.iformat,a=r.category,i=t.category;if(n===o&&a===i&&"Time"===a)return cs(!0,a,n,0);if("Date"===a&&"Time"===i||"Time"===a&&"Date"===i){var u=e.globals.getKnownFormat(Bu.MDYHMS);if(!Qc(u))throw new Ju(u.reason);return cs(!0,u.value.category,u.value.iformat,u.value.decimals)}return ps(e,ds,r,t)}var Es=function(e){return e.unitlessFormat};function Ss(e,r,t){var n=r.iformat;return n===t.iformat?cs(!0,r.category,n,r.decimals):e.unitlessFormat}function Ts(e,r){return ls[r]===ls[e.defaultFormat.category]}var Cs=es(qc,(function(e){return Yc(Zc([e]))}),(function(e){return Yc(e)}));function Rs(e,r){switch(r.kind){case Wc.App:var t=r.head;if(t.kind===Wc.Operator)return function(e,r,t){switch(r){case Kc.Mul:case Kc.Div:return e.multOrDivTainted=!0,vs(e,t.args,gs);case Kc.Pow:return vs(e,t.args,gs);case Kc.Add:case Kc.Sub:return vs(e,t.args,ms);case Kc.Percent:if(1===t.args.length){var n=t.args[0];if(n.kind!==Wc.Literal||"number"!=typeof n.oper)return e.defaultFormat;var o=Rs(e,n);return cs(o.strongFormat,"Percentage",Bu.Percentage,o.decimals)}throw new Ju(os);case Kc.Neg:case Kc.Pos:if(1===t.args.length)return Rs(e,t.args[0]);throw new Ju(os);case Kc.Lt:case Kc.Le:case Kc.Eq:case Kc.Ge:case Kc.Gt:case Kc.Ne:return vs(e,t.args,Es);case Kc.Isect:case Kc.Union:case Kc.Range:case Kc.Concat:return vs(e,t.args,Ss);case Kc.And:case Kc.Or:case Kc.Xor:case Kc.Min:case Kc.Max:case Kc.Dot:throw new Ju(ns);default:return I("calc.analyzer.inferFormat: unexpected operator id",r)}}(e,t.id,r);if((D=t).kind===Wc.Name&&void 0===D.qualifier){var n=e.config.localeInfo.getWorksheetFuncId(t.whole.toUpperCase());if(void 0!==n){var o=dr(fs[n],ss.Ignore),a=jc(n),i=zc(r).length;if(L="calc.analyzer.inferFormulaFormat: too few args; formula should be wf.",i>=a.headTypes.length||y(L+": expected condition to be true"),0===a.restTypes.length&&(i=a.headTypes.length),n===Jc.HYPERLINK&&(e.hyperlinkTainted=!0),o===ss.Ignore)return e.defaultFormat;if(o===ss.Propagate){if(0===i)return e.defaultFormat;var u=Rs(e,r.args[0]),c=u.iformat,s=u.category,l=u.decimals,f=!Ts(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<i;h+=1){var v=Rs(e,r.args[h]),p=!Ts(e,v.category);if(!v.strongFormat&&p)return e.unitlessFormat;d||(c=v.iformat,s=v.category,l=v.decimals,d=p)}return cs(!0,s,c,l)}var g=e.globals.getKnownFormat(o);if(!Qc(g))throw new Ju(g.reason);return cs(!0,g.value.category,o,g.value.decimals)}}return Rs(e,t);case Wc.Array:return e.defaultFormat;case Wc.CellRef:var m=e.resolver.resolveCellRef(e.origin,r.qualifier,r.ref),E=Cs(r.ref,m);if(!Qc(E))throw new Ju(E.reason);var S=E.value;if(!ts(S))return e.unitlessFormat;var T=$c(S),C=e.globals.getCellFormat(T);if(!Qc(C))throw new Ju(C.reason);var R=C.value.iformat,A=C.value.category;return cs(!0,A,R,"Date"!==A&&"Time"!==A&&"Text"!==A&&"Custom"!==A&&"Special"!==A?C.value.decimals:0);case Wc.Literal:var N=Xc(r.oper);switch(N){case Hc.String:case Hc.Boolean:case Hc.Error:case Hc.Missing:return e.defaultFormat;case Hc.Number:var O=r.oper.toString(),k=O.indexOf(".");l=k>=0?O.length-k-1:0;return cs(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return I("calc.analyze.inferFormat: unexpected literal oper",N)}case Wc.Name:return e.defaultFormat;case Wc.Paren:return Rs(e,r.node);case Wc.Bad:throw new Ju(os);default:return I("calc.analyzer.inferFormat",r)}var L,D}function Is(e,r,t){try{var n=function(e,r){return{globals:us(e),config:e.config,origin:r,defaultFormat:cs(!1,"General",Bu.General,0),unitlessFormat:cs(!0,"General",Bu.General,0),resolver:rs(is(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,r),o=Rs(n,t);return C.ULS.traceTag(595948253,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+o),qc(it.__assign({},o,{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof Ju?(C.ULS.traceTag(595948254,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+e.reason),e.reason):(C.ULS.traceTag(595948255,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+g(e)),Yc((a=e,{kind:Vu.JavaScriptError,error:a})))}var a}var ys,As,Ns=Xt.SpecialPrecs,Os=Xt.precedents;function ks(e){return{findStaticPrecedents:function(e){return Os([],[],Ns.All,!1)},checkFormula:function(r,t,n,o){return Vc(e,r,t,n,void 0!==o?o:"undefined")},checkFormulaWithCodes:function(r,t,n){return function(e,r,t,n){return _c(Dc(e,r,t,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,t){return t.push({label:e.label,errorCode:r.code}),t}},!1),n).context.errorData}(e,r,t,n)},findBestFormat:function(r,t){return Is(e,r,t.node)}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(ys||(ys={})),function(e){e.RangeValues="RangeValues"}(As||(As={}));var Ls=Xt.div0ErrorOper,Ds=Xt.numErrorOper,_s=Math.pow(2,-52),Ms=Math.pow(2,-1022);function Fs(e){return Math.abs(e)<Ms?0:e}function bs(e){return isFinite(e)?Fs(e):Ds}var ws=Math.pow(2,32)-2;function Us(e,r){var t=Math.pow(e,r);return isFinite(t)?Fs(t):r<0?Ls:Ds}var Ps,Gs,xs,Bs={sqrt:function(e){return bs(Math.sqrt(e))},sqrtpi:function(e){return bs(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return bs(Math.exp(e))},power:function(e,r){return 0===r?0===e?Ds:1:0===e?r<0?Ls:0:e>0?Us(e,r):function(e){if(e<-ws||e>ws)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*_s<=r&&r<=1+2*_s}(r)?Us(e,Math.round(r)):Ds},ln:function(e){return bs(Math.log(e))},log10:function(e){return bs(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return Ds;var t=Math.log(e)/Math.log(r);return isFinite(t)?Fs(t):Ls},sin:function(e){return Math.abs(e)<Math.pow(2,27)?bs(Math.sin(e)):Ds},cos:function(e){return Math.abs(e)<Math.pow(2,27)?bs(Math.cos(e)):Ds},tan:function(e){return Math.abs(e)<Math.pow(2,27)?bs(Math.tan(e)):Ds},asin:function(e){return bs(Math.asin(e))},acos:function(e){return bs(Math.acos(e))},atan:function(e){return bs(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Ls:Fs(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(xs||(xs={}));var Vs=(Ps=ir(ur,ur)).wrap,Ws=Ps.unwrap,Hs=(Gs=ir((function(e){return-e}),(function(e){return-e}))).wrap,Ks=Gs.unwrap;function js(e){return e>0}function Js(e){return{kind:e,data:void 0,children:void 0}}function qs(e,r,t){var n=Js(xs.Array);return n.children=t,n.data={rows:e,cols:r},n}function Ys(e,r){var t=Js(xs.Fun);return t.children=r,t.data=e,t}function Xs(e,r,t){var n=Js(xs.Let);return n.children=[r,t],n.data=e,n}function Qs(e,r,t){var n=Js(xs.App);return n.children=t,n.data={funName:e,funType:r},n}function zs(e){var r=Js(xs.Ident);return r.data=e,r}function Zs(e,r,t){var n=Js(xs.If);return n.children=[e,r,t],n}function $s(e){return"object"!=typeof e||e.kind>0}function el(e,r){for(var t,n=0;n<e.length;n+=1){var o=e[n],a=r(o);void 0===t?a!==o&&(t=e.slice(0,n)).push(a):t.push(a)}return void 0!==t?t:e}function rl(e,r){return el(e,function(e){return function(r){return el(r,e)}}(r))}function tl(e,r){return r(function(e,r){if($s(e))return e;switch(e.kind){case xs.Let:var t=e.children,n=t[0],o=t[1],a=r(n),i=r(o);return n===a&&o===i?e:Xs(e.data,a,i);case xs.App:var u=el(e.children,r);return u===e.children?e:Qs(e.data.funName,e.data.funType,u);case xs.If:var c=e.children,s=c[0],l=c[1],f=c[2],d=r(s),h=r(l),v=r(f);return s===d&&l===h&&f===v?e:Zs(d,h,v);case xs.Fun:var p=r(e.children);return p===e.children?e:Ys(e.data,p);case xs.Array:var g=rl(e.children,r);return g===e.children?e:qs(e.data.rows,e.data.cols,g);case xs.Name:case xs.CellRef:case xs.Ident:return e}}(e,(function(e){return tl(e,r)})))}var nl=function(){function e(e,r,t){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var n=t.length;n<e&&y("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var o=0;o<n;o+=1){var a=t[o].length;a<r&&y("calc.common.StrictArray2D: expected elements["+o+"].length >= "+e+"; given "+a)}this.rows=e,this.cols=r,this.elements=t}return e.prototype.get=function(e,r){return O("calc.common.StrictArray2D.get",e,this.rows),O("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new ol(this.rows,this.cols,(function(t,n){return e(r.elements[t][n])}))},e}();var ol=function(){function e(e,r,t){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=t}return e.prototype.get=function(e,r){return O("calc.common.NonstrictArray2D.get",e,this.rows),O("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=al(this.rows,this.cols,this.func);return new nl(this.rows,this.cols,e)},e.prototype.map=function(r){var t=this;return new e(this.rows,this.cols,(function(e,n){return r(t.func(e,n))}))},e}();function al(e,r,t){for(var n=[],o=0;o<e;o+=1){for(var a=[],i=0;i<r;i+=1)a[i]=t(o,i);n[o]=a}return n}function il(e){return al(e.rows,e.cols,e.get.bind(e))}function ul(e,r,t){for(var n=[],o=[],a=0;a<r;a+=1)o[a]=t;for(var i=0;i<e;i+=1)n[i]=o;return n}function cl(e,r,t){return new ol(e,r,(function(e,r){return t}))}var sl,ll=qt.FormulaSource,fl=rn.ResultKind,dl=rn.isGridCell,hl=rn.ReasonKind,vl=rn.notImplemented,pl=rn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(sl||(sl={}));var gl,ml,El=it.__assign({},hl,sl);function Sl(e,r){return{config:e,mathpack:r}}function Tl(e){return{kind:El.IllFormedFormula,message:e}}function Cl(e){return{kind:gl.FinalValue,oper:e}}function Rl(e){return{kind:gl.PendingValue,anchor:e}}function Il(e,r,t){return r!==ll.Cell||dl(e.range)||y("calc.runtime.cellFormula: expected single-cell range; given "+g(e)),{kind:gl.Formula,range:e,source:r,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(gl||(gl={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(ml||(ml={}));var yl={kind:El.Stopped};function Al(e){return 0===e.length&&y("calc.runtime.unevaluated: expected nonempty array"),{kind:El.Unevaluated,anchors:e}}function Nl(e,r,t,n,o,a,i,u,c,s,l,f,d,h,v,p){return void 0===p&&(p=function(e){return Kr(vl(["getUsedRange"]))}),{config:e,mathpack:r,getDocumentLoc:function(e,r){return Xr(t(e,r))},getSheetIndex:n,getCellValue:o,getCellValues:a,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[ml.Continue],schedulerInfo:null!=v?v:{},setCellValue:s,setCellValues:l,setCellFailure:f,setDynamicPrecs:d,loadObjects:h,getUsedRange:p}}function Ol(e){return{kind:El.NameCycle,names:e}}function kl(e){return{kind:El.CellCycle,cells:e}}function Ll(e){return{kind:El.PreviousFailure,range:e}}function Dl(e){return{kind:El.JavaScriptError,error:e}}function _l(e){return{kind:fl.Paused,reason:El.Timeout,resume:e}}function Ml(e){if(e.kind===fl.Failure)return e.reason.kind}var Fl=qt.gridCell,bl=Xt.arrayOper,wl=Xt.naErrorOper,Ul=Xt.OperKind,Pl=Ul.Number|Ul.String|Ul.Boolean|Ul.Error|Ul.Rich|Ul.Array,Gl=Ul.Number|Ul.String|Ul.Boolean|Ul.Error|Ul.Blank|Ul.Rich,xl=Gl|Ul.Array;function Bl(e,r,t){var n=e+": generated Excel error, type "+r+"; "+t;C.ULS.traceTag(596120270,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,n)}function Vl(e){return"object"==typeof e&&e.kind===Ul.Error}function Wl(e){return"object"==typeof e&&e.kind===Ul.Blank}function Hl(e){return"object"==typeof e&&e.kind===Ul.Array}function Kl(e){return e.kind===wr.Success?e.value:void 0}function jl(e,r){switch(e.kind){case wr.Success:return Hr(Cl(e.value));case wr.Failure:return Kr(Ll(r))}}function Jl(e,r,t){var n=Hl(t)?function(e,r,t,n,o,a){if(e===t&&r===n)return o;if(1===e&&1===r)return ul(t,n,void 0===o[0]?a:o[0][0]);var i,u=[];i=1===e?function(e,t){return t<r?o[0][t]:a}:1===r?function(r,t){return r<e?o[r][0]:a}:function(t,n){return t<e&&n<r?o[t][n]:a};for(var c=0;c<t;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=i(c,s)}return u}(t.rows,t.cols,e,r,t.opers,wl):ul(e,r,t);return bl(e,r,n)}function ql(e,r){var t=e.row,n=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols,l=vr(t,i),f=vr(n,u);return F(l,f,pr(t+o,i+c)-l,pr(n+a,u+s)-f)}function Yl(e){return 0===e.length&&y("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(ql)}function Xl(e,r){var t=e.row,n=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols,l=pr(t,i),f=pr(n,u),d=vr(t+o,i+c)-l,h=vr(n+a,u+s)-f;if(!(d<=0||h<=0))return F(l,f,d,h)}function Ql(e){return e.rows*e.cols}var zl,Zl=zt.NodeKind,$l=rn.getArguments,ef=Xt.arrayOper,rf=$t.WorksheetFuncId,tf=rn.success,nf=(zl=0,function(){var e=zl;return zl+=1,e});function of(e){return"object"!=typeof e||$s(e)&&("object"!=typeof(r=e)||r.kind===Ul.Error||r.kind===Ul.Array||r.kind===Ul.Rich);var r}function af(e,r,t){var n=$l(t).map((function(t){return uf(e,r,t)})),o=$t.getWorksheetFuncType(rf._UDF);return Qs(Hs(rf._UDF),o,[uf(e,r,t.head)].concat(n))}function uf(e,r,t){switch(t.kind){case Zl.Array:var n=t.nodes.map((function(t){return t.map((function(t){return uf(e,r,t)}))}));return m=(p=n).length,E=void 0===p[0]?0:p[0].length,p.every((function(e){return e.every(of)}))?ef(m,E,p):qs(m,E,p);case Zl.App:var o=t.head;if(o.kind===Zl.Operator){var a=$l(t).map((function(t){return uf(e,r,t)})),i=$t.getOperatorType(o.id);return Qs(Vs(o.id),i,a)}if(o.kind===Zl.Name&&null==o.qualifier)if(null!=(c=e.config.localeInfo.getWorksheetFuncId(o.whole.toLocaleUpperCase()))){var u=void 0;switch(c){case rf.LET:u=function(e,r,t){if(3===t.args.length){var n=t.args[0];if(n.kind===Zl.Name&&null==n.qualifier){var o=n.whole,a=nf(),i=sr(r);return i[o]=a,Xs(a,uf(e,r,t.args[1]),uf(e,i,t.args[2]))}}}(e,r,t);break;case rf.FUN:u=function(e,r,t){var n=t.args.slice(0,t.args.length-1);if(n.length>0&&n.every((function(e){return e.kind===Zl.Name&&null==e.qualifier}))){for(var o=n.map((function(e){return e.whole})),a=o.map(nf),i=sr(r),u=0;u<o.length;u+=1)i[o[u]]=a[u];return Ys(a,uf(e,i,t.args[n.length-1]))}}(e,r,t);break;case rf.IF:u=function(e,r,t){var n=t.args;return 3===n.length?Zs(uf(e,r,n[0]),uf(e,r,n[1]),uf(e,r,n[2])):2===n.length?Zs(uf(e,r,n[0]),uf(e,r,n[1]),!1):void 0}(e,r,t);break;default:a=$l(t).map((function(t){return uf(e,r,t)})),i=$t.getWorksheetFuncType(c);u=Qs(Hs(c),i,a)}return void 0===u?af(e,r,t):u}return af(e,r,t);case Zl.Paren:return uf(e,r,t.node);case Zl.Name:var c;if(null==t.qualifier)if(void 0!==(c=r[t.whole]))return zs(c);return f=t.whole,d=t.whole.split("."),h=t.qualifier,(v=Js(xs.Name)).data={whole:f.toLocaleUpperCase(),split:d.map((function(e){return e.toLocaleUpperCase()})),qualifier:h},v;case Zl.CellRef:return function(e,r){var t=Js(xs.CellRef);return t.data={ref:e,qualifier:r},t}(t.ref,t.qualifier);case Zl.Literal:return t.oper;case Zl.Bad:var s="calc.runtime.compile: unexpected bad node "+g(t);return C.ULS.assertTag(595980820,l.LogCategory.msoulscat_ES_EWAJS,!1,s);default:return I("calc.runtime.compile",t)}var f,d,h,v,p,m,E}var cf=function(e){if(!$s(e)&&e.kind===xs.App&&!js(e.data.funName)){var r=Ks(e.data.funName);if(r===rf.IFERROR||r===rf.IFNA){var t=nf(),n=zs(t),o=r===rf.IFERROR?rf.ISERROR:rf.ISNA,a=$t.getWorksheetFuncType(o),i=Zs(Qs(Hs(o),a,[n]),e.children[1],n);return Xs(t,e.children[0],i)}}return e};var sf,lf="__compiledFormulaBrand__";function ff(e,r){return function(e){return e.kind===lf}(r)?r.term:I(e+": expected known compiled formula type; given "+g(r),r)}function df(e,r,t,n){var o=uf(e,cr(),n.node),a=tl(o,cf);return tf(function(e){return{kind:lf,term:e}}(a))}function hf(e){return{compileFormula:function(r,t,n){return df(e,0,0,n)}}}function vf(e,r){return 0==(e&r)}function pf(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(sf||(sf={}));var gf={kind:sf.Empty};function mf(e){return e===gf}function Ef(e,r){return{kind:sf.Lf,key:e,value:r}}function Sf(e,r,t,n){return{kind:sf.Br,prefix:e,mask:r,l:t,r:n}}function Tf(e,r,t,n){var o=function(e,r){return t=e^r,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)^t>>>1;var t}(e,t),a=pf(e,o),i=vf(e,o);return Sf(a,o,i?r:n,i?n:r)}var Cf,Rf=gf,If=function e(r,t,n){switch(n.kind){case sf.Empty:return Ef(r,t);case sf.Lf:var o=Ef(r,t);return n.key===r?o:Tf(r,o,n.key,n);case sf.Br:return function(e,r,t){return pf(e,t)===r}(r,n.prefix,n.mask)?vf(r,n.mask)?Sf(n.prefix,n.mask,e(r,t,n.l),n.r):Sf(n.prefix,n.mask,n.l,e(r,t,n.r)):Tf(r,Ef(r,t),n.prefix,n)}},yf=function(e,r){for(var t=r;t.kind===sf.Br;)t=vf(e,t.mask)?t.l:t.r;if(!mf(t))return e===t.key?t.value:void 0},Af=qt.FormulaSource,Nf=rn.isSheetGridCell,Of=Yr;function kf(e){throw new Of(e)}function Lf(e,r,t,n){return{range:e,source:r,precedents:t,visitedCellMap:n}}function Df(e,r,t,n){if(r===Af.Cell){if(Nf(e))return Lf(e,r,t,n);y("calc.runtime.evalLocals: expected single-cell range; given "+g(e))}return Lf(e,r,t,n)}!function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(Cf||(Cf={}));var _f={kind:Cf.Default},Mf=function(){function e(e){this.context=e,this.latestTransition=Cf.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=Cf.Default,_f},e.prototype.performDependencyTransition=function(e){return this.latestTransition=Cf.Dependency,{kind:Cf.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=Cf.Call,{kind:Cf.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=Cf.Write,{kind:Cf.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=Cf.Return,{kind:Cf.Return,result:e}},e}(),Ff={newVisitedMap:wf,visit:function(e,r,t){return Uf(Vf,e,r,t)},unVisit:function(e,r,t){return Pf(Vf,e,r,t)},lookup:function(e,r){return Gf(Vf,e,r)},runFrom:function(e,r){return xf(Vf,e,r)}},bf={newVisitedMap:wf,visit:function(e,r,t){return Uf(Wf,e,r,t)},unVisit:function(e,r,t){return Pf(Wf,e,r,t)},lookup:function(e,r){return Gf(Wf,e,r)},runFrom:function(e,r){return xf(Wf,e,r)}};function wf(){return{run:[],visited:cr()}}function Uf(e,r,t,n){var o=e(r);n.visited[o]=t,n.run.push([o,r])}function Pf(e,r,t,n){var o=e(r);n.visited[o]=t,n.run.pop()}function Gf(e,r,t){return t.visited[e(r)]}function xf(e,r,t){for(var n=[],o=t.run,a=0;a<o.length;){var i=o[a][0];if(e(r)===i)break;a+=1}for(;a<o.length;)n.push(o[a][1]),a+=1;return n}function Bf(e){var r=e.document,t=e.index,n="$";return null!=r.path&&(n+=r.path),n+=";",n+=r.name,n+=";",null!=t&&(n+=t,n+=";"),n}function Vf(e){var r=Bf(e.scope);return r+=";",r+=e.name}function Wf(e){var r=Bf(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var Hf=Xt.SpecialPrecs,Kf=Xt.precedents,jf=Xt.OperKind,Jf=rn.failure,qf=rn.sheetGridRangeAnchor,Yf=rn.success,Xf=rn.ResultKind,Qf=function(e){function r(r,t){var n=e.call(this,r)||this;return n.cell=t,n.locals=void 0,n}return it.__extends(r,e),r.prototype.getRealReason=function(e){if(e.kind!==El.PreviousFailure)return e;var r=qf(e.range),t=bf.lookup(r,this.context.visitedCellMap);return"object"==typeof t&&t.kind===Xf.Failure?t.reason:e},r.prototype.visitAnchor=function(e){var r=qf(e.range),t=bf.lookup(r,this.context.visitedCellMap);if(null!=t){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+g(r)+"; given "+g(t));return C.ULS.assertTag(595980812,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}bf.visit(r,gl.PendingValue,this.context.visitedCellMap);var o=Kf([],[],Hf.None,!0);return this.locals=Df(e.range,e.source,o,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var t=qf(r.range);return bf.unVisit(t,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Xf.Failure)return this.performReturnTransition(Jf(this.getRealReason(e.reason)));var r=e.value;if(r.kind===gl.FinalValue)return this.performReturnTransition(Yf(r.oper));var t=this.context.globals.getCellFormula(r.anchor);if(t.kind===Xf.Failure){var n="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return C.ULS.assertTag(595980813,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var o=t.value;if(null==o){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+g(r.anchor)+") != null");return C.ULS.assertTag(595980814,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=this.visitAnchor(o),i=this.context.createFormulaEvaluationMachine(this.context,a,o.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===jf.Range||r.kind===jf.Missing)){var t="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+g(r));return C.ULS.assertTag(595980815,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var n=this.unVisitAnchor(void 0);if(null==n){t="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return C.ULS.assertTag(595980816,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}return this.performWriteTransition(e,n)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===El.Unevaluated){var t="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+g(r));return C.ULS.assertTag(595980817,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var n=r===e.reason?e:Jf(r),o=this.unVisitAnchor(n);if(null==o){t="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return C.ULS.assertTag(595980818,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}return this.performWriteTransition(n,o)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(Mf);function zf(e,r){return new Qf(e,r)}function Zf(e,r){for(var t=Ih(e),n=[],o=0;o<r.length;o+=1)n.push(zf(t.machineContext,r[o]));return new Nh(t,n)}var $f=qt.FormulaSource,ed=qt.sheetGridCell,rd=qt.sheetGridRange,td=Xt.OperKind,nd=Xt.ErrorType,od=Xt.refErrorOper,ad=Xt.valueErrorOper,id=Xt.arrayOper,ud=rn.ResultKind,cd=rn.isGridCell,sd=rn.isSheetIndex,ld=rn.getArgType;function fd(e,r){if(bf.lookup(e,r.visitedCellMap)===gl.PendingValue)return kf(kl(bf.runFrom(e,r.visitedCellMap)))}function dd(e,r,t,n){r.precedents.cells.push(t);var o=e.getCellValue(t);if(o.kind===ud.Failure)return kf(o.reason);var a=o.value;if(a.kind===gl.FinalValue)return a.oper;fd(a.anchor,r),n.push(a.anchor)}function hd(e,r,t,n){r.precedents.cells.push(t);var o=e.getCellValues(t);if(o.kind===ud.Failure)return kf(o.reason);var a=n.length,i=function(e,r,t){for(var n=[],o=r.length,a=0,i=0;i<o;i+=1){n.push([]);var u=r[i].length;a=0===a?u:Math.min(u,a);for(var c=0;c<u;c+=1){var s=r[i][c];gl.FinalValue===s.kind?n[i][c]=s.oper:(fd(s.anchor,e),t.push(s.anchor),n[i][c]=od)}}return new nl(o,a,n)}(r,o.value,n);return a===n.length?i:void 0}function vd(e,r,t,n){var o=hd(e,r,t,n);if(null!=o)return id(o.rows,o.cols,il(o.map((function(e){return Wl(e)?0:e}))))}function pd(e,r,t,n,o){if(0!=(n&td.Range))return t;if("object"!=typeof t||t.kind!==td.Range)return t;var a=t.sheets;if(!sd(a))return Bl("calc.runtime.dereference",nd.REF,"3D range, oper = "+g(t)),od;if(1!==t.ranges.length)return Bl("calc.runtime.dereference",nd.VALUE,"union range, oper = "+g(t)),ad;var i=t.ranges[0];if(0!=(n&Gl)){if(cd(i))return dd(e,r,ed(a,i),o);if(r.source===$f.Cell&&!dt(at.CalcSupportDynamicArrays)&&!dt(at.CalcPreventSpillingHack)){var u=function(e,r){var t=e.row,n=e.col,o=r.row,a=r.col,i=r.rows,u=r.cols,c=o<=t&&t<o+i,s=a<=n&&n<a+u;return c&&s?Fl(t,n):c&&1===u?Fl(t,a):s&&1===i?Fl(o,n):void 0}(r.range.range,i);return null==u?(Bl("calc.runtime.dereference",nd.VALUE,"empty intersection, oper = "+g(t)),ad):dd(e,r,ed(a,u),o)}return vd(e,r,rd(a,i),o)}return 0!=(n&td.Array)?vd(e,r,rd(a,i),o):(Bl("calc.runtime.dereference",nd.VALUE,"bad target type "+n),ad)}function gd(e,r,t,n){for(var o=[],a=0;a<t.length;a+=1){var i=pd(e,r,t[a],ld(n,a),o);null!=i&&(t[a]=i)}if(o.length>0)return kf(Al(o))}var md=Xt.OperKind,Ed=Xt.valueErrorOper,Sd=Xt.arrayOper,Td=rn.operKind,Cd=rn.notImplemented,Rd=[Ed,0,"",!1,!1],Id=md.Number|md.String|md.Boolean;function yd(e){var r=e&Id;return Rd[r&-r]}function Ad(e,r,t){var n=function e(r,t,n){if("number"==typeof t)return 0!=(n&md.Number)?t:0!=(n&md.String)?r.formatNumber(t):0!=(n&md.Boolean)?0!==t:0!=(n&md.Array)?Sd(1,1,[[t]]):Ed;if("string"==typeof t){if(0!=(n&md.String))return t;if(0!=(n&md.Number)){if(0===t.length)return Ed;var o=r.parseNumber(t);if(Wr(o))return o;throw new Of(Cd(["string -> number coercion: "+g(zt.literalNode(t))]))}return 0!=(n&md.Boolean)?0===r.stringCompareCI(t,r.trueName)||0!==r.stringCompareCI(t,r.falseName)&&Ed:Ed}if("boolean"==typeof t)return 0!=(n&md.Boolean)?t:0!=(n&md.Number)?t?1:0:0!=(n&md.String)?t?r.trueName:r.falseName:Ed;if(0!=(n&t.kind))return t;switch(t.kind){case md.Error:return t;case md.Missing:return 0!=(n&md.Blank)?Xt.blankOper:yd(n);case md.Blank:return yd(n);case md.Rich:return e(r,t.getFallback(),n);default:return Ed}}(e.config.localeInfo,r,t);return Vl(n)&&!Vl(r)&&Bl("calc.runtime.coerceOper",n.type,"kind = "+Td(r)),n}var Nd=qt.sheetIndex,Od=Xt.OperKind,kd=Xt.rangeSeqOper,Ld=Xt.ErrorType,Dd=Xt.valueErrorOper,_d=Xt.div0ErrorOper,Md=Xt.nullErrorOper,Fd=$t.OperatorId,bd=rn.operKind,wd=rn.isSheetIndex,Ud=rn.isDocumentLocEqual;function Pd(e,r){switch(e){case Fd.Eq:return 0===r;case Fd.Ne:return 0!==r;case Fd.Lt:return r<0;case Fd.Gt:return r>0;case Fd.Le:return r<=0;case Fd.Ge:return r>=0}}function Gd(e,r,t){return Pd(e,r-t)}function xd(e,r,t){return Pd(e,r.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase()))}function Bd(e,r,t){return Pd(e,r<t?-1:r>t?1:0)}function Vd(e,r,t){if(wd(r.sheets))if(wd(t.sheets))if(Ud(r.sheets.document,t.sheets.document)){if(r.sheets.index===t.sheets.index)return Nd(r.sheets.document,r.sheets.index);n="different sheet, range1 = "+g(r)+", range2 = "+g(t);Bl(e,Ld.VALUE,n)}else{var n="different document, range1 = "+g(r)+", range2 = "+g(t);Bl(e,Ld.VALUE,n)}else Bl(e,Ld.VALUE,"3D reference, range2 = "+g(t));else Bl(e,Ld.VALUE,"3D reference, range1 = "+g(r))}function Wd(e,r,t){if(1===t.length){var n=t[0];switch(r){case Fd.Percent:return Fs(n/100);case Fd.Neg:return-n;case Fd.Pos:return n;default:var o="bad application of "+r+" to 1 argument";return Bl("calc.runtime.applyOperator",Ld.VALUE,o),Dd}}if(2===t.length){n=t[0];var a=t[1];switch(r){case Fd.Add:return bs(n+a);case Fd.Sub:return bs(n-a);case Fd.Mul:return bs(n*a);case Fd.Div:return 0===a?(Bl("calc.runtime.applyOperator",Ld.DIV0,"division by zero"),_d):bs(n/a);case Fd.Pow:return e.mathpack.power(n,a);case Fd.Concat:return n+a;case Fd.Eq:case Fd.Ne:case Fd.Lt:case Fd.Le:case Fd.Gt:case Fd.Ge:return function(e,r,t){var n=bd(r),o=bd(t);if(n!==o){if(n===Od.Blank)switch(o){case Od.Number:return Bd(e,0,t);case Od.String:return xd(e,"",t);case Od.Boolean:return Gd(e,!1,t)}if(o===Od.Blank)switch(n){case Od.Number:return Bd(e,r,0);case Od.String:return xd(e,r,"");case Od.Boolean:return Gd(e,r,!1)}return Pd(e,n-o)}switch(n){case Od.Number:return Bd(e,r,t);case Od.String:return xd(e,r,t);case Od.Boolean:return Gd(e,r,t);case Od.Blank:return Pd(e,0);default:return!1}}(r,n,a);case Fd.Range:return function(e,r){var t=Vd("calc.runtime.applyRangeOp",e,r);if(null==t)return Dd;var n=[ql(Yl(e.ranges),Yl(r.ranges))];return kd(t,n)}(n,a);case Fd.Isect:return function(e,r){var t=Vd("calc.runtime.applyIsectOp",e,r);if(null==t)return Dd;for(var n=[],o=0;o<e.ranges.length;o+=1)for(var a=0;a<r.ranges.length;a+=1){var i=Xl(e.ranges[o],r.ranges[a]);null!=i&&n.push(i)}if(0===n.length){var u="empty intersection, range1 = "+g(e)+", range2 = "+g(r);return Bl("calc.runtime.applyIsectOp",Ld.NULL,u),Md}return kd(t,n)}(n,a);case Fd.Union:return null==(s=Vd("calc.runtime.applyUnionOp",u=n,c=a))?Dd:kd(s,u.ranges.concat(c.ranges));case Fd.And:return n&&a;case Fd.Or:return n||a;case Fd.Xor:return n!==a;case Fd.Min:return Math.min(n,a);case Fd.Max:return Math.max(n,a);default:var i="bad application of "+r+" to 2 arguments";return Bl("calc.runtime.applyOperator",Ld.VALUE,i),Dd}}var u,c,s,l="bad application of "+r+" to "+t.length+" arguments";return Bl("calc.runtime.applyOperator",Ld.VALUE,l),Dd}var Hd=qt.sheetIndex,Kd=qt.sheetGridRange,jd=Xt.arrayOper,Jd=Xt.nameErrorOper,qd=Xt.naErrorOper,Yd=Xt.numErrorOper,Xd=Xt.valueErrorOper,Qd=Xt.OperKind,zd=Xt.ErrorType,Zd=Xt.SpecialPrecs,$d=$t.functionType,eh=$t.FunctionFlags,rh=$t.SignatureType,th=$t.WorksheetFuncId,nh=$t.getOperatorType,oh=$t.getWorksheetFuncType,ah=rn.operKind,ih=rn.ResultKind,uh=rn.success,ch=rn.getArgType,sh=rn.isValidArgsLength,lh=Qd.Number|Qd.String|Qd.Boolean|Qd.Rich|Qd.Error|Qd.Blank,fh=$d(3,[Qd.Boolean,lh,lh],[],rh.All,Zd.None,eh.None),dh=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var t=oh(e),n=r.some((function(e){return"object"==typeof e&&e.kind===Qd.Range}))?r.slice(0):r;return gd(this.globals,this.locals,n,t),this.runFunctionToCompletion(Hs(e),t,n)},e.prototype.applyOperatorOrFunction=function(e,r){if(js(e))return Wd(this.globals,Ws(e),r);var t=Ks(e);if(t===th._UDF)return kf(vl(["call UDF"]));var n=this.globals.getFirstOrderFunc(t);if(n.kind===ih.Failure)return kf(n.reason);var o=n.value;if(null==o){var a="nonexistent worksheet function "+t;return Bl("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",zd.NAME,a),Jd}var i=o(this,r);if("object"==typeof i&&i.kind===Qd.Error){a="worksheet function "+t+" return value";Bl("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,a)}return i},e.prototype.arrayLift=function(e,r,t){for(var n=this,o=0,a=0,i=0;i<t.length;i+=1){var u=t[i];Hl(u)&&0==(ch(e,i)&Qd.Array)?(o=Math.max(o,u.rows),a=Math.max(a,u.cols)):(o=Math.max(o,1),a=Math.max(a,1))}var c=t.map((function(r,t){return n.broadcastOper(o,a,r,ch(e,t))})),s=new ol(o,a,(function(e,t){return r(c.map((function(r){return r.get(e,t)})))})).map((function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===ys.WorksheetFunction?n.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case Qd.Range:return Xd;case Qd.Missing:case Qd.Blank:return 0;default:return r}}));return jd(s.rows,s.cols,il(s))},e.prototype.dispatchFunction=function(e,r,t){var n=this;if(!sh(r,t.length)){var o=JSON.stringify(r),a="bad application of "+JSON.stringify(e)+" to "+t.length+" arguments, ftype = "+o;return Bl("calc.runtime.FunctionDispatcher.dispatchFunction",zd.NUM,a),Yd}for(var i=t.length,u=rh.None,c=0;c<i;c+=1){var s=ah(t[c]);0==(s&ch(r,c))&&(u|=s)}if(u===rh.None)return this.applyOperatorOrFunction(e,t);if(0!=(u&Qd.Array)){return this.arrayLift(r,(function(t){return n.dispatchFunction(e,r,t)}),t)}u&=~Qd.Array;var l=[];for(c=0;c<i;c+=1){var f=t[c];if(0!=(u&ah(f))){var d=ch(r,c);if(f=this.coerceOper(f,d),ah(f)===Qd.Error&&0==(d&Qd.Error))return f}l[c]=f}return this.applyOperatorOrFunction(e,l)},e.prototype.dispatchStrictIf=function(e){var r=this,t=e[0];if("object"!=typeof t){var n=this.coerceOper(t,Qd.Boolean);return!0===n?e[1]:!1===n?e[2]:n}switch(t.kind){case Qd.Error:return t;case Qd.Missing:case Qd.Blank:return e[2];case Qd.Array:return this.arrayLift(fh,(function(e){return r.dispatchStrictIf(e)}),e);case Qd.Rich:return kf(vl(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case Qd.Range:var o="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+g(t));return C.ULS.assertTag(595980809,l.LogCategory.msoulscat_ES_EWAJS,!1,o);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",t)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,t,n){var o=[],a=pd(e,r,t,n,o);if(null==a){if(o.length>0)return kf(Al(o));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+g(t);return C.ULS.assertTag(595980819,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){gd(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],t=[],n=0;n<e.length;n+=1){var o=e[n];if("object"==typeof o&&o.kind===Qd.Range){for(var a=[],i=o.sheets,u=i.index,c=i.length,s=0;s<c;s+=1)for(var l=Hd(o.sheets.document,s+u),f=0;f<o.ranges.length;f+=1){var d=Kd(l,o.ranges[f]),h=hd(this.globals,this.locals,d,r);null!=h&&a.push(h)}t.push({kind:As.RangeValues,arrays:a})}else t.push(o)}return r.length>0?kf(Al(r)):t},e.prototype.makeOperatorReducer=function(e,r){var t=this.getBinaryOperator(e);return function(e,n){return void 0===e?null!=r?r(n):n:t(e,n)}},e.prototype.makeBranchOperatorReducer=function(e,r){var t=this;return function(n,o){var a=t.makeOperatorReducer(e,r)(n,o);return void 0!==n&&!0===a?n:o}},e.prototype.reduceDerefOpers=function(e,r,t){function n(t,n){if(Hl(n))return o(t,new nl(n.rows,n.cols,n.opers));var a=r(n);return null==a?t:e(t,a)}function o(e,r){for(var t=e,o=0;o<r.rows;o+=1)for(var a=0;a<r.cols;a+=1)t=n(t,r.get(o,a));return t}return t.reduce((function(e,r){return"object"==typeof r&&r.kind===As.RangeValues?r.arrays.reduce(o,e):n(e,r)}),void 0)},e.prototype.broadcastOper=function(e,r,t,n){if("object"!=typeof t)return cl(e,r,t);switch(t.kind){case Qd.Missing:case Qd.Blank:return cl(e,r,0);case Qd.Array:return 0!=(n&Qd.Array)?cl(e,r,t):function(e,r,t,n){return t.rows===e&&t.cols===r?t:1===t.rows&&1===t.cols?cl(e,r,t.get(0,0)):1===t.rows?new ol(e,r,(function(e,r){return r<t.cols?t.get(0,r):n})):1===t.cols?new ol(e,r,(function(e,r){return e<t.rows?t.get(e,0):n})):new ol(e,r,(function(e,r){return e<t.rows&&r<t.cols?t.get(e,r):n}))}(e,r,new nl(t.rows,t.cols,t.opers),qd);case Qd.Range:default:return cl(e,r,t)}},e.prototype.coerceOper=function(e,r){return Ad(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,t=nh(e),n=[0,0];return function(o,a){return n[0]=o,n[1]=a,gd(r.globals,r.locals,n,t),r.runFunctionToCompletion(Vs(e),t,n)}},e.prototype.getUnaryOperator=function(e){var r=this,t=nh(e),n=[0];return function(o){return n[0]=o,gd(r.globals,r.locals,n,t),r.runFunctionToCompletion(Vs(e),t,n)}},e.prototype.runFunctionToCompletion=function(e,r,t){var n=this.dispatchFunction(e,r,t);return"object"==typeof n&&n.kind===ys.WorksheetFunction?this.runFunctionMachineToCompletion(n):n},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),hh=function(e){function r(r,t){var n=e.call(this,r)||this;return n.func=t,n}return it.__extends(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(uh(e))},r.prototype.receiveSuccess=function(e){return C.ULS.assertTag(595980810,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case El.Unevaluated:for(var t=[],n=r.anchors,o=n.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,n[o]);t.push(a)}return this.performDependencyTransition(t);default:return this.performReturnTransition(e)}},r}(Mf);function vh(e,r){return new hh(e,r)}var ph=qt.FormulaSource,gh=Xt.naErrorOper,mh=rn.failure,Eh=rn.ResultKind,Sh=rn.createResolver;function Th(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Ch(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var Rh={kind:El.Timeout};function Ih(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:yh(e)}}function yh(e){return{globals:e,visitedCellMap:bf.newVisitedMap(),resolver:Sh(e),createCellEvaluationMachine:zf,createFormulaEvaluationMachine:ev,createFunctionEvaluationMachine:vh}}var Ah,Nh=function(){function e(e,r){N("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===ml.Stop)return this.generatePartialResults(),C.ULS.traceTag(595953880,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var t=this.evaluate(Ch(e));return t instanceof Array?(C.ULS.traceTag(595953881,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(t)):(C.ULS.traceTag(595953882,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise((function(t){return e.scheduleFunction((function(){return C.ULS.traceTag(595964228,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),t(r.evaluateAsync(e))}))})))}catch(e){return Promise.reject(mh(e))}},e.prototype.evaluateSync=function(e){var r=this,t=function(n){if(r.context.globals.interruptToken[0]===ml.Stop||r.context.timer.doTimeout(e.endTimeMs))return r.generatePartialResults(),r.results;var o=r.evaluate(n);return o instanceof Array?o:_l((function(r){return t(void 0!==r?r:Ch(e))}))};return t(Ch(e))},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return Rh;var r=this.evaluationStack[this.evaluationStack.length-1],t=this.evaluateMachine(r);switch(this.currentResult=void 0,t.kind){case Cf.Default:break;case Cf.Dependency:for(var n=0;n<t.machines.length;n+=1)this.evaluationStack.push(t.machines[n]);break;case Cf.Call:this.evaluationStack.push(t.machine);break;case Cf.Return:case Cf.Write:this.performResultTransition(t);break;case El.JavaScriptError:this.stopEvaluatingWithJavaScriptError(t);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",t)}}}catch(e){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return C.ULS.assertTag(595980807,l.LogCategory.msoulscat_ES_EWAJS,!1,o)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===Eh.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Of))return Dl(e);this.currentResult=mh(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Dl(e)}},e.prototype.performResultTransition=function(e){if(e.kind===Cf.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Dl(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===Eh.Success){(t=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Cf.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var t;if((t=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Cf.Dependency)break;if(t.latestTransition===Cf.Call){this.currentResult=e.result;break}var n=this.evaluationStack.pop();null!=n&&n.cleanup()}if(0===this.evaluationStack.length){var o="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+g(e.result));return C.ULS.assertTag(595980808,l.LogCategory.msoulscat_ES_EWAJS,!1,o)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case Eh.Success:this.setFormulaValue(e,r.value);break;case Eh.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var t=Wl(r)?0:r;if(e.source===ph.Cell){if(Hl(t)){var n=void 0===t.opers[0]?gh:t.opers[0][0];return this.context.globals.setCellValue(e.range,n)}return this.context.globals.setCellValue(e.range,t)}var o=e.range.range,a=Jl(o.rows,o.cols,t).opers;return this.context.globals.setCellValues(e.range,a)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(mh(yl))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(mh(e))},e}(),Oh=qt.documentScope,kh=qt.nameLoc,Lh=qt.sheetIndex,Dh=qt.sheetRange,_h=qt.gridCell,Mh=qt.FormulaSource,Fh=zt.documentQualifier,bh=zt.QualifierKind,wh=zt.PosKind,Uh=zt.CellRefKind,Ph=Xt.ErrorType,Gh=Xt.nameErrorOper,xh=Xt.refErrorOper,Bh=Xt.OperKind,Vh=Xt.arrayOper,Wh=Xt.range3DOper,Hh=Xt.rangeSeqOper,Kh=rn.gridCellRange,jh=rn.ResultKind,Jh=rn.success,qh=rn.failure,Yh=rn.sheetGridRangeAnchor,Xh=rn.createResolutionHandler,Qh=rn.createNameFinder,zh=[void 0,Gh],Zh=Rf;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(Ah||(Ah={}));var $h=function(e){function r(r,t,n){var o=e.call(this,r)||this;return o.nameEvaluator=Xh(Qh((function(e){var r=o.getNameFormulaAsTerm(o.locals,e);return void 0!==r&&o.checkForNameCycle(e,o.visitedNameMap),r}),zh),(function(e){var r="name resolution; qualifier = "+g(e);return Bl("calc.runtime.FormulaEvaluationMachine.evalName",Ph.NAME,r),zh}),kf),o.cellEvaluator=Xh((function(e){return Wh(e.sheet,e.range)}),(function(e){var r="error ref, qualifier = "+g(e.data.qualifier);return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,r),xh}),kf),o.term=ff("calc.runtime.FormulaEvaluationMachine",n),o.locals=t,o.continuation=[],o.env=Zh,o.visitedNameMap=Ff.newVisitedMap(),o.dispatcher=new dh(o.context.globals,t),o}return it.__extends(r,e),r.prototype.next=function(){if($s(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,xl),t=this.dispatcher.coerceOper(r,xl);return dt(at.CalcPreventSpillingHack)&&this.locals.source===Mh.Cell&&Hl(t)&&(1!==t.rows||1!==t.cols)?this.performReturnTransition(qh(vl(["spilling"]))):this.performReturnTransition(Jh(t))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case El.Unevaluated:for(var t=[],n=r.anchors,o=n.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,n[o]);t.push(a)}return this.performDependencyTransition(t);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var t=r.context;switch(t.kind){case xs.App:var n=r.holeIndex,o=t.children.length;if((c=r.locals)[n]=e,n+1<o)return this.nextHoleTransition(r,t.children[n+1]);var a=t.data.funName,i=t.data.funType;this.dispatcher.dereferenceOpers(c,i);var u=this.dispatcher.dispatchFunction(a,i,c);return"object"==typeof u&&u.kind===ys.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case xs.If:var c;if(0===(n=r.holeIndex)){var s=this.dispatcher.dereferenceOper(e,Bh.Boolean);if("object"!=typeof s){var f=this.dispatcher.coerceOper(s,Bh.Boolean),d=!0===f?t.children[1]:!1===f?t.children[2]:f;return this.popContextTransition(r.env,d)}switch(s.kind){case Bh.Error:return this.popContextTransition(r.env,s);case Bh.Missing:case Bh.Blank:return this.popContextTransition(r.env,t.children[2]);case Bh.Array:return r.locals=[s],this.nextHoleTransition(r,t.children[n+1]);case Bh.Rich:return this.performReturnTransition(qh(vl(["IF with a rich value condition"])));case Bh.Range:var h="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+g(s));return C.ULS.assertTag(595980811,l.LogCategory.msoulscat_ES_EWAJS,!1,h);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",s)}}if((c=r.locals)[n]=e,1===n)return this.nextHoleTransition(r,t.children[n+1]);this.dispatcher.dereferenceOpers(c,fh);var v=this.dispatcher.dispatchStrictIf(c);return this.popContextTransition(r.env,v);case xs.Name:var p=r.locals;return Ff.unVisit(p,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case xs.Let:var m=t.data,E=e,S=r.env;return this.popContextTransition(If(m,E,S),t.children[1]);case xs.Array:var T=this.dispatcher.dereferenceOper(e,Pl),R=t.data,y=R.rows,A=R.cols,N=r.holeIndex,O=N%A,k=A===O+1,L=(N-O)/A,D=r.locals;if(D[L][O]=this.dispatcher.coerceOper(T,Pl),y===L+1&&k)return this.popContextTransition(r.env,Vh(y,A,D));var _=k?L+1:L,M=k?0:O+1;return this.nextHoleTransition(r,t.children[_][M]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",t)}},r.prototype.reduceFormula=function(e){switch(e.kind){case xs.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case xs.App:var r=e.data.funName;if(!js(r)){var t=this.context.globals.getFirstOrderFunc(Ks(r));if(t.kind===jh.Failure)return kf(t.reason)}if(0===e.children.length){var n=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof n&&n.kind===ys.WorksheetFunction?this.evaluateFunctionTransition(n,void 0):this.updateTermTransition(n)}return this.pushContextTransition(e,e.children[0],[]);case xs.If:case xs.Let:return this.pushContextTransition(e,e.children[0],void 0);case xs.Name:var o=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==o[0]?this.pushContextTransition(e,o[1],o[0]):this.updateTermTransition(o[1]);case xs.Ident:var a=yf(e.data,this.env);if(null==a){var i="undefined local "+e.data;Bl("calc.runtime.FormulaEvaluationMachine.reduceFormula",Ph.NAME,i)}return this.updateTermTransition(void 0===a?Gh:a);case xs.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case xs.Fun:return this.performReturnTransition(qh(vl(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,t){var n=function(e,r,t){return{context:e,holeIndex:0,env:r,locals:t}}(e,this.env,t);return this.continuation[this.continuation.length]=n,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var t=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(t)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:Ah.Document},r.prototype.getSheetIndex=function(e,r){var t=this.context.globals.getSheetIndex(e,r);return t.kind===jh.Failure?kf(t.reason):null==t.value?void 0:t.value},r.prototype.evalSheetQualifier=function(e,r){var t=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof t)return t;var n=this.getSheetIndex(t,r.sheet);return null==n?Ah.Sheet:Lh(t,n)},r.prototype.evalNameQualifier=function(e,r){var t;switch(r.kind){case bh.Document:return"string"!=typeof(t=this.evalDocumentQualifier(r))?Oh(t):t;case bh.Sheet:return this.evalSheetQualifier(e,r);case bh.Ident:t=e.range.sheet.document;var n=this.getSheetIndex(t,r.name);return null!=n?Lh(t,n):"string"!=typeof(t=this.evalDocumentQualifier(Fh(r.name)))?Oh(t):Ah.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var t=this.context.globals.getNameFormula(r);if(t.kind===jh.Failure)return kf(t.reason);var n=t.value;return null!=n?ff("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},r.prototype.checkNameCycle=function(e,r,t){return void 0!==Ff.lookup(e,t)?kf(Ol(Ff.runFrom(e,t))):(Ff.visit(e,!0,t),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==Ff.lookup(e,r))return kf(Ol(Ff.runFrom(e,r)));Ff.visit(e,!0,r)},r.prototype.evalName=function(e,r,t,n){if(dt(at.CalcUnifyRangeResolutionCode)){var o=Yh(e.range),a=this.context.resolver.resolveName(o,r,t);return this.nameEvaluator(r,a)}if(null==r||r.kind===bh.Relative){var i=e.range.sheet,u=kh(i,t);if(null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);if(u=kh(Oh(i.document),t),null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);var c="name resolution; qualifier = "+g(r);return Bl("calc.runtime.FormulaEvaluationMachine.evalName",Ph.NAME,c),[void 0,Gh]}var s=this.evalNameQualifier(e,r);if("string"!=typeof s){var l;u=kh(s,t);if(null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);var f=null==s.index?"document":"sheet",d="name resolution, qualifier = "+g(r)+", resolved to "+f;return Bl("calc.runtime.FormulaEvaluationMachine.evalName",Ph.NAME,d),[void 0,Gh]}var h="qualifier resolution, qualifier = "+g(r)+", failed on "+s;return Bl("calc.runtime.FormulaEvaluationMachine.evalname",Ph.NAME,h),[void 0,Gh]},r.prototype.evalPos=function(e,r){return r.kind===wh.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return _h(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var t=e.range.range;switch(r.kind){case Uh.Error:return;case Uh.Single:var n=this.evalCellRefSingle(t,r);return Kh(n,n);case Uh.Range:var o=this.evalCellRefSingle(t,r.ref1),a=this.evalCellRefSingle(t,r.ref2);return Kh(o,a);case Uh.Row:return kf(vl(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case Uh.Col:return kf(vl(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(dt(at.CalcUnifyRangeResolutionCode)){var t=Yh(this.locals.range),n=this.context.resolver.resolveCellRef(t,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,n)}var o=e.range.sheet.document,a=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+g(a);return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,u),xh}if(null!=a&&a.kind===bh.Error){u="qualifier resolution, qualifier = "+g(a);return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,u),xh}if(null!=a&&a.kind===bh.SheetRange){var c=this.getSheetIndex(o,a.sheet1);if(null==c){u="qualifier resolution, qualifier = "+g(a)+", sheet 1";return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,u),xh}var s=this.getSheetIndex(o,a.sheet2);if(null==s){u="qualifier resolution, qualifier = "+g(a)+", sheet 2";return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,u),xh}if(c===s)return Hh(Lh(o,c),[i]);var l=Dh(o,Math.min(c,s),Math.abs(s-c)+1);return Wh(l,i)}var f=null==a||a.kind===bh.Relative?e.range.sheet:this.evalSheetQualifier(e,a);if("string"==typeof f){u="qualifier resolution, qualifier = "+g(a)+", failed on "+f;return Bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ph.REF,u),xh}return Hh(f,[i])},r}(Mf);function ev(e,r,t){return new $h(e,r,t)}function rv(e,r,t,n){var o=Ih(e),a=ev(o.machineContext,r,t);return function e(r,t){var n=r.evaluate(t);return n instanceof Array?n[0]:_l((function(n){return e(r,"number"==typeof n?n:t)}))}(new Nh(o,[a]),n)}var tv=Xt.SpecialPrecs,nv=Xt.precedents;function ov(e){var r=bf.newVisitedMap();return{evalFormula:function(t,n,o,a){var i=Df(t,n,nv([],[],tv.None,!0),r);return rv(e,i,o,a)},evalCells:function(r){return function(e,r){if(0===r.length)return[];var t=Zf(e,r),n=Th(e.schedulerInfo);return t.evaluateSync(n)}(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);var t=Zf(e,r),n=Th(e.schedulerInfo);return t.evaluateAsync(n)}(e,r)}}}var av=zt.formulaSpan,iv=zt.RefStyle,uv=qt.FormulaSource,cv=rn.getSubExpressionFromPosition,sv=rn.isSuccess,lv=rn.failure,fv=rn.ResultKind,dv=av(0,0,"","");function hv(e){var r,t,n,o,a=e.config,i=e.mathpack,u=Dn(a),c=qu(a),s=Sl(a,i),l=ks(c),f=hf(s),d=ov(e),h=_u(u).parseFormula,v=!1,p=void 0,g=-1,m=!1;function E(){v=!1,n=void 0,g=-1,p=void 0,o=void 0,m=!1}function S(){if(!v){if(v=!0,void 0===r||void 0===t)return;var e=h(iv.A1,r,uv.Range,t);sv(e)&&(n=e.value)}}function T(e){if(S(),void 0!==n&&e!==g){var r=p;p=void 0,e>=0&&e<t.length&&(p=cv(n,e)),p!==r&&(o=void 0,m=!1),g=e}}function C(){if(void 0!==p&&!m&&void 0!==n){var e=r,t=l.checkFormula(e,uv.Range,{node:p,spans:n.spans});if(t.isWellFormed){var a=f.compileFormula(e,uv.Range,t);if(sv(a)){var i=d.evalFormula(e,uv.Range,a.value,void 0);i.kind!==fv.Paused&&(o=i)}}m=!0}}return{setCellAndFormula:function(e,n){r=e,t=n,E()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(T(e),void 0!==n&&void 0!==p){var r=n.spans[p.label];if(void 0!==r)return r}return dv},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return T(e),C(),void 0!==o?Promise.resolve(o):Promise.resolve(lv(Dl("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return S(),void 0!==n&&(p=n.node,o=void 0,m=!1),C(),void 0!==o?Promise.resolve(o):Promise.resolve(lv(Dl("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}var vv=Xt.OperKind,pv=Xt.valueErrorOper,gv=Xt.div0ErrorOper,mv=$t.OperatorId,Ev=rn.isSheetIndex,Sv=32767;function Tv(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case vv.Error:return e;case vv.Missing:case vv.Blank:return;case vv.Rich:return Tv(e.getFallback());default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function Cv(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(mv.Concat,(function(r){return e.coerceOper(r,vv.String)})),(function(e){return e}),t);if(null==n){var o="calc.funcs.concat: returned undefined; args = "+g(r);return C.ULS.assertTag(595969627,l.LogCategory.msoulscat_ES_EWAJS,!1,o)}return"string"==typeof n&&n.length>Sv?Xt.valueErrorOper:n}function Rv(e){var r="object"==typeof e&&e.kind===vv.Blank;return(r=r||""===e)?1:0}function Iv(e){return"object"!=typeof e||e.kind!==vv.Blank?1:0}function yv(e,r){var t=r[0];if("object"!=typeof t||t.kind!==vv.Range||!Ev(t.sheets)||1!==t.ranges.length)return pv;var n=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(mv.Add),a=e.reduceDerefOpers(o,Iv,n);return null==a?0:a}function Av(e){return function r(t){if("boolean"==typeof t)return t;if("number"==typeof t)return e.coerceOper(t,vv.Boolean);if("string"!=typeof t)switch(t.kind){case vv.Error:return t;case vv.Missing:case vv.Blank:return;case vv.Rich:return r(t.getFallback());default:return I("funcs.aggregationFuncs: booleanOperationCoerce",t)}}}function Nv(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(mv.And),Av(e),t);return null==n?pv:n}function Ov(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(mv.Or),Av(e),t);return null==n?pv:n}function kv(e,r){var t=e.dereferenceAllOpers(r),n=[];var o=e.reduceDerefOpers((function(e,r){return void 0===e?r:("number"==typeof e&&n.push(e),Vl(e)?e:r)}),(function(e){if("number"==typeof e)return e;if("boolean"!=typeof e&&"string"!=typeof e)switch(e.kind){case vv.Error:return e;case vv.Missing:case vv.Blank:case vv.Rich:return;default:return I("funcs.makeMedianCoerce",e)}}),t);if("number"==typeof o&&n.push(o),null==o)return te;if(Vl(o))return o;if(0===n.length)return te;if(1===n.length)return n[0];if((n=n.sort((function(e,r){return e-r}))).length%2==0){var a=n.length/2;return(n[a-1]+n[a])/2}var i=(n.length-1)/2;return n[i]}function Lv(e){return function(r,t){return e(r)(t[0])}}function Dv(e){return function(r,t){return e(r)(t[0],t[1])}}var _v=Xt.numErrorOper,Mv=Xt.div0ErrorOper,Fv=180/Math.PI,bv=Math.PI/180;function wv(e,r){return Math.PI}var Uv=Lv((function(e){return e.getMathpack().sqrt})),Pv=Lv((function(e){return e.getMathpack().exp})),Gv=Dv((function(e){return e.getMathpack().power})),xv=Lv((function(e){return e.getMathpack().ln})),Bv=Lv((function(e){return e.getMathpack().log10}));function Vv(e,r){var t=r[0],n=r.length<2?10:r[1];return e.getMathpack().log(t,n)}var Wv=Lv((function(e){return e.getMathpack().sin})),Hv=Lv((function(e){return e.getMathpack().cos})),Kv=Lv((function(e){return e.getMathpack().tan})),jv=Lv((function(e){return e.getMathpack().asin})),Jv=Lv((function(e){return e.getMathpack().acos})),qv=Lv((function(e){return e.getMathpack().atan})),Yv=Dv((function(e){return e.getMathpack().atan2}));function Xv(e,r){var t=r,n=t[0],o=t[1],a=Math.pow(10,Math.ceil(o));return n<0?-Math.round(-n*a)/a:Math.round(n*a)/a}function Qv(e,r){var t=r,n=t[0],o=t[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return n<0?-Math.ceil(-n*a)/a:Math.ceil(n*a)/a}function zv(e,r){var t=r,n=t[0],o=t[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return n<0?-Math.floor(-n*a)/a:Math.floor(n*a)/a}function Zv(e,r){var t=r,n=t[0],o=t[1];return 0===o?0:o<0&&n>0?_v:o*Math.ceil(n/o)}function $v(e,r){var t=r,n=t[0],o=t[1];return 0===o?0===n?0:Mv:o<0&&n>0?_v:o*Math.floor(n/o)}function ep(e,r){var t=r[0];return 2*(t<0?Math.floor(t/2):Math.ceil(t/2))}function rp(e,r){var t=r[0];return Math.abs(t)}function tp(e,r){var t=r[0];return t>0?1:0===t?0:t<0?-1:_v}function np(e,r){return r[0]*Fv}function op(e,r){return r[0]*bv}var ap=170;function ip(e,r){var t=r[0];if(!isFinite(t)||t<0)return _v;var n=Math.floor(t+2147483648-2147483648);return n>ap?_v:function e(r){return A("call just Fact with non Natural value",r),0===r?1:r*e(r-1)}(n)}function up(e,r){var t=r[0];if(rn.operKind(t)===Xt.OperKind.Range){var n=t.sheets,o=t.ranges[0];if(1!==n.length||1!==o.rows||1!==o.cols)return Xt.valueErrorOper;t=e.dereferenceOper(t,Xt.OperKind.Number)}switch(rn.operKind(t)===Xt.OperKind.String&&(t=e.coerceOper(t,Xt.OperKind.Number)),rn.operKind(t)){case Xt.OperKind.Number:return 0==(1&Math.floor(Math.abs(t)));case Xt.OperKind.Error:return t;case Xt.OperKind.Missing:return Xt.naErrorOper;case Xt.OperKind.Blank:return!0;case Xt.OperKind.Rich:return up(e,[t.getFallback()]);default:return Xt.valueErrorOper}}var cp=Xt.valueErrorOper;function sp(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function lp(e,r){var t=sp(r),n=t[0],o=t[1];return o<0?cp:o>=n.length?n:n.substr(n.length-o,o)}function fp(e,r){var t=sp(r),n=t[0],o=t[1];return o<0?cp:o>=n.length?n:n.substr(0,o)}function dp(e,r){var t=r[0],n=r[1]-1,o=Math.floor(r[2]);return n<0||o<0?cp:t.substr(n,o)}function hp(e,r){return r[0].length}function vp(e,r){if(2!==r.length)return ae;var t,n=r[0],o=r[1];if("object"==typeof(t=n)&&t.kind===Ul.Rich&&"string"==typeof o){var a=n.getField(o);if(void 0!==a)return a}return ae}function pp(e,r){return gp(e,[$].concat(r))}function gp(e,r){for(var t=r[0],n={},o=1;o<r.length;o+=2){var a=r[o],i=r[o+1];n[a.toLowerCase()]=i}return new mp(n,t)}var mp=function(e,r){var t=this;void 0===e&&(e={}),void 0===r&&(r=$),this._fields=e,this._fallback=r,this.kind=P.Rich,this.getFallback=function(){return t._fallback},this.getField=function(e){var r=e.toLowerCase(),n=t._fields[r];if(void 0!==n)return n}},Ep=rn.success,Sp=rn.failure,Tp={};Tp[$t.WorksheetFuncId.SUM]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(mv.Add),Tv,t);return null==n?0:n},Tp[$t.WorksheetFuncId.PRODUCT]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(mv.Mul),Tv,t);return null==n?0:n},Tp[$t.WorksheetFuncId.AVERAGE]=function(e,r){var t,n=e.makeOperatorReducer(mv.Add),o=e.dereferenceAllOpers(r),a=e.reduceDerefOpers(n,Tv,o),i=e.reduceDerefOpers(n,(t=Tv,function(e){if(null!=t(e))return 1}),o);if(null!=a&&null!=i)return e.getBinaryOperator(mv.Div)(a,i);if(null==a&&null==i)return gv;var u="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+g(r);return C.ULS.assertTag(595980871,l.LogCategory.msoulscat_ES_EWAJS,!1,u)},Tp[$t.WorksheetFuncId.CONCAT]=Cv,Tp[$t.WorksheetFuncId.CONCATENATE]=Cv,Tp[$t.WorksheetFuncId.COUNTBLANK]=function(e,r){var t=r[0];if("object"!=typeof t||t.kind!==vv.Range||!Ev(t.sheets)||1!==t.ranges.length)return pv;var n=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(mv.Add),a=e.reduceDerefOpers(o,Rv,n);return null==a?0:a},Tp[$t.WorksheetFuncId.MAX]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.makeBranchOperatorReducer(mv.Gt,(function(e){return!1})),o=e.reduceDerefOpers(n,Tv,t);return null==o?0:o},Tp[$t.WorksheetFuncId.MIN]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.makeBranchOperatorReducer(mv.Lt,(function(e){return!1})),o=e.reduceDerefOpers(n,Tv,t);return null==o?0:o},Tp[$t.WorksheetFuncId.ISERROR]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Error},Tp[$t.WorksheetFuncId.ISERR]=function(e,r){var t=r[0];return rn.operKind(t)===Xt.OperKind.Error&&t.type!==Xt.ErrorType.NA},Tp[$t.WorksheetFuncId.ISBLANK]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Blank},Tp[$t.WorksheetFuncId.ISLOGICAL]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Boolean},Tp[$t.WorksheetFuncId.ISNA]=function(e,r){var t=r[0];return rn.operKind(t)===Xt.OperKind.Error&&t.type===Xt.ErrorType.NA},Tp[$t.WorksheetFuncId.ISNONTEXT]=function(e,r){return rn.operKind(r[0])!==Xt.OperKind.String},Tp[$t.WorksheetFuncId.ISTEXT]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.String},Tp[$t.WorksheetFuncId.ISNUMBER]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Number},Tp[$t.WorksheetFuncId.ISREF]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Range},Tp[$t.WorksheetFuncId.ISEVEN]=up,Tp[$t.WorksheetFuncId.ISODD]=function(e,r){var t=up(e,r);return rn.operKind(t)===Xt.OperKind.Boolean?!t:t};var Cp,Rp,Ip=!1;function yp(e){return Ip||(Ip=!0,dt(at.CalcNewFunctions)&&(Tp[$t.WorksheetFuncId.AND]=Nv,Tp[$t.WorksheetFuncId.OR]=Ov,Tp[$t.WorksheetFuncId.COUNTA]=yv,Tp[$t.WorksheetFuncId.ABS]=rp,Tp[$t.WorksheetFuncId.CEILING]=Zv,Tp[$t.WorksheetFuncId.DEGREES]=np,Tp[$t.WorksheetFuncId.FLOOR]=$v,Tp[$t.WorksheetFuncId.RADIANS]=op,Tp[$t.WorksheetFuncId.ROUND]=Xv,Tp[$t.WorksheetFuncId.ROUNDUP]=Qv,Tp[$t.WorksheetFuncId.ROUNDDOWN]=zv,Tp[$t.WorksheetFuncId.EVEN]=ep,Tp[$t.WorksheetFuncId.SIGN]=tp,Tp[$t.WorksheetFuncId.PI]=wv,Tp[$t.WorksheetFuncId.SQRT]=Uv,Tp[$t.WorksheetFuncId.EXP]=Pv,Tp[$t.WorksheetFuncId.POWER]=Gv,Tp[$t.WorksheetFuncId.LN]=xv,Tp[$t.WorksheetFuncId.LOG10]=Bv,Tp[$t.WorksheetFuncId.LOG]=Vv,Tp[$t.WorksheetFuncId.SIN]=Wv,Tp[$t.WorksheetFuncId.COS]=Hv,Tp[$t.WorksheetFuncId.TAN]=Kv,Tp[$t.WorksheetFuncId.ASIN]=jv,Tp[$t.WorksheetFuncId.ACOS]=Jv,Tp[$t.WorksheetFuncId.ATAN]=qv,Tp[$t.WorksheetFuncId.ATAN2]=Yv,Tp[$t.WorksheetFuncId.FACT]=ip,Tp[$t.WorksheetFuncId.LEFT]=fp,Tp[$t.WorksheetFuncId.RIGHT]=lp,Tp[$t.WorksheetFuncId.MID]=dp,Tp[$t.WorksheetFuncId.LEN]=hp),dt(at.CalcWorksheetFunctions)&&(Tp[$t.WorksheetFuncId.MEDIAN]=kv),dt(at.CalcFieldValueFunction)&&(Tp[$t.WorksheetFuncId.FIELDVALUE]=vp),dt(at.CalcRecordFunctions)&&(Tp[$t.WorksheetFuncId.RECORD]=pp,Tp[$t.WorksheetFuncId.RECORDTEST]=gp)),Tp[e]}function Ap(e){return function(r){if("number"==typeof r){var t=yp(r);return null!=t?Ep(t):Sp(vl([e.getWorksheetFuncName(r)]))}return Ep(void 0)}}(Rp=Cp||(Cp={})).DerefOperKind=As,Rp.FuncKind=ys;var Np={},Op=0;function kp(e){var r=Np[e];Np[e]=(void 0===r?0:r)+1,(Op+=1)%100==0&&(C.ULS.traceTag(595858520,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"hashUtils.logCollision: "+JSON.stringify(Np)+"."),Np={})}function Lp(e,r){return{key:e,value:r}}function Dp(e,r){return{map:{},nentries:0,keyToHash:e,keyEquals:r,getCount:function(){return this.nentries},getValue:function(e){var r=this.keyToHash(e),t=this.map[r];if(!fr(t)){for(var n=0;n<t.length;n+=1){var o=t[n];if(this.keyEquals(e,o.key))return o.value}kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,r){var t=this.keyToHash(e),n=this.map[t];if(null==n)this.map[t]=[Lp(e,r)],this.nentries+=1;else{for(var o=0;o<n.length;o+=1){var a=n[o];if(this.keyEquals(a.key,e))return void(a.value=r)}n.push(Lp(e,r)),this.nentries+=1,kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},remove:function(e){var r=this.keyToHash(e),t=this.map[r];if(fr(t))return!1;for(var n=[],o=!1,a=0;a<t.length&&!o;a+=1){var i=t[a];this.keyEquals(e,i.key)?(this.nentries-=1,o=!0):n.push(i)}return this.map[r]=n,o||kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),o},getOrSetValue:function(e,r){var t=this.keyToHash(e),n=this.map[t];if(fr(n)){var o=r();return this.map[t]=[Lp(e,o)],this.nentries+=1,o}for(var a=0;a<n.length;a+=1){var i=n[a];if(this.keyEquals(e,i.key))return i.value}var u=r();return n.push(Lp(e,u)),this.nentries+=1,kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),u},forEach:function(e){var r=this;Object.keys(this.map).forEach((function(t){r.map[+t].forEach((function(r){e(r.key,r.value)}))}))},filter:function(e){var r=[];this.forEach((function(t,n){return e(t,n)||r.push(t),!0}));for(var t=0,n=r;t<n.length;t++){var o=n[t];this.remove(o)}}}}function _p(e){if(null==e)return"";var r,t=Xr(e.sheet.document);t===k?r="illegalDocument":r=(null==t.path?"":"p:"+t.path.toLocaleUpperCase()+",")+"n:"+t.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}var Mp=function(e){var r=e^e>>16;return r*=2246822507,r^=r>>13,r*=3266489909,r^=r>>16};function Fp(e){var r=1;return r=31*(r=31*(r=31*(r=31*r+Mp(e.sheet.index))+Mp(e.range.col))+Mp(e.range.row))+Mp(e.sheet.document.name.length),void 0!==e.sheet.document.path&&(r=31*r+Mp(e.sheet.document.path.length)),r}function bp(e,r){return Lr(e,r)}function wp(){return{map:{},keyToHash:Fp,keyEquals:bp,nelements:0,add:function(e){var r=this.keyToHash(e);if(fr(this.map[r]))this.map[r]=[e],this.nelements+=1;else{for(var t=this.map[r],n=0;n<t.length;n+=1)if(this.keyEquals(e,t[n]))return;kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),t.push(e),this.nelements+=1}},contains:function(e){var r=this.keyToHash(e),t=this.map[r];if(fr(t))return!1;for(var n=0;n<t.length;n+=1)if(this.keyEquals(e,t[n]))return!0;return kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var r=this;Object.keys(this.map).forEach((function(t){r.map[+t].forEach((function(r){e(r)}))}))},size:function(){return this.nelements},remove:function(e){var r=this,t=this.keyToHash(e),n=this.map[t];if(fr(n))return!1;var o=[],a=!1;return n.forEach((function(t){r.keyEquals(e,t)?(r.nelements-=1,a=!0):o.push(t)})),this.map[t]=o,a||kp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a}}}function Up(){return Dp((function(e){return e}),(function(e,r){return e===r}))}var Pp=rn.createResolutionHandler,Gp=rn.createNameFinder,xp={};function Bp(e){dt(at.CalcLogStopWatch)&&(xp[e]=ct(e))}function Vp(e){if(dt(at.CalcLogStopWatch)){var r=xp[e];void 0!==r&&r.stop()}}function Wp(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&Nr(e,r)}function Hp(e,r,t,n){var o=function(e,r){if(void 0===e){var t=r.getCurrentDocumentLoc(),n=r.getCurrentSheetIndex();if(null==t||null==n)return;return M(t,n)}switch(e.kind){case le.Error:return;case le.Relative:t=r.getCurrentDocumentLoc(),n=r.getCurrentSheetIndex();if(null==t||null==n)return;return M(t,n);case le.Sheet:var o=void 0!==e.document?L(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==o)return;var a=r.getSheetIndex(o,e.sheet);if(null==a)return;return M(o,a);case le.SheetRange:if(null==(o=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(o,e.sheet1),u=r.getSheetIndex(o,e.sheet2);if(null==i||null==u)return;return i===u?M(o,i):_(o,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,t);if(void 0!==o)if(Wp(r.sheet.document,o.document)||(n.crossDocRefs+=1),Tr(o))switch(o.index!==r.sheet.index&&(n.crossSheetRefs+=1),e.ref.kind){case fe.Error:return void(n.errRefs+=1);case fe.Col:return void(n.columnRefs+=1);case fe.Row:return void(n.rowRefs+=1);case fe.Range:var a=Mr(Kp(e.ref.ref1,r),Kp(e.ref.ref2,r));return t.maxRangeSize>0&&Ql(a)>t.maxRangeSize?void(n.largeRanges+=1):K(o,a);case fe.Single:var i=Kp(e.ref,r);return j(o,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else n.crossSheetRefs+=1;else n.errRefs+=1}function Kp(e,r){return w(jp(e.row,r.range.row),jp(e.col,r.range.col))}function jp(e,r){switch(e.kind){case de.Abs:return e.index;case de.Rel:return e.index+r}}function Jp(e,r){var t=void 0;if(void 0===e.qualifier){var n=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==n||null==o)return;t=M(n,o)}else switch(e.qualifier.kind){case le.Document:t=J(L(e.qualifier.path,e.qualifier.document));break;case le.Relative:n=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==n||null==o)return;t=M(n,o);break;case le.Ident:var a=r.getCurrentDocumentLoc();if(null==a)return;var i=r.getSheetIndex(a,e.qualifier.name);t=null==i?J(L(void 0,e.qualifier.name)):M(a,i);break;case le.Sheet:if(null==(a=void 0!==e.qualifier.document?L(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(a,e.qualifier.sheet)))return;t=M(a,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return q(t,e.whole)}function qp(e,r){switch(r.ref.kind){case fe.Error:e.errRefs+=1;break;case fe.Col:e.columnRefs+=1;break;case fe.Row:e.rowRefs+=1}}function Yp(e,r){var t=r[e];return void 0===t&&(t=0),t}function Xp(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:cr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){if(Bp("calc_ts_merge_sets"),dt(at.CalcHashSet)){var t=wp();e.forEach((function(e){t.add(e)})),r.forEach((function(r){t.contains(r)||e.push(r)}))}else{var n=cr();e.forEach((function(e){n[_p(e)]=!0})),r.forEach((function(r){var t=_p(r);n[t]||(e.push(r),n[t]=!0)}))}Vp("calc_ts_merge_sets")}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach((function(t){var n=e.functionsCount[t];void 0===n&&(n=0),e.functionsCount[t]=n+r.functionsCount[t]})),Object.keys(r.operatorsCount).forEach((function(t){var n=Number(t),o=e.operatorsCount[n];void 0===o&&(o=0),e.operatorsCount[n]=o+r.operatorsCount[n]}))}};return e}function Qp(e){var r={_logger:e,_dependencyGraph:cr(),haveDependents:function(e){return void 0!==r._dependencyGraph[_p(e)]},directDependents:function(e){var t=[],n=r._dependencyGraph[_p(e)];return void 0!==n&&n.forEach((function(e){t.push(e)})),t},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=cr()},add:function(e,t,n){var o=it.__assign({},e);o.getCurrentDocumentLoc=function(){return Xr(e.getCurrentDocumentLoc())};var a=Xp();if(null==n)return a;var i=void 0,u=void 0;dt(at.CalcUnifyRangeResolutionCode)&&(i=function(e,r,t,n){return Pp(Gp((function(o){var a=r.nameRefToSheetGridRange(e,o);return null==a?a:(t.addDependency(a,e,r.maxRangeSize,n),a)}),void 0),ur,(function(){}))}(t,o,r,a),u=function(e,r,t,n){return Pp((function(o){Tr(o.sheet)||(n.crossSheetRefs+=1),Wp(e.sheet.document,o.sheet.document)||(n.crossDocRefs+=1),o.sheet.index!==e.sheet.index&&(n.crossSheetRefs+=1),Ir(o)&&t.addDependency(o,e,r.maxRangeSize,n)}),(function(e){return qp(n,e)}),(function(e,r){e.kind===Ur.NotImplemented?qp(n,r):n.errRefs+=1}))}(t,o,r,a));var c,s,f,d=[];for(d.push(n.node);d.length>0;){var h=d.pop();if(null!=h)switch(h.kind){case he.Literal:break;case he.Array:h.nodes.map((function(e){return e.map((function(e){d.push(e)}))}));break;case he.App:if("object"==typeof h.head){var v=h.head;switch(v.kind){case he.Operator:a.operatorsCount[v.id]=(c=v.id,s=a.operatorsCount,f=void 0,void 0===(f=s[c])&&(f=0),f+1);break;case he.Name:a.functionsCount[v.whole]=Yp(v.whole,a.functionsCount)+1;break;default:d.push(v)}}h.args.map((function(e){d.push(e)}));break;case he.Paren:d.push(h.node);break;case he.Name:if(a.nameRefs+=1,dt(at.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,o.resolver.resolveName(t,h.qualifier,h.whole));else if(void 0===i){var p=Jp(h,o);if(void 0!==p)null!=(g=o.nameRefToSheetGridRange(t,p))&&r.addDependency(g,t,o.maxRangeSize,a)}else C.ULS.traceTag(595952269,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case he.CellRef:if(dt(at.CalcUnifyRangeResolutionCode)&&void 0!==u)u(h,o.resolver.resolveCellRef(t,h.qualifier,h.ref));else if(void 0===u){var g;void 0!==(g=Hp(h,t,o,a))&&r.addDependency(g,t,o.maxRangeSize,a)}else C.ULS.traceTag(595952270,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case he.Bad:a.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",h)}}return a},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=Qp(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){Bp("calc_ts_merge_graph");var t=function(t){var n=r._dependencyGraph[t],o=e[t];void 0===n&&(n=[]);var a=n;if(dt(at.CalcHashSet)){var i=wp();a.forEach((function(e){i.add(e)})),o.forEach((function(e){i.contains(e)||a.push(e)}))}else{var u=cr();a.forEach((function(e){u[_p(e)]=!0})),o.forEach((function(e){u[_p(e)]||a.push(e)}))}r._dependencyGraph[t]=a};for(var n in e)t(n);Vp("calc_ts_merge_graph")},addDependency:function(e,t,n,o){if(yr(e)){var a=_p(e);r.updateDependency(a,t)&&o.dependents.push(e)}else if(Ql(e.range)>n)o.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=j(e.sheet,w(i,u));r.addDependency(c,t,n,o)}},updateDependency:function(e,t){var n=r._dependencyGraph[e];return void 0===n&&(n=[]),!n.some((function(e){return Lr(e,t)}))&&(n.push(t),r._dependencyGraph[e]=n,!0)},getDependents:function(e,t){if(Bp("calc_ts_get_dependents"),dt(at.CalcHashSet)){for(var n=wp(),o=[],a=r.directDependents(e);a.length>0;){if(void 0!==(s=a.shift()))if(!n.contains(s))n.add(s),(l=r.directDependents(s)).length>0&&l.forEach((function(e){a.push(e)})),t&&0!==l.length||o.push(s)}return o}for(var i=cr(),u=[],c=r.directDependents(e);c.length>0;){var s;if(void 0!==(s=c.shift())){var l,f=_p(s);if(!i[f])i[f]=!0,(l=r.directDependents(s)).length>0&&(c=c.concat(l)),t&&0!==l.length||u.push(s)}}return Vp("calc_ts_get_dependents"),u},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return zp(0,0);var t=e.length,n=0;return e.forEach((function(e){var t=r._dependencyGraph[e];n+=t.length})),zp(t,n)}};return r}function zp(e,r){return{nodes:e,arcs:r}}var Zp=rn.createResolver,$p=rn.success;function eg(e){return R(e),Qp(e)}function rg(e,r,t,n,o,a,i,u,c,s){return{maxRangeSize:e,nameRefs:r,rowRefs:t,columnRefs:n,crossSheetRefs:o,crossDocRefs:a,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:s,resolver:Zp({getSheetIndex:function(e,r){return $p(c(e,r))},getDocumentLoc:i})}}var tg=qt.FormulaSource,ng=qt.sheetGridCell,og=qt.gridCell,ag=qt.documentLoc,ig=qt.sheetIndex,ug=zt.RefStyle,cg=rn.ResultKind,sg=rn.failure;function lg(e,r){return{}}function fg(e,r,t){return{config:e,mathpack:r,formatInfo:t}}function dg(e){var r={globals:e,runtime:function(e){var r=e.config,t=e.mathpack,n={config:r},o=it.__assign({config:r},e.formatInfo),a={config:r,mathpack:t},i=_u(n),u=ks(o),c=hf(a);return{parser:i,analyzer:u,compiler:c}}(e),cache:cr(),lazyCreateCacheItem:function(e){var t,n=_p(e),o=r.cache[n];return void 0===o&&(o={cell:e,rawValue:t,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},r.cache[n]=o),o},size:function(){var e=0;for(var t in r.cache)e+=1;return e},clear:function(){r.cache=cr()},cells:function(){var e=Object.keys(r.cache);return void 0===e||0===e.length?[]:e.map((function(e){return r.cache[e].cell}))},getItem:function(e){var t=_p(e);return r.cache[t]},getValue:function(e){var t=r.getItem(e);if(void 0!==t&&null!==t.rawValue)return t.rawValue},getFormula:function(e,t,n){var o=r.getItem(e);if(void 0!==o&&hg(r.runtime,o,t,n)&&vg(o.formula))return o.formula},getFormulaFormat:function(e){var t=r.getItem(e);if(void 0!==t)return t.format},getCompiledFormula:function(e,t){var n=r.getItem(e);if(void 0!==n&&function(e,r,t){if(vg(r.compiledFormula))return!0;if(!hg(e,r,t))return!1;if(void 0!==t&&t)return!1;r.compiledFormula=null;try{var n=e.compiler.compileFormula(r.cell,tg.Cell,r.formula);return n.kind===cg.Success&&(r.compiledFormula=n.value,!0)}catch(e){return C.ULS.traceTag(595968586,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+g(e)),!1}}(r.runtime,n,t)&&vg(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var t=r.getItem(e);if(void 0!==t)return t.evalResult},isEqualValue:function(e,t){var n=r.getItem(e);return void 0!==n&&n.rawValue===t},updateCellValue:function(e,t,n,o,a){if(!r.isEqualValue(e,t)){var i=r.lazyCreateCacheItem(e);if(i.rawValue=t,i.formula=void 0,i.compiledFormula=void 0,i.evalResult=void 0,i.format=void 0,null!=n){var u=n.getValue(e);void 0!==u&&t===u&&(i.formula=n.getFormula(e,!0),i.compiledFormula=n.getCompiledFormula(e,!0),i.evalResult=void 0,i.format=i.format)}null!=a&&(i.format=a),null!=o&&o.forEach((function(e){var t=r.getItem(e);void 0!==t&&(t.evalResult=void 0)}))}},updateEvalResult:function(e,t,n){var o=r.lazyCreateCacheItem(e);o.evalResult=t,null!=n&&(o.format=n)},merge:function(e,t){e.cells().forEach((function(n){var o=e.getValue(n);void 0===o||!0!==t&&void 0!==r.getItem(n)||r.updateCellValue(n,o,e)}))},parseCompileNameFormula:function(e,t,n){var o,a=void 0===n?ug.A1:n,i=tg.NameManager;if(void 0!==t)o=r.runtime.parser.parseFormula(a,t,i,e);else{var u=ig(ag(void 0,"Doc"),0),c=og(0,0);o=r.runtime.parser.parseFormula(a,ng(u,c),i,e)}var s=g(e);if(o.kind!==cg.Success){var f="calc.formulaCache.parseCompileNameFormula: couldn't parse "+s;return C.ULS.traceTag(595969230,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),sg(Mn(f))}var d=r.runtime.analyzer.checkFormula(t,tg.NameManager,o.value);if(d.isWellFormed)return r.runtime.compiler.compileFormula(t,i,d);var h="calc.formulaCache.parseCompileNameFormula: formula "+s+" is not well-formed.";return C.ULS.traceTag(595969231,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,h),sg(Tl(h))}};return r}function hg(e,r,t,n){if(vg(r.formula))return!0;if(!vg(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==t&&t)return!1;r.formula=null;var o=r.rawValue;try{var a=e.parser.parseFormula(zt.RefStyle.A1,r.cell,tg.Cell,o);if(a.kind!==cg.Success)return!1;var i=e.analyzer.checkFormula(r.cell,tg.Cell,a.value,n);return!!i.isWellFormed&&(r.formula=i,dt(at.CalcFormatCalculations)&&(r.format=void 0),!0)}catch(e){return C.ULS.traceTag(595968585,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+g(e)),!1}}function vg(e){return null!=e}var pg,gg=pg=function(e,r){return{functionId:e,functionName:r}},mg=function(e){return e}((function(e,r){return{errorType:e,errorName:r}})),Eg=function(e){return e}((function(e,r,t,n,o,a,i,u,c,s,l,f,d,h){var v=[];return r.forEach((function(e,r){"string"==typeof e?v.push(mg(r,e)):lr(e)&&v.push(e)})),{worksheetFunctionNames:e,errorTypeNames:v,errorNames:[],trueName:t,falseName:n,rowLetter:o,columnLetter:a,leftBrace:i,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}})),Sg=function(e){return e}((function(e,r,t){return{iformat:e,category:r,decimals:t}})),Tg=function(e){return e}((function(e,r){return{sheetId:e,sheetName:r}})),Cg={kind:"Blank"},Rg=function(e){return e}((function(e){return{kind:"Error",type:e}})),Ig=function(e){return e}((function(e){return{kind:"Rich",fields:e}})),yg=function(e){return e}((function(e,r){return{row:e,column:r}})),Ag=function(e){return e}((function(e,r,t,n){return{row:e,column:r,lastRow:t,lastColumn:n}})),Ng=function(e){return e}((function(e,r,t,n,o){return{sheetId:e,row:r,column:t,lastRow:n,lastColumn:o}})),Og=function(e){return e}((function(e,r,t){return{formulaBarText:e,value:r,iformat:t}})),kg=function(e){return e}((function(e,r,t,n,o){return{range:e,data:r,fromStateId:t,excludeRows:n,excludeColumns:o}})),Lg=function(e){return e}((function(e,r,t,n){return kg(e,r,void 0,t,n)}));function Dg(e,r,t,n){return kg(e,void 0,r,t,n)}var _g=function(e){return e}((function(e,r){return{isSpilled:e,formulaBarText:r}})),Mg=function(e){return e}((function(e,r,t){return{range:e,data:r,fromStateId:t}}));function Fg(e,r){return Mg(e,r,void 0)}function bg(e,r){return Mg(e,void 0,r)}var wg,Ug,Pg,Gg,xg=function(e){return e}((function(e,r,t,n,o){return{range:e,formulaBarText:r,value:t,origin:n,viewport:o}})),Bg=function(e){return e}((function(e,r,t,n){return{range:e,formulaBarText:r,origin:t,viewport:n}})),Vg=function(e){return e}((function(e,r,t,n,o){return{isExact:e,iformat:r,hasHyperlink:t,category:n,decimals:o}})),Wg=function(e){return e}((function(e,r,t){return{formulaBarText:e,value:r,format:t}})),Hg=function(e){return e}((function(e,r){return{range:e,data:r}})),Kg=function(e){return e}((function(e,r){return{range:e,data:r}})),jg=function(e){return e}((function(e,r,t){return{range:e,task:r,reason:t}})),Jg=function(e){return e}((function(e,r,t,n,o,a){return{stateId:e,priorityGroup:r,isFinished:t,rangeDeltas:n,arrayDeltas:o,rangeFailures:[]}})),qg=function(e){return e}((function(e,r){return{rangeUpdateRanges:e,arrayUpdateRanges:r}})),Yg=6e4,Xg=3e4;function Qg(){var e;return[new Promise((function(r,t){return e=[r,t]})),e]}function zg(e,r){var t=Qg(),n=t[0],o=t[1],a=o[0],i=o[1],u=setTimeout(r,Math.max(0,e));return[n,[function(e){clearTimeout(u),a(e)},function(e){clearTimeout(u),i(e)}]]}function Zg(e,r,t){var n=zg(e,(function(){return s(r())})),o=n[0],a=n[1],i=a[0],u=a[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return t(s,(function(){return c}))}));return function(e,r){return e.then((function(e){return r(),e}),(function(e){return r(),Promise.reject(e)}))}(Promise.race([o,l]),i)}function $g(e,r){var t;return new Promise((function(n,o){Promise.resolve(r).then((function r(a){if(void 0!==a){t=a;try{Promise.resolve(e(t)).then(r,o)}catch(e){o(e)}}else n(t)}),o)}))}function em(e,r){return{setMessageListeners:function(r){e.onmessage=function(e){return r.onMessage(e.data)},e.onmessageerror=function(e){return r.onMessageError(e.data)}},postMessage:function(r){return e.postMessage(r)},close:function(){return r.call(e)}}}function rm(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(wg||(wg={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(Ug||(Ug={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(Pg||(Pg={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(Gg||(Gg={}));var tm,nm={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function om(e){return[e.name,e.message,e.stack]}function am(e){var r,t=e[0],n=e[1],o=e[2],a=nm[t];return null!=a?r=new a(n):(r=new Error(n)).name=t,void 0!==o&&(r.stack=o),r}function im(e){return rm(e)?[tm.Error,om(e)]:[tm.Unknown,e]}function um(e,r,t,n){var o=new Error(e);return o.stack=e+"\n    at "+r+":"+t+":"+n,o}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(tm||(tm={}));var cm="__START_ERROR__",sm="__END_ERROR__";function lm(e){var r=e.message.indexOf(cm),t=e.message.indexOf(sm);return r>=0&&t>=0?am(JSON.parse(e.message.substring(r+cm.length,t))):null!=e.error?e.error:um(e.message,e.filename,e.lineno,e.colno)}function fm(e,r,t,n,o,a){var i={port:r,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==i)throw new Error("endpoint is closed");return i}function c(e,r,t){if(null!=i){var n=i.callbacks[e];null!=n&&(delete i.callbacks[e],n[r](t))}}function s(e,r,t,n,o){var a;try{a=u()}catch(e){return Promise.reject(e)}var i=a.lastAppId+1,c=[Pg.App,i,e,r,t,o],s=zg(n,(function(){f(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),l=s[0],d=s[1];a.callbacks[i]=d,a.lastAppId=i;try{a.port.postMessage(c)}catch(e){f(c,e)}return l}function l(e,r,t,n){var o=u(),a=[Pg.App,-1,e,r,t,n];try{o.port.postMessage(a)}catch(e){f(a,e)}}function f(e,r){var t=e[1],n=e[5];null!=i&&(t>=0&&c(t,Gg.Rejected,r),n?m(t>=0?Ug.PostCallError:Ug.PostNotifyError,r,!0):(t<0&&m(Ug.PostNotifyError,r,!1),s("","",[],Math.max(E.callTimeout,E.initTimeout),!0).catch((function(e){}))))}function d(e){var r=e[1],t=e[2],n=e[3],o=e[4],a=e[5];if(null!=i)if(""!==t||""!==n){var u=Promise.resolve().then((function(e){if(null!=i){var r=t,a=n,u=i.modules[r],c=null!=u?u[a]:void 0;if(null==c)throw new Error("method "+r+"."+a+" has not been exported");return c.apply(u,o)}}));r>=0?u.then((function(e){return h(r,Gg.Fulfilled,e,a)}),(function(e){return h(r,Gg.Rejected,e,a)})):u.catch((function(e){m(Ug.UnhandledNotifyError,function(e,r,t){var n=r+"."+t+".notify: ";if(rm(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var o=new Error(n+e);return o.stack=void 0,o}(e,t,n),!1)}))}else h(r,Gg.Fulfilled,void 0,a)}function h(e,r,t,n){if(null!=i){var o=[Pg.Result,e,r,im(t),n];try{i.port.postMessage(o)}catch(e){v(o,e)}}}function v(e,r){var t=e[1],n=e[4];null!=i&&(n?m(Ug.PostResultError,r,!0):h(t,Gg.Rejected,im(r),!0))}function p(e){var r=e[1],t=e[2],n=e[3];null!=i&&c(r,t,function(e){return e[0]===tm.Unknown?e[1]:am(e[1])}(n))}function g(e){if(void 0===e&&(e=!0),null!=i){var r=i.port,t=i.callbacks;if(i=void 0,e)try{r.postMessage([Pg.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var o in t)c(Number(o),Gg.Rejected,n);try{r.close()}catch(e){}if(null!=a)try{a(E)}catch(n){var u=null!=n.stack?n.stack:n.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function m(e,r,t){if(null!=i){var n=void 0;try{o(E,{kind:e,closing:t,error:r})||(n=[r])}catch(r){n=[r]}if(t&&g(),null!=n){var a=n[0],u=null!=a.stack?a.stack:a.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var E={workerKind:e,initTimeout:t,callTimeout:n,setExports:function(e,r){return u().modules[e]=r},getImports:function(e,r){var t={};return r.forEach((function(r){return t[r]=function(e,r){var t={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=null!=t.callTimeout?t.callTimeout:E.callTimeout;return s(e,r,n,a,t.isCritical)},notify:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];l(e,r,n,t.isCritical)}};return t}(e,r)})),t},close:g,dispatchError:m};return i.port.setMessageListeners({onMessage:function(e){switch(e[0]){case Pg.App:return d(e);case Pg.Result:return p(e);case Pg.Close:return g(!1);default:return I("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var r=new Error("failed to send "+e[0]+" message");switch(e[0]){case Pg.App:return f(e,r);case Pg.Result:return v(e,r);case Pg.Close:return;default:return I("calc.worker.createPortEndpoint.onMessageError",e)}}}),E}function dm(e,r,t){var n=this,o=null!=r.initTimeout?r.initTimeout:Yg,a=null!=r.callTimeout?r.callTimeout:Xg;return Zg(o,(function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")}),(function(i,u){return it.__awaiter(n,void 0,void 0,(function(){function n(e){return function(r,t){return s?null!=e.onError&&(e.onError(r,t),!0):(i(t.error),!0)}}function c(e){return function(r){s&&null!=e.onClosed&&e.onClosed(r)}}var s,l,f;return it.__generator(this,(function(i){switch(i.label){case 0:return s=!1,l=fm(e,t.outside,o,a,n(r.outside),c(r.outside)),f=fm(e,t.inside,o,a,n(r.inside),c(r.inside)),u()||null==r.inside.onInit?[3,2]:[4,r.inside.onInit(f)];case 1:i.sent(),i.label=2;case 2:return u()||null==r.outside.onInit?[3,4]:[4,r.outside.onInit(l)];case 3:i.sent(),i.label=4;case 4:return s=!0,[2,l]}}))}))}))}function hm(){return"undefined"!=typeof MessageChannel}var vm=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return y("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var pm,gm,mm=100;function Em(){if(null==nn.getCalcAbsUrl()){return C.ULS.traceTag(595907587,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function Sm(e){setTimeout((function(){try{e.terminate()}catch(e){}}),mm)}function Tm(){var e={};for(var r in at){var t=at[r];null!=t&&(e[r]=dt(t))}return e}t(9);var Cm=((pm={})[wg.FunctionCall]=function(){return!0},pm[wg.MessageChannel]=hm,pm[wg.Dedicated]=Em,pm);function Rm(e){return Cm[e]()}var Im=((gm={})[wg.FunctionCall]=function(e){return dm(wg.FunctionCall,e,(r=new vm,t=new vm,r.open(t),{outside:r,inside:t}));var r,t},gm[wg.MessageChannel]=function(e){if(!hm())return y("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var r=function(){var e=new MessageChannel;return{outside:em(e.port1,e.port1.close),inside:em(e.port2,e.port2.close)}}();try{return dm(wg.MessageChannel,e,r)}catch(e){try{r.outside.close()}catch(e){}throw e}},gm[wg.Dedicated]=function(e){var r=this,t=e.outside,n=e.inside,o=e.initTimeout,a=e.callTimeout,i=n.scriptName;if(null==i)return y("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=nn.getCalcAbsUrl();if(!Em()||null==u)return y("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=o?o:Yg,s=null!=a?a:Xg;return Zg(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return st("calc.worker.createDedicatedWorker (total)",(function(){return it.__awaiter(r,void 0,void 0,(function(){function r(r){return it.__awaiter(this,void 0,void 0,(function(){function o(r,n){return i?null!=t.onError&&(t.onError(r,n),!0):(e(n.error),!0)}function a(e){i&&null!=t.onClosed&&t.onClosed(e)}var i,l,f,d,h;return it.__generator(this,(function(e){switch(e.label){case 0:i=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(r),d=em(l,(function(){return Sm(l)})),f=fm(wg.Dedicated,d,c,s,o,a),l.onerror=function(e){var t;e.preventDefault(),t=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+r):lm(e),f.dispatchError(Ug.UnhandledError,t,!i)},function(e,r){var t={shipAssertTag:function(e,t,n,o){try{r.ULS.shipAssertTag(e,t,n,o)}catch(e){}},assertTag:function(e,t,n,o){try{r.ULS.assertTag(e,t,n,o)}catch(e){}},traceTag:function(e,t,n,o){try{r.ULS.traceTag(e,t,n,o)}catch(e){}},debugTraceTag:function(e,t,n,o){try{r.ULS.debugTraceTag(e,t,n,o)}catch(e){}}};e.setExports("",t)}(f,C),n()?[3,3]:[4,st("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:Tm()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==t.onInit?[3,5]:[4,t.onInit(f)];case 4:e.sent(),e.label=5;case 5:return i=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&Sm(l),h;case 7:return[2]}}))}))}var o,a,f,d;return it.__generator(this,(function(e){switch(e.label){case 0:n=i+(/\.min\.js$/.test(t=u)?".min.js":".js"),c=t.lastIndexOf("/"),o=t.substring(0,c+1)+n,a="calc.worker.createDedicatedWorker: workerUrl = "+o,C.ULS.traceTag(595907588,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,a),e.label=1;case 1:e.trys.push([1,6,,7]),f=new Blob(['importScripts("'+encodeURI(o)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(f),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,r(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),C.ULS.traceTag(595881991,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+o+". Attempting with string url instead..."),[2,r(o)];case 7:return[2]}var t,n,c}))}))}))}))},gm);function ym(e,r){return Im[e](r)}function Am(e,r){return it.__awaiter(this,void 0,void 0,(function(){var t,n,o,a,i;return it.__generator(this,(function(u){switch(u.label){case 0:t=0,u.label=1;case 1:if(!(t<e.length))return[3,6];if(!Rm(n=e[t]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,ym(n,r)];case 3:return[2,u.sent()];case 4:return o=u.sent(),a=null!=o.stack?o.stack:o.message,i="calc.worker.tryCreateWorker: starting "+n+" worker threw "+a,C.ULS.traceTag(595907598,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,i),[3,5];case 5:return t+=1,[3,1];case 6:return[2,void 0]}}))}))}function Nm(){setTimeout((function(){try{self.close()}catch(e){}}),mm)}function Om(e,r,t,n){var o=r.initTimeout,a=r.callTimeout,i=r.calcAbsUrl,u=r.features;return it.__awaiter(this,void 0,void 0,(function(){var r,c,s,l,f=this;return it.__generator(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,Zg(o,(function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")}),(function(e,r){return it.__awaiter(f,void 0,void 0,(function(){function c(r,t){return l?null!=n.onError&&(n.onError(r,t),!0):(e(t.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,v,p;return it.__generator(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=em(self,Nm),f=fm(wg.Dedicated,d,o,a,c,s),h=function(e){var r=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,t,n,o){if(r.shipAssertTag.notify(e,t,n,o),!n)throw new Error("shipAssertTag: "+o)},assertTag:function(e,t,n,o){if(r.assertTag.notify(e,t,n,o),!n)throw new Error("assertTag: "+o)},traceTag:function(e,t,n,o){r.traceTag.notify(e,t,n,o)},debugTraceTag:function(e,t,n,o){r.debugTraceTag.notify(e,t,n,o)}}}(f),v=function(e){return!0===u[e]},t.config.initCalc(h,v,i),r()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=f?f.close():Nm(),p;case 5:return[2]}}))}))})).then((function(e){return[Gg.Fulfilled,e]}),(function(e){return[Gg.Rejected,e]}))];case 1:r=d.sent(),c=r[0],s=r[1],l=[Pg.Result,e,c,im(s),!0];try{self.postMessage(l)}catch(e){throw Nm(),e}return[2]}}))}))}var km={onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595908699,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var r=e.getImports("talk",["ping"]);e.setExports("location",qt),e.setExports("talk",{start:function(e,t,n){return it.__awaiter(this,void 0,void 0,(function(){var o,a=this;return it.__generator(this,(function(i){switch(i.label){case 0:return o=Date.now(),[4,$g((function(i){return it.__awaiter(a,void 0,void 0,(function(){return it.__generator(this,(function(a){switch(a.label){case 0:return Date.now()>=o+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 1:return a.sent(),r.ping.notify(i,n),[2,i+1]}}))}))}),0)];case 1:return i.sent(),[2]}}))}))},memoryTest:function(e){var r=[],t=0;try{for(;t<e;t+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,r.push(n)}}catch(e){}r=[];var o="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+t+"KB";C.ULS.traceTag(595906820,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,o)},ping:function(e,r){if(r&&e%1e3==0){var t="calc.worker.smokeTestInsideDef.ping: n = "+e;C.ULS.traceTag(595907656,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}return e+1},logMessage:function(e,r){if(r){var t="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;C.ULS.traceTag(595714188,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"},Lm="To be, or not to be, that is the question:Whether 'tis nobler in the mind to sufferThe slings and arrows of outrageous fortune,Or to take arms against a sea of troublesAnd by opposing end them. To die—to sleep,No more; and by a sleep to say we endThe heart-ache and the thousand natural shocksThat flesh is heir to: 'tis a consummationDevoutly to be wish'd. To die, to sleep;To sleep, perchance to dream—ay, there's the rub:For in that sleep of death what dreams may come,When we have shuffled off this mortal coil,Must give us pause—there's the respectThat makes calamity of so long life.For who would bear the whips and scorns of time,Th'oppressor's wrong, the proud man's contumely,The pangs of dispriz'd love, the law's delay,The insolence of office, and the spurnsThat patient merit of th'unworthy takes,When he himself might his quietus makeWith a bare bodkin? Who would fardels bear,To grunt and sweat under a weary life,But that the dread of something after death,The undiscovere'd country, from whose bournNo traveller returns, puzzles the will,And makes us rather bear those ills we haveThan fly to others that we know not of?Thus conscience does make cowards of us all,And thus the native hue of resolutionIs sicklied o'er with the pale cast of thought,And enterprises of great pitch and momentWith this regard their currents turn awryAnd lose the name of action.",Dm={outside:{onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595910859,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,n)},onClosed:function(e){C.ULS.traceTag(595908701,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,r){if(r&&e%1e3==0){var t="calc.worker.smokeTestOutsideDef.ping: n = "+e;C.ULS.traceTag(595907657,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}return e+1}})}},inside:km},_m=!1,Mm=void 0;function Fm(){null!=Mm&&Mm.close(),_m=!1}var bm=Promise.resolve();function wm(e,r,t,n){return void 0===n&&(n=0),dt(at.CalcWebWorkerTest)?(Fm(),bm=bm.then((function(o){return function(e,r,t,n){return it.__awaiter(this,void 0,void 0,(function(){var o,a,i,u,c,s,f,d=this;return it.__generator(this,(function(h){switch(h.label){case 0:_m=!0,h.label=1;case 1:return h.trys.push([1,8,9,10]),f="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+r+"ms",C.ULS.traceTag(595908687,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),[4,Am([wg.Dedicated,wg.MessageChannel,wg.FunctionCall],Dm)];case 2:if(null==(Mm=h.sent()))throw new Error("could not create any kind of worker");if(!_m)throw new Error("smoke test canceled during worker creation");return f="calc.worker.runSmokeTest: worker created; outside.workerKind = "+Mm.workerKind,C.ULS.traceTag(595907658,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),o=Mm.getImports("talk",["start","memoryTest","ping","logMessage"]),a=Mm.getImports("location",["gridCell"]),[4,o.ping.call(-1,t)];case 3:return i=h.sent(),[4,a.gridCell.call(2,3)];case 4:if(u=h.sent(),0!==i||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+i+", "+u.row+", "+u.col);return n>0&&Mm.workerKind===wg.Dedicated?[4,o.memoryTest.call(n)]:[3,6];case 5:h.sent(),h.label=6;case 6:return o.start.notify(e,r,t),c=Date.now(),[4,$g((function(n){return it.__awaiter(d,void 0,void 0,(function(){var a;return it.__generator(this,(function(i){switch(i.label){case 0:return Date.now()>=c+e?[2,void 0]:n%1e3!=0?[3,3]:(a=ct("calc.worker.runSmokeTest: ping call roundtrip"),[4,o.ping.call(n,!1)]);case 1:return i.sent(),a.stop(),a=ct("calc.worker.runSmokeTest: logMessage notify"),[4,o.logMessage.notify(Lm,!1)];case 2:i.sent(),a.stop(),i.label=3;case 3:return[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 4:return i.sent(),o.ping.notify(n,t),[2,n+1]}}))}))}),0)];case 7:return h.sent(),f="calc.worker.runSmokeTest: success",C.ULS.traceTag(595906821,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,f),[3,10];case 8:return s=h.sent(),_m&&(f="calc.worker.runSmokeTest: failure: "+(null!=s.stack?s.stack:s.message),C.ULS.traceTag(595908702,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,f)),[3,10];case 9:return Fm(),Mm=void 0,[7];case 10:return[2]}}))}))}(e,r,t,n)}))):Promise.resolve()}var Um,Pm=t(1).__assign;function Gm(e){var r,t,n,o=it.__assign({},e,{split:(r=e.split,t=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var o=r(e),a=e===t?0:e.depth;return void 0!==a&&a<n&&(e.split=o,o[0][0].depth=a+1,o[1][0].depth=a+1),o})});return function(e){return xm(o,Qm(o,o.top,e))}}function xm(e,r){return r===Ym||r===qm?r:{setOperations:e,root:r}}function Bm(e,r,t){if(t===Ym)return r;if(t===qm)return t;if(r===Ym)return t;if(r===qm)return r;if(r.isExact&&t.isExact){var n=function(e,r,t){var n=r.pathKey,o=r.key,a=t.key,i=e.compare(o,a);if(void 0!==i)return i<0?t:r;var u=e.union(o,a);if(void 0!==u){var c=e.compare(u,n);return void 0!==c&&0===c?qm:zm(n,u,!0)}return}(e,r,t);if(void 0!==n)return n}var o=Zm(e,r),a=Zm(e,t);return Jm(Bm(e,o.left,a.left),Bm(e,o.right,a.right))}function Vm(e,r,t){if(r===Ym)return r;if(t===Ym)return t;if(r===qm)return t;if(t===qm)return r;if(r.isExact&&t.isExact){var n=function(e,r,t){var n=r.pathKey,o=r.key,a=t.key;if(!e.meets(o,a))return Ym;var i=e.compare(o,a);if(void 0!==i)return i<0?r:t;var u=e.intersect(o,a);if(void 0!==u)return zm(n,u,!0);return}(e,r,t);if(void 0!==n)return n}var o=Zm(e,r),a=Zm(e,t);return Jm(Vm(e,o.left,a.left),Vm(e,o.right,a.right))}function Wm(e,r,t){if(r===Ym||t===Ym)return!1;if(r===qm||t===qm)return!0;if(r.isExact&&t.isExact)return e.meets(r.key,t.key);var n=Zm(e,r),o=Zm(e,t);return Wm(e,n.left,o.left)||Wm(e,n.right,o.right)}function Hm(e,r,t){if(r===Ym)return r;if(t===Ym)return r;if(t===qm)return Ym;if(r===qm){var n=Zm(e,t);return Jm(Hm(e,qm,n.left),Hm(e,qm,n.right))}if(r.isExact&&t.isExact){var o=function(e,r,t){var n=r.pathKey,o=r.key,a=t.key;if(!e.meets(o,a))return r;var i=e.except(o,a);if(void 0!==i)return zm(n,i,!0);return}(e,r,t);if(void 0!==o)return o}var a=Zm(e,r),i=Zm(e,t);return Jm(Hm(e,a.left,i.left),Hm(e,a.right,i.right))}function Km(e,r){if(void 0!==e&&void 0!==r)return 0===e?r:0===r?e:e===r?e:void 0}function jm(e,r,t){if(r===t)return 0;if(r===Ym)return-1;if(t===Ym)return 1;if(r===qm)return t===qm?0:1;if(t===qm)return-1;if(r.isExact&&t.isExact)return function(e,r,t){return e.compare(r.key,t.key)}(e,r,t);var n=Zm(e,r),o=Zm(e,t),a=jm(e,n.left,o.left);if(void 0!==a){var i=jm(e,n.right,o.right);if(void 0!==i)return Km(a,i)}}function Jm(e,r){return e===Ym?r===Ym?Ym:Xm(e,r,void 0,void 0,!1):r===Ym?Xm(e,r,void 0,void 0,!1):e===qm&&r===qm?qm:Xm(e,r,void 0,void 0,!1)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(Um||(Um={}));var qm=Um.Dense,Ym=Um.Empty;function Xm(e,r,t,n,o){return{key:n,pathKey:t,left:e,right:r,isExact:o}}function Qm(e,r,t){if(!e.meets(r,t))return Ym;var n=e.compare(r,t);if(void 0!==n)return n<=0?qm:zm(r,t,!0);var o=e.intersect(r,t);return void 0!==o?zm(r,o,!0):zm(r,t,!1)}function zm(e,r,t){return Xm(void 0,void 0,e,r,!!t)}function Zm(e,r){if(void 0!==r.left)return r;var t=e.split(r.pathKey),n=t[0][0],o=t[1][0],a=Jm(Qm(e,n,r.key),Qm(e,o,r.key));if(a===Ym||a===qm)throw new Error("incorrect set operations implementation");var i=a;return Pm(r,{left:i.left,right:i.right})}function $m(e,r){return e===Ym||function(e,r,t){return function r(n,o){if(o===Ym)return!0;if(o===qm)return t(n);if(o.isExact)return t(o.key);var a=Zm(e,o),i=e.split(n),u=i[0][0],c=i[1][0];return r(u,a.left)&&r(c,a.right)}(e.top,r)}(e.setOperations,e.root,r)}function eE(e,r){var t=e[0],n=e[1],o=r[0],a=r[1];return[pr(t,o),vr(n,a)]}function rE(e,r){var t=e[0],n=e[1],o=r[0],a=r[1];return pr(t,o)<vr(n,a)}function tE(e,r){var t=e[0],n=e[1],o=r[0],a=r[1];return t<o&&a>=n?[t,o]:t>=o&&a<n?[a,n]:void 0}function nE(e,r){var t=e[0],n=e[1],o=r[0],a=r[1];return t===o&&n===a?0:t>=o&&n<=a?-1:t<=o&&n>=a?1:void 0}function oE(e,r,t){var n=function(e,r,t){var n=Math.pow(r,e),o=1-Math.pow(r/t,e),a=Math.pow(t,e),i=a*n,u=a-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/o}:function(r){return(1-n*Math.pow(r,-e))/o},invCdf:1===e?function(e){return 1/((a-e*u)/i)}:function(e){return Math.pow((a-e*u)/i,c)}}}(e,r,t);return{canSplit:function(e){var r=e[0];return e[1]-r>1},split:function(e){var r=e[0],t=e[1],o=n.cdf(t),a=n.cdf(r+1),i=n.invCdf((o+a)/2),u=Math.min(Math.max(Math.round(i),r+1),t-1);return[[[r,u],n.cdf(u)-n.cdf(r+1)],[[u,t],n.cdf(t)-n.cdf(u)]]}}}function aE(e,r,t,n,o){var a=oE(e,r,t);return{id:o,split:function(e){return a.split(e)},canSplit:function(e){return a.canSplit(e)},meets:rE,intersect:eE,union:function(e,r){return n=r,o=(t=e)[0],a=t[1],i=n[0],u=n[1],pr(o,i)<=vr(a,u)?function(e,r){var t=e[0],n=e[1],o=r[0],a=r[1];return[vr(t,o),pr(n,a)]}(e,r):void 0;var t,n,o,a,i,u},except:tE,compare:nE,top:n}}var iE=[{},{}];function uE(e){var r=!0;for(var t in e)if(e.hasOwnProperty(t)){r=!1;break}return r?qm:{isSubspace:!0,bounds:e}}function cE(e,r,t){return{isSubspace:!1,left:e,right:r,bounds:t,subspaceCount:ME(e)+ME(r)}}function sE(e,r){if(r===qm)return r;if(r.isSubspace){var t=!1;for(var n in r.bounds)if(e.hasOwnProperty(n)){t=!0;break}if(!t)return qm}return{productOperations:e,root:r}}var lE,fE={unzip:function(e){var r={},t={};for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];if(o===Ym)return Ym;if(o===qm)continue;r[n]=o.setOperations,t[n]=o.root}return sE(r,uE(t))},combineProduct:function(e,r,t,n){var o={};for(var a in e)if(e.hasOwnProperty(a)){var i=n(e[a],hE(r[a]),hE(t[a]));if(i===Ym)return i;if(i===qm)continue;o[a]=i}return o},restrict:function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n={},o=0,a=r;o<a.length;o++){var i=a[o];if(e.hasOwnProperty(i)){var u=e[i];n[i]=u}}return n},fromUntypedProduct:function(e,r,t){for(var n={},o=0,a=t;o<a.length;o++){var i=a[o],u=r[i];n[i]=xm(e[i],void 0!==u?u:qm)}return n},denseProduct:function(e){for(var r={},t=0,n=e;t<n.length;t++){r[n[t]]=qm}return r}},dE=fE.unzip;function hE(e){return void 0===e?qm:e}function vE(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(e===qm||e===Ym)return e;var n=fE.restrict.apply(fE,[e.productOperations].concat(r)),o=pE.apply(void 0,[n,e.root].concat(r));return o===Ym?o:sE(n,o)}function pE(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=fE.restrict.apply(fE,[r.bounds].concat(t));if(r.isSubspace)return uE(o);var a=pE.apply(void 0,[e,r.left].concat(t));if(a===qm)return qm;var i=pE.apply(void 0,[e,r.right].concat(t));return yE(e,a,i)}function gE(e,r){if(r===Ym)return e;if(r===qm)return r;if(e===Ym)return r;if(e===qm)return e;var t=it.__assign({},e.productOperations,r.productOperations),n=CE(t,e.root,r.root,iE);return n===Ym?n:sE(t,n)}function mE(e,r){if(e===Ym)return e;if(r===Ym)return r;if(e===qm)return r;if(r===qm)return e;var t=it.__assign({},e.productOperations,r.productOperations),n=RE(t,e.root,r.root,iE);return n===Ym?n:sE(t,n)}function EE(e,r){if(e===Ym)return e;if(r===Ym)return e;if(r===qm)return Ym;if(e===qm){var t=IE(r.productOperations,qm,r.root,iE);return t===Ym?t:sE(r.productOperations,t)}var n=it.__assign({},e.productOperations,r.productOperations),o=IE(n,e.root,r.root,iE);return o===Ym?o:sE(n,o)}function SE(e,r){return e===r?0:e===Ym?-1:r===Ym?1:e===qm?r===qm?0:1:r===qm?-1:function e(r,t,n,o){if(t===n)return 0;if(t===Ym)return-1;if(n===Ym)return 1;if(t===qm)return n===qm?0:1;if(n===qm)return-1;if(t.isSubspace&&n.isSubspace)return NE(r,t.bounds,n.bounds);var a=LE(r,o),i=a[0],u=a[1];var c=DE(r,t,i,u),s=c[0],l=c[1];var f=DE(r,n,i,u),d=f[0],h=f[1];var v=e(r,s,d,i);if(void 0===v)return;return Km(v,e(r,l,h,u))}(it.__assign({},e.productOperations,r.productOperations),e.root,r.root,iE)}function TE(e,r){return e!==Ym&&r!==Ym&&(e===qm||r===qm||function e(r,t,n,o){if(t===Ym||n===Ym)return!1;if(t===qm||n===qm)return!0;if(!function(e,r,t){for(var n in e)if(e.hasOwnProperty(n)){var o=hE(r[n]),a=hE(t[n]);if(!Wm(e[n],o,a))return!1}return!0}(r,t.bounds,n.bounds))return!1;if(t.isSubspace&&n.isSubspace)return!0;var a=LE(r,o),i=a[0],u=a[1];var c=DE(r,t,i,u),s=c[0],l=c[1];var f=DE(r,n,i,u),d=f[0],h=f[1];return e(r,s,d,i)||e(r,l,h,u)}(it.__assign({},e.productOperations,r.productOperations),e.root,r.root,iE))}function CE(e,r,t,n){if(t===Ym)return r;if(r===Ym)return t;if(r===qm)return r;if(t===qm)return t;if(r.isSubspace&&t.isSubspace){var o=AE(e,r,t);if(void 0!==o)return o}return kE(e,r,t,n,CE)}function RE(e,r,t,n){if(r===Ym||t===Ym)return Ym;if(r===qm)return t;if(t===qm)return r;if(r.isSubspace&&t.isSubspace){var o=fE.combineProduct(e,r.bounds,t.bounds,Vm);return o===Ym?Ym:uE(o)}return kE(e,r,t,n,RE)}function IE(e,r,t,n){if(r===Ym)return r;if(t===qm)return Ym;if(t===Ym)return r;if(r===qm)return kE(e,r,t,n,IE);if(r.isSubspace&&t.isSubspace){var o=function(e,r,t){var n,o=NE(e,r.bounds,t.bounds);if(0===o||-1===o)return Ym;var a=void 0;for(var i in e)if(e.hasOwnProperty(i)){var u=jm(e[i],hE(r.bounds[i]),hE(t.bounds[i]));if(void 0===u||u>0){if(void 0!==a)return;a=i}}if(void 0!==a){var c=Hm(e[a],hE(r.bounds[a]),hE(t.bounds[a]));if(c===Ym)return Ym;if(c===qm){var s=r.bounds,l=a;s[l];return uE(it.__rest(s,["symbol"==typeof l?l:l+""]))}return uE(it.__assign({},r.bounds,((n={})[a]=c,n)))}return}(e,r,t);if(void 0!==o)return o}return kE(e,r,t,n,IE)}function yE(e,r,t){if(t===Ym)return r;if(t===qm)return t;if(r===Ym)return t;if(r===qm)return r;if(!r.isSubspace||!t.isSubspace)return cE(r,t,OE(e,r.bounds,t.bounds));var n=AE(e,r,t);return void 0!==n?n:cE(r,t,OE(e,r.bounds,t.bounds))}function AE(e,r,t){var n,o=NE(e,r.bounds,t.bounds);if(void 0!==o)return o<=0?t:r;var a=void 0;for(var i in e){if(e.hasOwnProperty(i))if(0!==jm(e[i],hE(r.bounds[i]),hE(t.bounds[i]))){if(void 0!==a)return;a=i}}if(void 0!==a){var u=Bm(e[a],hE(r.bounds[a]),hE(t.bounds[a]));if(u===Ym)return Ym;if(u===qm){var c=r.bounds,s=a;c[s];return uE(it.__rest(c,["symbol"==typeof s?s:s+""]))}return uE(it.__assign({},r.bounds,((n={})[a]=u,n)))}}function NE(e,r,t){var n=0;for(var o in e)if(e.hasOwnProperty(o)){var a=hE(r[o]),i=hE(t[o]);if(void 0===(n=Km(n,jm(e[o],a,i))))return}return n}function OE(e,r,t){var n=fE.combineProduct(e,r,t,Bm);if(n===Ym)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function kE(e,r,t,n,o){var a=LE(e,n),i=a[0],u=a[1],c=DE(e,r,i,u),s=c[0],l=c[1],f=DE(e,t,i,u),d=f[0],h=f[1],v=o(e,s,d,i);return v===qm?qm:yE(e,v,o(e,l,h,u))}function LE(e,r){var t,n,o,a,i,u=r[0],c=r[1],s=void 0,l=0;for(var f in e)if(e.hasOwnProperty(f)){var d=c[f],h=e[f];if(void 0===d){s=f,i=h.top;break}if(d>l){var v=hE(u[f]);if(v===Ym)throw new Error("the key split can never return empty");var p=h.top;if(v!==qm){if(!v.isExact)throw new Error("the key can always be represented exactly");p=v.key}if(!h.canSplit(p))continue;s=f,l=d,i=p}}if(void 0===s||void 0===i)throw new Error("there has to be at least one dimension");var g=e[s],m=g.split(i),E=m[0],S=E[0],T=E[1],C=m[1],R=C[0],I=C[1];return[[it.__assign({},u,(t={},t[s]=Qm(g,g.top,S),t)),it.__assign({},c,(n={},n[s]=T,n))],[it.__assign({},u,(o={},o[s]=Qm(g,g.top,R),o)),it.__assign({},c,(a={},a[s]=I,a))]]}function DE(e,r,t,n){var o=t[0],a=n[0];return[_E(e,r,o),_E(e,r,a)]}function _E(e,r,t){if(t===Ym||r===Ym)return Ym;if(r===qm)return uE(t);var n=NE(e,r.bounds,t);if(void 0!==n&&n<=0)return r;var o=fE.combineProduct(e,r.bounds,t,Vm);return o===Ym?Ym:r.isSubspace?uE(o):yE(e,_E(e,r.left,t),_E(e,r.right,t))}function ME(e){return e.isSubspace?1:e.subspaceCount}!function(e){e[e.Available=0]="Available",e[e.Failure=1]="Failure"}(lE||(lE={}));var FE=[lE.Available,lE.Failure+1],bE=[0,1<<20],wE=[0,16384],UE={availability:aE(1,FE[0]+1,FE[1],FE,"Availability operations, alpha = 1"),row:aE(.2,bE[0]+1,bE[1],bE,"Row operations, alpha = 0.2"),col:aE(.35,wE[0]+1,wE[1],wE,"Col operations, alpha = 0.35")},PE={availability:Gm(UE.availability),row:Gm(UE.row),col:Gm(UE.col)};function GE(e){return dE({row:PE.row([e.row,e.row+e.rows]),col:PE.col([e.col,e.col+e.cols])})}var xE=dE({availability:PE.availability([lE.Available,lE.Available+1])}),BE=dE({availability:PE.availability([lE.Failure,lE.Failure+1])});function VE(e,r){return function(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=vE.apply(void 0,[e].concat(t));if(o===Ym)return!0;if(o===qm)return r(fE.denseProduct(t));var a=o.productOperations;return function e(n){return n.isSubspace?r(fE.fromUntypedProduct(a,n.bounds,t)):e(n.left)&&e(n.right)}(o.root)}(e,(function(e){return function(e,r){return e!==qm?$m(e,r):r(UE.row.top)}(e.row,(function(t){var n=t[0],o=t[1];return function(e,r){return e!==qm?$m(e,r):r(UE.col.top)}(e.col,(function(e){var t=e[0],a=e[1];return r(b(n,t,o-n,a-t))}))}))}),"row","col")}function WE(e,r){return VE(e,(function(e){return Ar(e,r)}))}function HE(e,r,t){if(void 0!==t){var n=e.slice();return n[r]=t,n}var o=e.slice(0,-1);return r<e.length-1&&(o[r]=e[e.length-1]),o}function KE(e,r,t){return{kind:e,key:r,value:t}}function jE(e,r){return KE(1,e,r)}function JE(e,r){return KE(2,e,r)}function qE(e,r){return KE(3,e,r)}var YE=function(){function e(e,r,t){this.lattice=e,this.root=r,this.count=t}return e.create=function(r,t,n,o,a){void 0===a&&(a=2);var i=a>1?Math.ceil(a):1;return new e({keyJoin:r,keyMeets:t,keyCompare:n,keyDistance:o,minChildren:i,maxChildren:2*i,keyGe:function(e,r){var t=n(e,r);return void 0!==t&&t>=0},keyLe:function(e,r){var t=n(e,r);return void 0!==t&&t<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){if(void 0!==this.root)return function r(t,n){var o=t.keyCompare(n.key,e);if(1===n.kind)return 0===o?n.value:void 0;if(!(void 0===o||o<0))for(var a=0,i=n.value;a<i.length;a++){var u=r(t,i[a]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.setValue=function(r,t,n){void 0===n&&(n=function(e){return!0});var o=eS(this.lattice,this.root,r,n,t);return void 0!==o?o===this.root?this:new e(this.lattice,o,this.count):new e(this.lattice,$E(this.lattice,this.root,jE(r,t)),this.count+1)},e.prototype.filter=function(r){var t=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return r(e,n)&&(t=t.setValue(e,n)),!0})),t},e.prototype.contains=function(e,r){return void 0===r&&(r=function(e){return!0}),void 0!==eS(this.lattice,this.root,e,r)},e.prototype.getOrSetValue=function(e,r){var t=this.getValue(e);if(void 0===t){var n=r();return[this.setValue(e,n),n]}return[this,t]},e.prototype.forEach=function(e){XE(this.root,e)},e.prototype.forEachGe=function(e,r){var t=this;XE(this.root,r,(function(r){return t.lattice.keyGe(r,e)}),(function(r){return t.lattice.keyGe(r,e)}))},e.prototype.forEachLe=function(e,r){var t=this;XE(this.root,r,(function(r){return t.lattice.keyMeets(r,e)}),(function(r){return t.lattice.keyLe(r,e)}))},e.prototype.forEachMeets=function(e,r){var t=this;XE(this.root,r,(function(r){return t.lattice.keyMeets(r,e)}),(function(r){return t.lattice.keyMeets(r,e)}))},e.prototype.remove=function(r){var t=this;if(null==this.root)return this;var n=[],o=this.lattice,a=function(e,t){var i=o.keyCompare(e.key,r);if(void 0===i||i<0)return hr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===o.keyCompare(u[c].key,r)){if((h=HE(u,c)).length<t){var s=JE(e.key,h);return n.push(s),hr(s,3)}return hr(JE(zE(o,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=a(u[c],o.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=HE(u,c)).length>=t)return hr(qE(zE(o,h),h),2);s=qE(e.key,h);return n.push(s),hr(s,3)}if(2===d)return hr(qE(e.key,HE(u,c,f)),2)}return hr(e,1)},i=2===this.root.kind?1:2,u=a(this.root,i),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)XE(n[f],(function(e,r){return l=$E(t.lattice,l,jE(e,r)),!0}));return new e(this.lattice,l,this.count-1)},e}();function XE(e,r,t,n){var o=void 0!==t?t:function(){return!0},a=void 0!==n?n:function(){return!0};if(null!=e){var i=function(e){if(!o(e.key))return!0;if(2===e.kind)for(var t=e.value,n=0;n<t.length;n+=1){var u=t[n];if(a(u.key)&&!r(u.key,u.value))return!1}else for(t=e.value,n=0;n<t.length;n+=1)if(!i(t[n]))return!1;return!0};i(e)}}function QE(e,r){for(var t=function(e,r){for(var t=0,n=1,o=e.keyDistance(r[0].key,r[1].key),a=2;a<r.length;a+=1)for(var i=0;i<a;i+=1){var u=e.keyDistance(r[i].key,r[a].key);u>o&&(t=i,n=a,o=u)}return hr(t,n)}(e,r),n=t[0],o=t[1],a=r[n].key,i=r[o].key,u=[],c=0;c<r.length;c+=1){var s=r[c];u.push([s,e.keyDistance(a,s.key)-e.keyDistance(i,s.key)])}u.sort((function(e,r){return e[1]-r[1]}));for(var l=e.minChildren;l<r.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<r.length;c+=1)d.push(u[c][0]);return hr(f,d)}function zE(e,r){for(var t=r[0].key,n=1;n<r.length;n+=1)t=e.keyJoin(t,r[n].key);return t}function ZE(e,r,t){var n=QE(e,t),o=n[0],a=n[1];return hr(KE(r,zE(e,o),o),KE(r,zE(e,a),a))}function $E(e,r,t){if(null==r)return JE(t.key,[t]);var n=function r(n){if(2===n.kind){var o=n.value.concat([t]);if(o.length>e.maxChildren){var a=ZE(e,n.kind,o),i=a[0],u=a[1];return hr(JE(i.key,i.value),u)}return hr(JE(e.keyJoin(n.key,t.key),o),void 0)}var c=n.value.slice(),s=function(e,r,t){for(var n=0,o=e.keyDistance(r[0].key,t),a=r[0].value.length,i=1;i<r.length;i+=1){var u=r[i],c=e.keyDistance(u.key,t);(c<o||c===o&&u.value.length<a)&&(n=i,o=c,a=u.value.length)}return n}(e,c,t.key),l=r(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=ZE(e,n.kind,c),v=h[0];u=h[1];return hr(qE(v.key,v.value),u)}return hr(qE(e.keyJoin(n.key,t.key),c),void 0)}(r),o=n[0],a=n[1];return null!=a?qE(e.keyJoin(o.key,a.key),[o,a]):o}function eS(e,r,t,n,o){if(void 0!==r)return function r(n){if(2!==n.kind)for(o=0;o<n.value.length;o+=1){i=n.value[o];if(e.keyMeets(i.key,t))if(void 0!==(u=r(i)))return qE(n.key,HE(n.value,o,u))}else for(var o=0;o<n.value.length;o+=1){var i,u;if(void 0!==(u=a(i=n.value[o])))return JE(n.key,HE(n.value,o,u))}}(r);function a(r){if(0===e.keyCompare(r.key,t))return void 0!==o&&r.value!==o&&n(r.value)?jE(r.key,o):r}}function rS(e){return{entries:{},keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.entries[this.keyToString(e)];return lr(r)?r.value:void 0},setValue:function(e,r){var t=this.keyToString(e),n=this.entries[t];lr(n)?n.value=r:this.entries[t]=Lp(e,r)},contains:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&null!==this.entries[r]},remove:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var t=this.keyToString(e),n=this.entries[t];if(lr(n))return n.value;var o=r();return delete this.entries[t],this.entries[t]=Lp(e,o),o},forEach:function(e){for(var r in this.entries){var t=this.entries[r];null!=t&&e(t.key,t.value)}},filter:function(e){var r=[];this.forEach((function(t,n){return e(t,n)||r.push(t),!0}));for(var t=0,n=r;t<n.length;t++){var o=n[t];this.remove(o)}}}}function tS(e,r){var t=e.row,n=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols;return pr(t,i)<vr(t+o,i+c)&&pr(n,u)<vr(n+a,u+s)}function nS(e,r){var t=e.row,n=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=t+o,s=i+r.rows,l=n+a,f=u+r.cols;return t===i&&c===s&&n===u&&l===f?0:t<=i&&c>=s&&n<=u&&l>=f?1:t>=i&&c<=s&&n>=u&&l<=f?-1:void 0}function oS(e,r){var t=e.row,n=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols;return gr(t-i+.5*(o-c))+gr(n-u+.5*(a-s))}function aS(){return YE.create(ql,tS,nS,oS)}var iS,uS=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var r=this.getCount()-1;r>0;){var t=r-1>>>1,n=this.items[t];if(!(this.cmp(n,e)>0))break;this.items[r]=n,r=t}this.items[r]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),r=this.items.pop(),t=this.getCount()-1;if(t<0||void 0===r)return e;var n=0;for(this.items[0]=r;n<t;){var o=n,a=1+(n<<1),i=2+(n<<1);if(a<=t&&this.cmp(this.items[a],r)<0&&(o=a),i<=t&&this.cmp(this.items[i],o===a?this.items[o]:r)<0&&(o=i),n===o)break;this.items[n]=this.items[o],n=o}return this.items[n]=r,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var r=0,t=this.items;r<t.length;r++){if(!e(t[r]))return}},e}(),cS=function(){function e(e){this.min=0,this.max=0,this.heap=new uS((function(r,t){var n=r[0],o=r[1],a=t[0],i=t[1],u=e(n,a);return 0!==u?u:o-i}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}();!function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell"}(iS||(iS={}));var sS,lS,fS,dS,hS={calculatedCellCount:0,changedCellCount:0,continueCount:0,recalcFinished:!1};function vS(e,r){switch(r){case sS.ChangedCell:return it.__assign({},e,{changedCellCount:e.changedCellCount+1,calculatedCellCount:e.calculatedCellCount+1});case sS.UnchangedCell:return it.__assign({},e,{calculatedCellCount:e.calculatedCellCount+1});case sS.ContinueComputation:return it.__assign({},e,{continueCount:e.continueCount+1});case sS.RecalcFinished:return it.__assign({},e,{recalcFinished:!0});default:return I("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",r)}}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.RecalcFinished="RecalcFinished"}(sS||(sS={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.ContinueComputation=2]="ContinueComputation",e[e.ComputeCellValue=3]="ComputeCellValue",e[e.MaybeCollectGarbage=4]="MaybeCollectGarbage"}(lS||(lS={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.ExtendAvailableRange="ExtendAvailableRange",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(fS||(fS={})),function(e){e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.RangeFailure="RangeFailure",e.UnloggedFailure="UnloggedFailure",e.UpdateRequest="UpdateRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics"}(dS||(dS={}));var pS=function(e){return e}((function(e,r,t,n){return{isExact:e,iformat:r,category:t,decimals:n}})),gS={fmla:"",source:m.Cell,compiledFmla:void 0},mS={fmla:"",source:m.Range,compiledFmla:void 0};function ES(e,r,t,n){return e.setValue(r,{source:t,fmla:n,compiledFmla:void 0},(function(e){return e.source!==t||e.fmla!==n}))}function SS(e,r){return e.forEachMeets(r,(function(r,t){if(t.fmla.length>0){var n=t.source===m.Cell?gS:mS;e=e.setValue(r,n)}return!0})),e}var TS={values:aS(),formats:aS(),formulae:aS()},CS={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,recalcValuesNodeCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0};function RS(e,r){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+r.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+r.serverFormatsNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+r.serverValuesNodeCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+r.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+r.editedFormatsNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+r.editedValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+r.recalcValuesNodeCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+r.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+r.availabilityHistorySize}}var IS,yS=function(){function e(e,r,t){this.sheet=e,this.sheetId=r,this.stateId=t,this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=this.editedContents=TS,this.recalcValues=this.editedContents.values,this.availability=this.extendedAvailability=Ym}return e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcValues=this.editedContents.values,this.oldAvailabilities[this.stateId]=this.availability,this.availabilityHistorySize+=1,this.stateId=e,this.availability=this.extendedAvailability},e.prototype.checkAvailability=function(e){var r=mE(GE(e),xE),t=SE(this.availability,r);if(void 0===t||t<0)return Ur.Unavailable;var n=mE(GE(e),BE),o=SE(mE(this.availability,n),Ym);return void 0!==o&&o>0?wr.Failure:wr.Success},e.prototype.setAvailable=function(e){this.availability=gE(this.availability,mE(e,xE))},e.prototype.setFailure=function(e){this.availability=gE(this.availability,mE(e,BE))},e.prototype.foreachAvailableCell=function(e){WE(this.availability,e)},e.prototype.tryPromoteAvailability=function(e,r){var t=mE(e,xE),n=this.oldAvailabilities[r];if(void 0===n)return!1;var o=SE(n,t);return void 0!==o&&o>=0&&(this.availability=gE(this.availability,t),!0)},e.prototype.extendAvailability=function(e){var r=mE(e,xE);this.availability=gE(this.availability,r),this.extendedAvailability=gE(this.extendedAvailability,r)},e.prototype.setValues=function(e,r){var t=this;Ar(e,(function(e,n,o){return t.recalcValues=t.recalcValues.setValue(e,function(e){return Array.isArray(e)}(r)?r[n][o]:r),!0}))},e.prototype.tryGetValue=function(e){var r=this.recalcValues.getValue(e);if(void 0!==r)return Wl(r)?void 0:r},e.prototype.tryGetServerValue=function(e){var r=this.serverContents.values.getValue(e);if(void 0!==r)return Wl(r)?void 0:r},e.prototype.setEditFormat=function(e,r){this.editedContents=it.__assign({},this.editedContents,{formats:this.editedContents.formats.setValue(e,r)})},e.prototype.tryGetFormat=function(e){return this.editedContents.formats.getValue(e)},e.prototype.tryGetServerFormat=function(e){return this.serverContents.formats.getValue(e)},e.prototype.tryGetFormula=function(e){var r=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,t){return 0===t.fmla.length||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,r){e&&(this.serverContents=r),this.editedContents=r,this.recalcValues=this.editedContents.values},e.prototype.setCellContents=function(e,r,t,n,o){var a=e?this.serverContents:this.editedContents,i=a.values,u=a.formats,c=a.formulae;void 0!==t&&VE(r,(function(e){return c=SS(c,e),!0})),WE(r,(function(e){return void 0!==t&&(c=ES(c,e,m.Cell,t)),void 0!==o&&(u=u.setValue(e,o)),i=i.setValue(e,n),!0})),this.setContents(e,{values:i,formats:u,formulae:c}),this.setAvailable(r)},e.prototype.setRangeFormula=function(e,r,t){var n=e?this.serverContents:this.editedContents,o=n.values,a=n.formats,i=n.formulae;e||o.forEachLe(r,(function(e,r){return Wl(r)||(o=o.setValue(e,ge)),!0})),i=ES(i=SS(i,r),r,m.Range,t),this.setContents(e,{values:o,formats:a,formulae:i}),this.setAvailable(GE(r))},e.prototype.clearCompiledFormulas=function(){for(var e=0,r=[this.serverContents.formulae,this.editedContents.formulae];e<r.length;e++){r[e].forEach((function(e,r){return r.compiledFmla=void 0,!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(e=this.availability,e===Ym||e===qm?0:ME(e.root))};var e},e.prototype.collectGarbage=function(e){var r=Ym;for(var t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){var n=Number(t);if(n>=e){r=gE(r,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function o(e){return TE(mE(GE(e),xE),r)}this.serverContents={formulae:this.serverContents.formulae.filter(o),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(o)},this.editedContents={formulae:this.editedContents.formulae.filter(o),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(o)},this.recalcValues=this.recalcValues.filter(o)},e}(),AS=1<<20,NS=16384;function OS(e,r){e[r]=(e[r]||0)+1}function kS(e,r,t){return e.push(r.join(".")+": expected "+t),!1}function LS(e,r){return function(t,n,o){return lr(t)&&e(t)||kS(n,o,r)}}function DS(e,r,t,n){for(var o=[],a=r(e,o,[n]),i=0,u=o;i<u.length;i++){OS(t,u[i])}return a}function _S(e){return function(r,t,n){return!!fr(r)||e(r,t,n)}}function MS(e){return function(r,t,n){if(fr(r))return kS(t,n,"non-null object");var o=n.length;try{var a=!0;for(var i in e)n[o]=i,a=a&&e[i](r[i],t,n);return a}finally{n.length=o}}}function FS(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(r,t,n){return e.reduce((function(e,o){return e&&o(r,t,n)}),!0)}}function bS(e){return function(r,t,n){if(!Array.isArray(r))return kS(t,n,"Array");n.push("<index>");try{return r.reduce((function(r,o){return r&&e(o,t,n)}),!0)}finally{n.pop()}}}function wS(e){return"number"==typeof e&&e>-1/0&&e<1/0}function US(e){return(0|e)===e||Math.floor(e)===e}function PS(e,r){return void 0===r&&(r="natural < "+e),LS((function(r){return"number"==typeof r&&r>=0&&r<e&&US(r)}),r)}var GS=LS(wS,"finite number"),xS=LS((function(e){return wS(e)&&US(e)}),"integer"),BS=PS(1/0,"natural"),VS=LS((function(e){return"string"==typeof e}),"string"),WS=LS((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),HS=LS((function(e){return"boolean"==typeof e}),"boolean"),KS=MS({functionId:BS,functionName:WS}),jS=MS({errorType:BS,errorName:WS}),JS={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},qS=MS({iformat:BS,category:LS((function(e){return"string"==typeof e&&!0===JS[e]}),"NumberFormatCategory"),decimals:BS}),YS=MS({sheetId:GS,sheetName:VS}),XS=PS(AS),QS=PS(NS),zS=MS({row:XS,column:QS}),ZS=FS(zS,MS({lastRow:_S(XS),lastColumn:_S(QS)})),$S={number:!0,string:!0,boolean:!0,Blank:!0,Error:!0,Rich:!1},eT=LS((function(e){var r="object"==typeof e?e.kind:typeof e;return"string"==typeof r&&!0===$S[r]}),"supported CellValue"),rT=MS({formulaBarText:_S(VS),value:eT,iformat:BS}),tT=MS({range:ZS,excludeRows:_S(bS(XS)),excludeColumns:_S(bS(QS)),data:_S(rT),fromStateId:_S(xS)}),nT=MS({isSpilled:HS,formulaBarText:LS((function(e){return"string"==typeof e&&"="===e[0]}),"formula text")}),oT=MS({range:ZS,data:_S(nT),fromStateId:_S(xS)});function aT(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var iT,uT=FS(MS({range:ZS,formulaBarText:VS,value:_S(eT),origin:_S(zS)}),LS((function(e){var r=e.formulaBarText,t=e.value;return"string"==typeof r&&aT(r)||lr(t)}),"range edit denoting formula or containing value")),cT=MS({range:ZS,formulaBarText:LS((function(e){return"string"==typeof e&&(0===e.length||aT(e))}),"empty string or text denoting formula")}),sT=((IS={number:!0,string:!0,boolean:!0})[P.Error]=!0,IS[P.Array]=!1,IS[P.Rich]=!1,IS),lT=LS((function(e){var r="object"==typeof e?e.kind:typeof e;return("string"==typeof r||"number"==typeof r)&&!0===sT[r]}),"supported WriteOper");!function(e){e.DocumentLoc="DocumentLoc",e.SheetIndex="SheetIndex",e.SheetId="SheetId",e.GridRange="GridRange",e.CellFormula="CellFormula",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.WorksheetFuncId="WorksheetFuncId"}(iT||(iT={}));var fT=pl,dT=function(){function e(e,r,t){var n;void 0===t&&(t={}),this.refStyle=r,this.schedulerConfig=t,this.computeKind=iS.DependentCell,this.sheets=rS((function(e){return(null==e.path?"":e.path.toLocaleUpperCase())+"["+e.name.toLocaleUpperCase()+"]"})),this.queue=new cS((function(e,r){return e.kind-r.kind})),this.iformats=Up(),this.outputMessageLog=[],this.outputMessagesSent=0,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.computeId=0,this.continueId=0,this.stateEvalTime=0,this.worksheetFuncOverrides={},n=this.createObjects(e),this.parser=n[0],this.analyzer=n[1],this.compiler=n[2],this.evaluator=n[3]}return e.prototype.createObjects=function(e){var r=this,t=L,n=function(e,t){var n=r.sheets.getValue(e);return void 0===n?Kr(fT([{kind:iT.DocumentLoc,document:e}])):Hr(n.sheetIndices[t])},o=function(e,t){var n=e.tryGetValue(t);if(void 0===n){var o=e.tryGetFormula(t);if(void 0===o)return Cl(ge);var a=o[0],i=o[1];if(void 0===i.compiledFmla){var u=i.source,c=i.fmla,s=K(e.sheet,a),l=r.parseFormula(s,u,c),f=r.compileFormula(s,u,l);jr(f)?i.compiledFmla=f:(i.compiledFmla=Kr(fT([{kind:iT.CellFormula,reason:f.reason}])),r.setComputeResult({kind:dS.RangeFailure,stateId:r.stateId,range:{document:e.sheet.document,sheetId:e.sheetId,range:a},reason:f.reason}))}return i.compiledFmla.kind===wr.Success?Rl(j(e.sheet,Dr(o[0]))):void 0}return Cl(n)},a=function(e){return function(t){var n=t.sheet,o=t.range,a=r.tryGetSheetGridBySheetIndex(n);if(void 0===a)return Kr(fT([{kind:iT.SheetIndex,sheet:n}]));var i=a.checkAvailability(o);if(i===Ur.Unavailable)return Kr(fT([{kind:iT.GridRange,range:K(n,o)}]));if(i===wr.Failure)return Kr(Ll(t));var u=e(a,o);return void 0===u?Kr(Ll(t)):Hr(u)}},i=a(o),u=a((function(e,r){var t=new Array(r.rows);return Ar(r,(function(n,a,i){var u=o(e,n);return void 0!==u&&((void 0!==t[a]?t[a]:t[a]=new Array(r.cols))[i]=u,!0)}))?t:void 0})),c=kt(e);return[_u(Dn(c)),ks(qu(c,t,n,(function(e){var t=e.sheet,n=e.range,o=r.tryGetSheetGridBySheetIndex(t);if(void 0===o)return Kr(fT([{kind:iT.SheetIndex,sheet:t}]));if(o.checkAvailability(n)===Ur.Unavailable)return Kr(fT([{kind:iT.GridRange,range:K(t,n)}]));var a=r.tryResolveIformat(o.tryGetFormat(n));return void 0===a.category||void 0===a.decimals?Kr(fT([{kind:iT.NumberFormat,iformat:a.iformat}])):Hr({iformat:a.iformat,category:a.category,decimals:a.decimals})}),(function(e){var t=r.iformats.getValue(e);return void 0===t?Kr(fT([{kind:iT.NumberFormat,iformat:e}])):Hr({iformat:e,category:t.category,decimals:t.decimals})}))),hf(Sl(c,Bs)),ov(Nl(c,Bs,t,n,i,u,(function(e){if("number"==typeof e){if(0!=(or(e).staticPrecs&(x.Time|x.Calc)))return Kr(fT([{kind:iT.WorksheetFuncId,id:e}]));if(void 0!==r.worksheetFuncOverrides[e])return Hr(r.worksheetFuncOverrides[e]);var t=yp(e);return null!=t?Hr(t):Kr(Jr([String(e)]))}return Kr(Jr([g(e)]))}),(function(e){return Kr(fT([{kind:iT.NameLoc,name:e}]))}),(function(e){var t=e.sheet,n=e.range,o=r.tryGetSheetGridBySheetIndex(t);if(void 0===o)return Kr(fT([{kind:iT.SheetIndex,sheet:t}]));var a=o.tryGetFormula(n),i=void 0!==a?a[1].compiledFmla:void 0;return void 0===i?Hr(void 0):i}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);if(void 0!==n){var o=void 0,a=r.tryGetSheetGridBySheetIndex(e.sheet);if(void 0!==a){var i=a.tryGetFormat(e.range);i!==a.tryGetServerFormat(e.range)&&(o=r.tryResolveIformat(i))}r.setComputeResult({kind:dS.CellWrite,stateId:r.stateId,cell:n,value:t,format:o,computeKind:r.computeKind})}}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);void 0!==n&&r.setComputeResult({kind:dS.RangeWrite,stateId:r.stateId,range:n,values:t})}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);void 0!==n&&r.setComputeResult({kind:dS.RangeFailure,stateId:r.stateId,range:n,reason:t})}),(function(){}),(function(){return!1}),this.schedulerConfig))]},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.tryGetSheetGridBySheetId=function(e,r){var t=this.sheets.getValue(e),n=void 0!==t?t.sheets[r]:void 0;if(void 0===n){var o=fT([{kind:iT.SheetId,document:e,sheetId:r}]);this.outputMessageLog.push({kind:dS.UnloggedFailure,stateId:this.stateId,reason:o})}return n},e.prototype.tryGetSheetGridBySheetIndex=function(e){var r=this.sheets.getValue(e.document);if(void 0!==r){var t=r.sheetIds[e.index];if(void 0!==t)return r.sheets[t]}},e.prototype.tryGetSheetId=function(e){var r=this.sheets.getValue(e.document);if(void 0!==r)return r.sheetIds[e.index]},e.prototype.tryGetSheetIdGridRange=function(e){var r=this.tryGetSheetId(e.sheet);if(void 0!==r)return{document:e.sheet.document,sheetId:r,range:e.range};var t=fT([{kind:iT.SheetIndex,sheet:e.sheet}]);this.outputMessageLog.push({kind:dS.UnloggedFailure,stateId:this.stateId,reason:t})},e.prototype.setComputeResult=function(e){var r=e.kind===dS.CellWrite?e.cell:e.range,t=r.document,n=r.sheetId,o=r.range,a=this.tryGetSheetGridBySheetId(t,n);if(void 0===a)throw new Error("setComputeResult: internal error: could not find grid for sheetId "+n);e.kind===dS.RangeFailure?(a.setFailure(GE(o)),a.setValues(o,ge),this.outputMessageLog.push(e)):e.kind===dS.CellWrite?(a.setValues(o,e.value),a.tryGetServerValue(e.cell.range)!==e.value||void 0!==e.format?(this.outputMessageLog.push({kind:dS.RecalcStatistics,message:sS.ChangedCell,stateId:this.stateId}),this.outputMessageLog.push(e)):this.outputMessageLog.push({kind:dS.RecalcStatistics,message:sS.UnchangedCell,stateId:this.stateId})):(a.setValues(o,e.values),this.outputMessageLog.push(e))},e.prototype.handleSetCellContents=function(e,r){var t=this,n=r.cells,o=r.fmla,a=r.value,i=r.format,u=n.document,c=n.sheetId,s=n.set,l=this.tryGetSheetGridBySheetId(u,c);void 0!==l&&(l.setCellContents(e,s,o,a,i),e||(WE(s,(function(e){if(void 0!==o&&aT(o)){var r={document:u,sheetId:c,range:e};t.inferCellFormat(r),t.computeCellValue(r,iS.EditedCell)}return!0})),l.foreachAvailableCell((function(e){var r=l.tryGetFormula(e);return void 0!==r&&void 0!==r[1].fmla&&aT(r[1].fmla)&&(t.computeCellValue({document:u,sheetId:c,range:e},iS.DependentCell),l.setValues(e,ge)),!0}))))},e.prototype.handleSetRangeFormula=function(e,r){var t=r.range,n=r.fmla,o=t.document,a=t.sheetId,i=t.range,u=this.tryGetSheetGridBySheetId(o,a);void 0!==u&&(u.setRangeFormula(e,i,n),!e&&n.length>0&&this.computeCellValue({document:o,sheetId:a,range:Dr(i)},iS.EditedCell))},e.prototype.withEvalTiming=function(e){var r=this.schedulerConfig.totalTimeMs;if(void 0===r)return e();var t=Sr();try{return e()}finally{this.stateEvalTime+=pr(1,Sr()-t),this.stateEvalTime>=r&&(this.computeId+=1,this.continueId+=1)}},e.prototype.handleComputeCellValue=function(e){var r=this,t=e.cell,n=e.computeKind;this.computeKind=n;var o=this.tryGetSheetGridBySheetId(t.document,t.sheetId);if(void 0!==o&&void 0===o.tryGetValue(t.range)&&void 0!==o.tryGetFormula(t.range)){var a=this.withEvalTiming((function(){return r.evaluator.evalCells([j(o.sheet,t.range)])}));Array.isArray(a)||this.continueComputation(a.resume,n)}},e.prototype.handleContinueComputation=function(e){var r=e.resume,t=e.computeKind;this.computeKind=t,this.outputMessageLog.push({kind:dS.RecalcStatistics,stateId:this.stateId,message:sS.ContinueComputation});var n=this.withEvalTiming(r);Array.isArray(n)||this.continueComputation(n.resume,t)},e.prototype.handlePromoteCellContents=function(e){var r=e.cells,t=e.range,n=e.fromStateId,o=this.tryGetSheetGridBySheetId(r.document,r.sheetId);void 0!==o&&(o.tryPromoteAvailability(r.set,n)||this.outputMessageLog.push({kind:dS.UpdateRequest,range:t}))},e.prototype.setCellContents=function(e,r,t,n,o,a){this.queue.enqueue({kind:e,message:{kind:fS.SetCellContents,cells:t,fmla:n,value:o,format:a},stateId:r})},e.prototype.writeCellContents=function(e,r,t,n,o){void 0===o&&(o=0);var a=pS(!0,o);this.setCellContents(lS.ServerUpdate,e,r,t,n,a)},e.prototype.editCellContents=function(e,r,t,n,o){void 0===n&&(n=ge),void 0===o&&(o=Dr(r.range));var a=it.__assign({},r,{set:GE(r.range)});this.setCellContents(lS.ClientEdit,e,a,t,n,void 0)},e.prototype.setArrayFormula=function(e,r,t,n){this.queue.enqueue({kind:e,message:{kind:fS.SetRangeFormula,range:t,fmla:n},stateId:r})},e.prototype.writeArrayFormula=function(e,r,t,n){void 0===n&&(n=!1),this.setArrayFormula(lS.ServerUpdate,e,r,t)},e.prototype.editArrayFormula=function(e,r,t){this.setArrayFormula(lS.ClientEdit,e,r,t)},e.prototype.promoteCellContents=function(e,r,t,n){this.queue.enqueue({kind:lS.ServerUpdate,message:{kind:fS.PromoteCellContents,cells:t,fromStateId:n,range:r},stateId:e})},e.prototype.computeCellValue=function(e,r){this.queue.enqueue({kind:lS.ComputeCellValue,stateId:this.stateId,computeId:this.computeId,cell:e,computeKind:r})},e.prototype.continueComputation=function(e,r){this.queue.enqueue({kind:lS.ContinueComputation,stateId:this.stateId,continueId:this.continueId,resume:e,computeKind:r})},e.prototype.inferCellFormat=function(e){var r=this.tryGetSheetGridBySheetId(e.document,e.sheetId);if(void 0!==r&&"General"===this.tryResolveIformat(r.tryGetFormat(e.range)).category){var t=r.tryGetFormula(e.range);if(void 0!==t){var n=t[1],o=n.source,a=n.fmla,i=K(r.sheet,t[0]),u=this.parseFormula(i,o,a);if(void 0===t[1].compiledFmla){var c=this.compileFormula(i,o,u);jr(c)&&(t[1].compiledFmla=c)}if(u.kind===wr.Success){var s=u.value,l=this.analyzer.findBestFormat(j(r.sheet,e.range),s);if(jr(l)){var f=l.value,d=f.category,h=f.iformat,v=f.decimals,p=this.iformats.getValue(h),g=void 0!==p&&d===p.category&&v===p.decimals;r.setEditFormat(e.range,{isExact:g,iformat:h,category:d,decimals:v})}}}}},e.prototype.tryResolveIformat=function(e){var r=void 0!==e?e:pS(!0,Bu.General);if(r.isExact&&(void 0===r.category||void 0===r.decimals)){var t=this.iformats.getValue(r.iformat);void 0!==t&&(r.category=t.category,r.decimals=t.decimals)}return r},e.prototype.parseFormula=function(e,r,t){var n=this.parser.parseFormula(this.refStyle,e,r,t);if(!jr(n))return n;var o=this.analyzer.checkFormula(e,r,n.value);return Cr(o)?Hr(o):Kr(Tl("calc.PartialWorkbook.parseFormula: expected well-formed formula; given "+g(t)))},e.prototype.compileFormula=function(e,r,t){if(t.kind!==wr.Success)return t;var n=this.compiler.compileFormula(e,r,t.value);return n.kind!==wr.Success?n:Hr(Il(e,r,n.value))},e.prototype.step=function(){var e=this.queue.pop();if(void 0===e)return{queueEmpty:!0,messages:[]};this.trySetStateId(e)&&this.handleMessage(e);var r=this.queue.peek();e.kind===lS.ServerUpdate||e.kind===lS.MaybeCollectGarbage||void 0!==r&&r.kind!==lS.MaybeCollectGarbage||this.outputMessageLog.push({kind:dS.RecalcStatistics,message:sS.RecalcFinished,stateId:this.stateId});var t=this.outputMessageLog.slice(this.outputMessagesSent);return this.outputMessagesSent=this.outputMessageLog.length,{queueEmpty:0===this.queue.getCount(),messages:t}},e.prototype.trySetStateId=function(e){var r=this;return e.kind===lS.MaybeCollectGarbage||!(e.stateId<this.stateId||e.kind===lS.ComputeCellValue&&e.computeId<this.computeId||e.kind===lS.ContinueComputation&&e.continueId<this.continueId)&&(e.stateId>this.stateId&&(this.stateId=e.stateId,this.sheets.forEach((function(e,t){for(var n in t.sheets){if(t.sheets.hasOwnProperty(n))t.sheets[n].advanceState(r.stateId)}return!0})),e.kind===lS.ServerUpdate?(this.computeId+=1,this.continueId+=1):e.kind===lS.ClientEdit&&(this.continueId+=1),this.stateEvalTime=0,this.outputMessageLog=[],this.stateChangesSinceLastGC+=1,this.queue.enqueue({kind:lS.MaybeCollectGarbage})),!0)},e.prototype.handleMessage=function(e){switch(e.kind){case lS.ServerUpdate:case lS.ClientEdit:switch(e.message.kind){case fS.SetCellContents:return this.handleSetCellContents(e.kind===lS.ServerUpdate,e.message);case fS.SetRangeFormula:return this.handleSetRangeFormula(e.kind===lS.ServerUpdate,e.message);case fS.PromoteCellContents:return this.handlePromoteCellContents(e.message);case fS.SetRefStyle:return this.handleSetRefStyle(e.message.refStyle);case fS.SetSheetNames:return this.handleSetSheetNames(e.message.document,e.message.sheetNames);case fS.SetLocaleInfo:return this.handleSetLocaleInfo(e.message.localeInfo);case fS.ExtendAvailableRange:return this.handleExtendAvailableRange(e.message.range);default:return I("calc.calc.partialWorkbook.handleMessage",e.message)}case lS.ComputeCellValue:return this.handleComputeCellValue(e);case lS.ContinueComputation:return this.handleContinueComputation(e);case lS.MaybeCollectGarbage:return this.maybeCollectGarbage();default:return I("calc.calc.partialWorkbook.handleMessage",e)}},e.prototype.setSheetNames=function(e,r,t){this.queue.enqueue({kind:lS.ServerUpdate,stateId:t,message:{kind:fS.SetSheetNames,document:e,sheetNames:r}})},e.prototype.handleSetSheetNames=function(e,r){for(var t={},n={},o={},a=this.sheets.getValue(e),i=0;i<r.length;i+=1){var u=r[i];t[i]=u.sheetId,n[u.sheetName]=i;var c=void 0===a?void 0:a.sheets[u.sheetId];void 0===c?o[u.sheetId]=new yS(M(e,i),u.sheetId,this.stateId):(c.sheet=M(e,i),o[u.sheetId]=c)}this.sheets.setValue(e,{sheetIds:t,sheetIndices:n,sheets:o}),this.computeId+=1,this.continueId+=1},e.prototype.clearCompiledFormulas=function(){this.sheets.forEach((function(e,r){for(var t in r.sheets){if(r.sheets.hasOwnProperty(t))r.sheets[t].clearCompiledFormulas()}return!0})),this.computeId+=1,this.continueId+=1},e.prototype.setRefStyle=function(e,r){this.queue.enqueue({kind:lS.ServerUpdate,stateId:r,message:{kind:fS.SetRefStyle,refStyle:e}})},e.prototype.handleSetRefStyle=function(e){this.refStyle!==e&&(this.refStyle=e,this.clearCompiledFormulas())},e.prototype.setLocaleInfo=function(e,r){this.queue.enqueue({kind:lS.ServerUpdate,stateId:r,message:{kind:fS.SetLocaleInfo,localeInfo:e}})},e.prototype.handleSetLocaleInfo=function(e){var r;r=this.createObjects(e),this.parser=r[0],this.analyzer=r[1],this.compiler=r[2],this.evaluator=r[3],this.clearCompiledFormulas()},e.prototype.setNumberFormats=function(e,r){var t=this;r||(this.iformats=Up()),e.forEach((function(e){t.iformats.setValue(e.iformat,e)}))},e.prototype.setUsedRanges=function(e,r){},e.prototype.extendAvailableRange=function(e,r){this.queue.enqueue({kind:lS.ServerUpdate,stateId:r,message:{kind:fS.ExtendAvailableRange,range:e}})},e.prototype.handleExtendAvailableRange=function(e){var r=this.tryGetSheetGridBySheetId(e.document,e.sheetId);void 0!==r&&r.extendAvailability(GE(e.range))},e.prototype.getStatistics=function(){var e=[];return this.sheets.forEach((function(r,t){for(var n in t.sheets)if(t.sheets.hasOwnProperty(n)){var o=t.sheets[n];void 0!==o&&e.push(o.getStatistics())}return!0})),{queueSize:this.queue.getCount(),totalGridStatistics:e.reduce(RS,CS)}},e.prototype.maybeCollectGarbage=function(){if(!(this.stateChangesSinceLastGC<17)){var e=this.stateId-17;this.sheets.forEach((function(r,t){for(var n in t.sheets)if(t.sheets.hasOwnProperty(n)){var o=t.sheets[n];void 0!==o&&o.collectGarbage(e)}return!0})),this.outputMessageLog.push({kind:dS.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}},e}();function hT(e){return new Promise((function(r){return setTimeout(r,e)}))}function vT(e,r){var t=r&&r.timeThreshold||10,n=r&&r.costThreshold||1,o=r&&r.macrotaskDelay||0,a={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},i=Qg(),u=i[0],c=i[1],s=c[0],l=c[1];var f=!0;var d=hT(o),h=Sr();return function r(){if(!f||!function(){try{for(var r=0;r<n;){a.iterations+=1;var t=e();if(void 0===t)return!1;r+=t}return!0}catch(e){return l(e),!1}}())return s();var i=Sr();i-h<t?(Promise.resolve().then(r),a.microtaskContinues+=1):(d.then((function(){d=hT(o),h=Sr(),a.macrotaskTotalDelay+=h-i,r()})),a.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:a}}function pT(e,r){var t=function(e,r){var t=Kt().slice();return e.filter((function(e){return DS(e,KS,r,"localeData.worksheetFunctionNames.<index>")})).forEach((function(e){return t[e.functionId]=e.functionName})),jt(t)}(e.worksheetFunctionNames,r),n=t.getWorksheetFuncId,o=t.getWorksheetFuncName,a=function(e,r){var t=Vt.slice();return e.filter((function(e){return DS(e,jS,r,"localeData.errorTypeNames.<index>")})).forEach((function(e){return t[e.errorType]=e.errorName})),t}(e.errorTypeNames,r);return it.__assign({},e,{parseNumber:wt,formatNumber:Ut,getWorksheetFuncId:n,getWorksheetFuncName:o,isNumeral:Pt,getOrdinal:Gt,getNumeral:xt,isLetter:Bt,stringCompareCI:mr,errorNames:a})}function gT(e,r){return fr(r)?{index:e,length:1}:{index:e,length:gr(r-e)+1}}function mT(e,r){var t=gT(r.row,r.lastRow),n=t.index,o=t.length,a=gT(r.column,r.lastColumn),i=b(n,a.index,o,a.length);return{document:e,sheetId:r.sheetId,range:i}}function ET(e,r,t){return{document:e.document,sheetId:e.sheetId,set:function(e,r,t){var n=IT(e.row,e.rows,CT,r),o=IT(e.col,e.cols,RT,t),a=gE(n,o);return mE(GE(e),(i=a,EE(qm,i)));var i}(e.range,r,t)}}function ST(e){return TT(e)?Ng(e.sheetId,e.range.row,e.range.col):Ng(e.sheetId,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function TT(e){return Rr(e.range)}function CT(e,r){return void 0===r&&(r=1),b(e,0,r,NS)}function RT(e,r){return void 0===r&&(r=1),b(0,e,AS,r)}function IT(e,r,t,n){var o=Ym;if(fr(n))return o;for(var a=0,i=n;a<i.length;a++){var u=i[a];e<=u&&u<e+r&&(o=gE(o,GE(t(u))))}return o}function yT(e){if("object"!=typeof e)return e;switch(e.kind){case"Blank":return ge;case"Error":return Q(e.type);default:return}}var AT,NT=function(){function e(e,r,t,n,o){void 0===n&&(n=10),void 0===o&&(o=1e4),this.onRecalcResults=e,this.onUpdateRequest=r,this.onGC=t,this.timeslice=n,this.stateEvalTimeout=o,this.document=L(void 0,"RecalcServiceBook"),this.localeInfo=Jt(),this.refStyle=se.A1,this.currentStateId=-1,this.recalcStatistics=hS,this.failures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.dataModel=new dT(this.localeInfo,this.refStyle,{yieldIntervalMs:this.timeslice,totalTimeMs:this.stateEvalTimeout})}return e.prototype.setStateId=function(e){var r=e-this.currentStateId;return r<0?r:(r>0&&(this.logFailureStats(),this.logIgnoredInputStats(),this.logIgnoredOutputStats(),this.logRecalcStats()),this.currentStateId=e,r)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.clearAsyncResumeRecalc();var r=ct("calc.calc.RecalcService");return this.recalcLoop=vT((function(){var r=e.dataModel.step(),t=r.messages,n=r.queueEmpty;return t.length>0&&e.processRecalcResults(t),n?void 0:1}),{costThreshold:1,timeThreshold:this.timeslice}),this.recalcLoop.promise.then((function(){e.recalcLoop=void 0,r.stop()}))},e.prototype.processRecalcResults=function(e){for(var r=[],t=[],n=[],o=[],a=!1,i=0,u=e;i<u.length;i++){var c=u[i];switch(c.kind){case dS.CellWrite:var s=c.cell,l=c.value,f=c.format,d=c.computeKind,h=s.sheetId,v=s.range,p=this.cellWriteToRangeDelta(h,v.row,v.col,l,f,"messages.<index>.value");lr(p)&&(d===iS.EditedCell?r:t).push(p);break;case dS.RangeWrite:var g=c.range,m=c.values;h=g.sheetId,v=g.range;t.push.apply(t,this.rangeWriteToRangeDeltas(h,v,m,"messages.<index>.values"));break;case dS.RangeFailure:case dS.UnloggedFailure:this.failures.push(c);break;case dS.UpdateRequest:o.push(ST(c.range));break;case dS.GarbageCollected:this.onGC(c.minStateIdKept);break;case dS.RecalcStatistics:a=a||c.message===sS.RecalcFinished,this.recalcStatistics=vS(this.recalcStatistics,c.message);break;default:return I("calc.calc.RecalcServiceImpl.processRecalcResults",c)}}o.length>0&&this.onUpdateRequest(qg(o,[])),(r.length>0||n.length>0)&&this.sendRecalcResults("Edited",r,n),t.length>0&&this.sendRecalcResults("Dependents",t,[]),a&&this.onRecalcResults(Jg(this.currentStateId,"Dependents",!0,[],[]))},e.prototype.sendRecalcResults=function(e,r,t){for(var n=0;n<Math.max(r.length,t.length);n+=10)this.onRecalcResults(Jg(this.currentStateId,e,!1,r.slice(n,n+10),t.slice(n,n+10)))},e.prototype.logFailureStats=function(){if(0!==this.failures.length)try{for(var e={},r=0,t=this.failures;r<t.length;r++){var n=t[r],o=n.stateId,a=n.reason,i=e[o]=e[o]||{};if(a.kind===El.NotImplemented)for(var u=0,c=a.features;u<c.length;u++){var s=c[u];OS(i,El.NotImplemented+" "+s)}else if(a.kind===El.Unavailable)for(var f=0,d=a.objects;f<d.length;f++){var h=d[f],v=[El.Unavailable];if("string"==typeof h.kind&&h.kind in iT){var p=h;switch(v.push(p.kind),p.kind){case iT.SheetIndex:v.push(p.sheet.index);break;case iT.SheetId:v.push(p.sheetId);break;case iT.WorksheetFuncId:v.push(p.id)}}else v.push(JSON.stringify(h));OS(i,v.join(" "))}else OS(i,a.kind);if(a.kind!==El.JavaScriptError);else{var g="calc.calc.RecalcService: recalc JavaScript error: "+(null!=a.error.stack?a.error.stack:a.error.message);C.ULS.traceTag(595658721,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,g)}}Object.getOwnPropertyNames(e).map(Number).sort((function(e,r){return e-r})).forEach((function(r){var t="calc.calc.RecalcService: recalc failures; "+("stateId = "+r+", stats = "+JSON.stringify(e[r]));C.ULS.traceTag(595658722,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}))}finally{this.failures=[]}},e.prototype.logIgnoredStats=function(e,r,t){if(0!==Object.getOwnPropertyNames(t).length){var n="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+this.currentStateId+", stats = "+JSON.stringify(t));C.ULS.traceTag(e,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,n)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){var e="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentStateId+", stats = "+JSON.stringify(this.recalcStatistics));C.ULS.traceTag(595654593,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,e),this.recalcStatistics=hS},e.prototype.cellWriteToRangeDelta=function(e,r,t,n,o,a){if(DS(n,lT,this.ignoredOutputStats,a)){var i=function(e){if("object"!=typeof e)return e;switch(e.kind){case P.Error:return Rg(e.type);default:return}}(n),u=function(e){if(void 0!==e)return Vg(e.isExact,e.iformat,!1,e.category,e.decimals)}(o);return lr(void 0)||lr(i)||lr(u)?Hg(Ng(e,r,t),Wg(void 0,i,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,r,t,n){for(var o=n+".<index>.<index>",a=r.row,i=r.col,u=r.rows,c=r.cols,s=[],l=0;l<u;l+=1)for(var f=0;f<c;f+=1){var d=this.cellWriteToRangeDelta(e,a+l,i+l,t[l][f],void 0,o);lr(d)&&s.push(d)}return s},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?se.A1:se.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=pT(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentStateId)},e.prototype.setNumberFormats=function(e,r){var t=this;this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(e.filter((function(e){return DS(e,qS,t.ignoredInputStats,"numberFormats.<index>")})),r)},e.prototype.setSheetNames=function(e){var r=this;this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,e.filter((function(e){return DS(e,YS,r.ignoredInputStats,"sheetNames.<index>")})),this.currentStateId)},e.prototype.setUsedRanges=function(e,r){var t=this;this.clearAsyncResumeRecalc(),this.dataModel.setUsedRanges(e.filter((function(e){return DS(e,ZS,t.ignoredInputStats,"usedRanges.<index>")})).map((function(e){return mT(t.document,e)})),r)},e.prototype.updateRanges=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,o=r.filter((function(e){return DS(e,tT,t.ignoredInputStats,"rangeUpdates.<index>")}));n<o.length;n++){var a=o[n],i=a.range,u=a.excludeRows,c=a.excludeColumns,s=a.data,l=a.fromStateId,f=mT(this.document,i),d=ET(f,u,c),h=lr(s)?yT(s.value):ge;if(void 0!==h){var v=lr(s)?s.iformat:0;if(lr(s)||fr(l)){var p=fr(s)?"":lr(s.formulaBarText)?s.formulaBarText:void 0;this.dataModel.writeCellContents(e,d,p,h,v)}else this.dataModel.promoteCellContents(e,f,d,l)}}}},e.prototype.updateArrays=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,o=r.filter((function(e){return DS(e,oT,t.ignoredInputStats,"arrayUpdates.<index>")}));n<o.length;n++){var a=o[n],i=a.range,u=a.data,c=a.fromStateId,s=mT(this.document,i);if(lr(u)){var l=u.formulaBarText,f=u.isSpilled;this.dataModel.writeArrayFormula(e,s,l,f)}else lr(c)}}},e.prototype.editRangeFormulas=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,o=r.filter((function(e){return DS(e,uT,t.ignoredInputStats,"rangeFormulaEdits.<index>")}));n<o.length;n++){var a=o[n],i=a.range,u=a.formulaBarText,c=a.value,s=a.origin,l=mT(this.document,i);if(TT(l)){var f=lr(s)?w(s.row,s.column):void 0,d=void 0;if(lr(c)){if(void 0===(d=yT(c)))continue}else d=void 0;this.dataModel.editCellContents(e,l,u,d,f)}else OS(this.ignoredInputStats,"rangeFormulaEdits.<index>.range: expected single cell")}}},e.prototype.editArrayFormulas=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,o=r.filter((function(e){return DS(e,cT,t.ignoredInputStats,"arrayFormulaEdits.<index>")}));n<o.length;n++){var a=o[n],i=a.range,u=a.formulaBarText,c=mT(this.document,i);this.dataModel.editArrayFormula(e,c,u)}}},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new dT(this.localeInfo,this.refStyle,{yieldIntervalMs:this.timeslice,totalTimeMs:this.stateEvalTimeout}),this.currentStateId=-1},e.prototype.testAdvanceState=function(e){this.setStateId(e)<0||this.clearAsyncResumeRecalc()},e.prototype.testDelay=function(e){return it.__awaiter(this,void 0,void 0,(function(){return it.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){return setTimeout(r,e)}))];case 1:return r.sent(),[2]}}))}))},e}();function OT(){return{onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595658753,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)},onInit:function(e){var r=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),t=r.onRecalcResults,n=r.onUpdateRequest,o=r.onGC;e.setExports("service",new NT(t.notify,n.notify,o.notify))},scriptName:"excelOnlineRecalcService.worker"}}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(AT||(AT={}));var kT=function(e){return void 0===e&&(e=AT.Thread),it.__awaiter(this,void 0,void 0,(function(){var r,t,n,o,a,i,u;return it.__generator(this,(function(c){switch(c.label){case 0:return r=!1,t={outside:{onError:function(e,t){var n=null!=t.error.stack?t.error.stack:t.error.message,o="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:n});C.ULS.traceTag(595658719,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,o),t.closing&&(r=!0)},onClosed:function(e){var t="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(r?"because of an error":"normally");C.ULS.traceTag(595658720,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,t)}},inside:OT()},[4,Am(e===AT.Thread?[wg.Dedicated]:e===AT.Local?[wg.FunctionCall]:[wg.Dedicated,wg.FunctionCall],t)];case 1:if(null==(n=c.sent()))throw new Error("could not create recalc service worker");return o="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,C.ULS.traceTag(595731987,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,o),a=-1/0,i={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){a=e}},n.setExports("client",i),u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","setUsedRanges","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","clearCache","testAdvanceState","testDelay"]),[2,{setOnRecalcResults:function(e){i.onRecalcResults=e},setOnUpdateRequest:function(e){i.onUpdateRequest=e},setA1ReferenceStyle:function(e){r||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){r||u.setLocale.notify(e)},setNumberFormats:function(e,t){r||u.setNumberFormats.notify(e,t)},setSheetNames:function(e){r||u.setSheetNames.notify(e)},setUsedRanges:function(e,t){r||u.setUsedRanges.notify(e,t)},updateRanges:function(e,t){r||u.updateRanges.notify(e,t)},updateArrays:function(e,t){r||u.updateArrays.notify(e,t)},editRangeFormulas:function(e,t){r||u.editRangeFormulas.notify(e,t)},editArrayFormulas:function(e,t){r||u.editArrayFormulas.notify(e,t)},resumeRecalc:function(){r||u.resumeRecalc.notify()},clearCache:function(){r||u.clearCache.notify()},testAdvanceState:function(e){r||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return r?Promise.resolve():u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=a}}]}}))}))},LT=function(){function e(e){this.kind=0,this.result=e}return e.prototype.failed=function(e){throw C.ULS.traceTag(595910681,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"DataCell.failed: Calc.ts cannot fail at handling just data."),"DataCell.failed: Calc.ts cannot fail at handling just data."},e}(),DT=new LT(ge),_T=function(){function e(e){this.kind=1,this.raw=e,this.ir=void 0}return e.prototype.parsed=function(e){this.ir=e},e.prototype.analysed=function(e){this.ir=e},e.prototype.compiled=function(e){this.ir=e},e.prototype.failed=function(e,r,t){return new MT(this.raw,e,r,t)},e}(),MT=function(){function e(e,r,t,n){this.kind=2,this.phase=r,this.formulaText=e,this.reason=t,this.details=n}return e.prototype.failed=function(e){return C.ULS.traceTag(595910682,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Failed.failed: Calc.ts will not attempt at working with a FailedFormula"),this},e}(),FT=function(){function e(){this.table=Dp(Fp,bp),this.usedRange=void 0}return e.prototype.getCellContents=function(e){var r=this.table.getValue(e);return void 0===r?DT:r},e.prototype.setCellContents=function(e,r){if(this.table.setValue(e,r),void 0===this.usedRange)this.usedRange={row:e.range.row,column:e.range.col};else{var t=this.usedRange,n=t.row,o=t.column;this.usedRange={row:Math.max(e.range.row,n),column:Math.max(e.range.col,o)}}},e.prototype.forEach=function(e){this.table.forEach(e)},e.prototype.getUsedRange=function(){return this.usedRange},e}(),bT=function(){function e(e,r){this.workbook=e,this.grid=new FT,this.name=r}return e.prototype.updateGrid=function(e,r){this.grid.setCellContents(e,new _T(r))},e.prototype.upgradeGridWithValue=function(e,r){this.grid.setCellContents(e,new LT(r))},e.prototype.parse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.parse: didn't find a formula to parse.");var t=r;if(void 0!==t.ir)return Kr("Sheet.parse: formula has been parsed already.");var n=this.workbook.parser.parseFormula(this.workbook.isA1RefStyle?se.A1:se.R1C1,e,m.Cell,t.raw);return n.kind===wr.Failure?(this.grid.setCellContents(e,t.failed(0)),Kr("Sheet.parse: parsing of failed.")):n.value.node.kind===he.Bad?(this.grid.setCellContents(e,r.failed(0)),Kr("Sheet.parse: parsing of formula failed (bad formula).")):(t.parsed(n.value),Hr(n.value))},e.prototype.analyse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.analyse: didn't find a formula to analyse.");var t=r,n=t.ir;if(void 0===n||void 0===n.node)return Kr("Sheet.analyse: didn't find AST in this cell.");var o=this.workbook.analyzer.checkFormula(e,m.Cell,n);return Cr(o)?(t.analysed(o),Hr(o)):(this.grid.setCellContents(e,r.failed(1)),Kr("Sheet.analyse: formula is not well-formed."))},e.prototype.compile=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.compile: didn't find a formula to compile.");var t=r,n=t.ir;if(void 0===n||!0!==n.isWellFormed)return Kr("Sheet.compile: didn't find a well-formed formula in this cell.");var o=this.workbook.compiler.compileFormula(e,m.Cell,n);return o.kind!==wr.Success?(this.grid.setCellContents(e,r.failed(3)),Kr("Sheet.compile: formula can't be compiled.")):(t.compiled(o.value),Hr(o.value))},e.prototype.evaluate=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.evaluate: didn't find a formula to evaluate.");if(void 0===r.ir)return Kr("Sheet.evaluate: didn't find a compiled term in this cell.");var t=this.workbook.evaluator.evalCells([e]);if(!(t instanceof Array)){if(t.kind===wr.Paused)return Kr("Sheet.evaluate: evaluator didn't meet deadline");throw Kr("Sheet.evaluate: something went wrong in the data model.")}var n=t[0];if(n.kind!==wr.Success)switch(this.grid.setCellContents(e,r.failed(3,n.reason.kind,n.reason)),n.reason.kind){case"NotImplemented":return Kr("Sheet.evaluate: unimplemented functions :: "+n.reason.features);case"JavaScriptError":return Kr("Sheet.evaluate: javascript error :: "+n.reason.error);case"NameCycle":return Kr("Sheet.evaluate: name cycle :: "+n.reason.names);case"CellCycle":return Kr("Sheet.evaluate: cell cycle :: "+n.reason.cells);default:return Kr("Sheet.evaluate: failed :: "+n.reason)}return Wl(n.value)?Hr(0):Hr(n.value)},e}();function wT(e){return function(r,t){return e.documentLocation}}function UT(e){return function(r,t){return Hr(e.getSheetId(t))}}function PT(e,r){var t=e.worksheets.getValue(r.sheet.index);if(void 0!==t){var n=t.grid.getCellContents(r);if(2===n.kind){var o=e.expectedValue(r);return void 0!==o?Cl(o):void 0}return 0===n.kind?Cl(n.result):Rl(r)}}function GT(e){return function(r){var t=PT(e,r);return void 0===t?Kr(Ll(r)):Hr(t)}}function xT(e,r,t){return function(n){var o=n.sheet,a=n.range,i=a.row,u=a.col,c=a.rows,s=a.cols;if(c*s>r*t)return Hr([]);if(void 0!==e.worksheets.getValue(o.index)){for(var l=[],f=i;f<i+c;f+=1){for(var d=[],h=u;h<u+s;h+=1){var v=j(o,w(f,h)),p=PT(e,v);if(void 0===p)return Kr(Ll(n));d.push(p)}l.push(d)}return Hr(l)}return Kr(Ll(n))}}function BT(e){return function(r){if("number"==typeof r){var t=yp(r);return null!=t?Hr(t):Kr(Jr([e.config.localeInfo.getWorksheetFuncName(r)]))}return Hr(void 0)}}function VT(e){return function(r){var t=r.name.toUpperCase(),n=r.scope;if(void 0===n.index)return Hr(e.globalNames.getValue(t));var o=e.scopedNames.getValue(n.index);return Hr(void 0===o?void 0:o.getValue(t))}}function WT(e){return function(r){var t=e.worksheets.getValue(r.sheet.index);if(void 0===t)return Hr(void 0);var n=t.grid.getCellContents(r);if(0===n.kind||2===n.kind)return Hr(void 0);var o=n.ir;return Hr(Il(r,m.Cell,o))}}function HT(e){return function(r,t){var n=e.worksheets.getValue(r.sheet.index);void 0!==n&&n.grid.setCellContents(r,new LT(t))}}function KT(e){return function(r,t){for(var n=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,s=0;s<u;s+=1)for(var l=0;l<c;l+=1){var f=j(n,w(s+a,l+i)),d=e.worksheets.getValue(f.sheet.index);void 0!==d&&d.grid.setCellContents(f,new LT(t[s][l]))}}}function jT(e){return function(r,t){for(var n=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,s=0;s<u;s+=1)for(var l=0;l<c;l+=1){var f=j(n,w(s+a,l+i)),d=e.worksheets.getValue(f.sheet.index);if(void 0!==d){var h=d.grid.getCellContents(f);void 0!==h&&d.grid.setCellContents(f,h.failed(3,t.kind,t))}}}}function JT(e){return function(r){var t=e.worksheets.getValue(r.index);if(void 0===t)return Kr(qr([r]));var n=t.grid.getUsedRange();if(void 0===n)return Hr(n);var o=b(0,0,n.row+1,n.column+1);return Hr(K(r,o))}}function qT(e,r,t){var n=e.parser.parseFormula(e.isA1RefStyle?se.A1:se.R1C1,t,m.NameManager,r);if(n.kind===wr.Success){var o=e.analyzer.checkFormula(t,m.NameManager,n.value);return Cr(o)?e.compiler.compileFormula(t,m.NameManager,o):Kr(Tl("compileNamedFormula: formula is not well formed"))}return n}var YT=j(M(L(void 0,""),0),w(0,0)),XT=function(){function e(e,r,t,n,o,a,i,u,c,s){var l=this;void 0===u&&(u=!0),this.documentLocation=L(void 0,e),this.isA1RefStyle=r,this.locale=n,this.config=nn.calcConfig(n),nn.initCalc(s,(function(e){return-1!==c.indexOf(e)}));var f=nn.calcConfig(n);this.config=f;var d={config:f},h={config:f},v={config:f,mathpack:a};this.parser=_u(d),this.analyzer=ks(h),this.compiler=hf(v);var p,m,E,S=o?(m=1024,E=1024,{config:(p=this).config,mathpack:Bs,getDocumentLoc:wT(p),getSheetIndex:UT(p),getCellValue:GT(p),getCellValues:xT(p,m,E),getFirstOrderFunc:BT(p),getNameFormula:VT(p),getCellFormula:WT(p),interruptToken:[ml.Continue],schedulerInfo:{},setCellValue:HT(p),setCellValues:KT(p),setCellFailure:jT(p),getUsedRange:JT(p),setDynamicPrecs:function(e,r){},loadObjects:function(e){return!1}}):function(e){throw"Not being invoked yet."}();this.evaluator=ov(S),this.globalNames=rS(ur),this.scopedNames=rS(String),this.worksheets=rS(String),this.sheetId=0,t.forEach((function(e){l.addWorksheet(e)})),this.expectedValue=i,this.preprocess=function(e){return function(r){return e?g(r):"string"==typeof r?r:JSON.stringify(r)}}(u)}return e.prototype.addWorksheet=function(e){this.worksheets.setValue(this.sheetId,new bT(this,e)),this.sheetId+=1},e.prototype.makeHomeCell=function(e){var r=this.parser.parseFormula(this.isA1RefStyle?se.A1:se.R1C1,YT,m.Cell,e);if(r.kind===wr.Failure)return"Workbook can't create home cell "+this.preprocess(e)+". Reason: "+this.preprocess(r.reason)+".";if(r.value.node.kind===he.Bad)return"Workbook can't create home cell "+this.preprocess(e)+". (Bad Node).";var t=r.value.node.ref,n=r.value.node.qualifier,o=this.getSheetId(n.sheet);return-1===o?"Workbook can't find index of sheet "+this.preprocess(n.sheet)+".":j(M(this.documentLocation,o),w(t.row.index,t.col.index))},e.prototype.getSheetId=function(e){var r=-1;return this.worksheets.forEach((function(t,n){return n.name!==e||(r=t,!1)})),r},e.prototype.failedToAddName=function(e,r,t){var n=e?"addGlobalName":"addScopedName";C.ULS.traceTag(595891858,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook."+n+": "+r+" >> "+this.preprocess(t)+".")},e.prototype.addGlobalName=function(e,r,t){var n=this.makeHomeCell(t);if("string"==typeof n)return this.failedToAddName(!0,"failed to parse home cell",t);var o=qT(this,r,n);o.kind===wr.Success?this.globalNames.setValue(e,o.value):this.failedToAddName(!0,"failed to compile named formula",r)},e.prototype.addScopedName=function(e,r,t,n){var o=this.makeHomeCell(n);if("string"==typeof o)return this.failedToAddName(!1,"failed to parse home cell",n);var a=qT(this,t,o);a.kind===wr.Success?this.scopedNames.getOrSetValue(e,(function(){return rS(ur)})).getOrSetValue(r,(function(){return a.value})):this.failedToAddName(!1,"failed to compile named formula",t)},e.prototype.getSheetAndCell=function(e){var r=this.makeHomeCell(e);if("string"==typeof r)return r;var t=r.sheet.document;if(!Nr(this.documentLocation,t))return"Workbook: invalid workbook location";var n=r.sheet.index,o=this.worksheets.getValue(n);return void 0===o?"Workbook: invalid workbook location":{sheet:o,cell:r}},e.prototype.cellUpdateFailed=function(e,r,t){var n={cell:e,formula:r};C.ULS.traceTag(595891859,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellUpdate: "+t+" >> "+this.preprocess(n)+".")},e.prototype.cellUpdate=function(e,r){try{var t=this.getSheetAndCell(e);if("string"==typeof t)return this.cellUpdateFailed(e,r,"could not find cell and sheet");var n=t.sheet,o=t.cell;n.updateGrid(o,r);var a=n.parse(o);if(!jr(a))return this.cellUpdateFailed(e,r,"failed at parsing. "+a.reason);if(!jr(a=n.analyse(o)))return this.cellUpdateFailed(e,r,"failed at analysing. "+a.reason);if(!jr(a=n.compile(o)))return this.cellUpdateFailed(e,r,"failed at compiling. "+a.reason)}catch(e){C.ULS.traceTag(595891860,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in Workbook.cellUpdate: "+e)}},e.prototype.cellEvaluate=function(e){var r=this.worksheets.getValue(e.sheet.index);if(void 0!==r){var t=r.evaluate(e);jr(t)||C.ULS.traceTag(595886097,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellEvaluate: failed at evaluating "+this.preprocess(e)+". "+t.reason)}else C.ULS.traceTag(595886096,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellEvaluate: couldn't find worksheet "+this.preprocess(r))},e.prototype.cellUpdateWithValue=function(e,r){var t=this.getSheetAndCell(e);if("string"!=typeof t){var n=t.sheet,o=t.cell;n.upgradeGridWithValue(o,r)}else{var a="Workbook.cellUpdateWithValue: "+t+".";C.ULS.traceTag(595891861,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,a)}},e.prototype.cellRead=function(e){var r=this.getSheetAndCell(e);if("string"==typeof r){var t="Workbook.cellRead: "+r+".";return C.ULS.traceTag(595891862,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t),t}var n=r.sheet,o=r.cell;return n.grid.getCellContents(o)},e.prototype.forEachCell=function(e){var r=!0;this.worksheets.forEach((function(t,n){return r&&n.grid.forEach((function(t,o){return r=e(n,t,o)})),r}))},e}();t.d(r,"location",(function(){return qt})),t.d(r,"formula",(function(){return zt})),t.d(r,"value",(function(){return Xt})),t.d(r,"signature",(function(){return $t})),t.d(r,"util",(function(){return rn})),t.d(r,"config",(function(){return nn})),t.d(r,"parse",(function(){return n})),t.d(r,"analyze",(function(){return o})),t.d(r,"runtime",(function(){return a})),t.d(r,"calc",(function(){return c})),t.d(r,"funcs",(function(){return u})),t.d(r,"worker",(function(){return i})),t.d(r,"datamodel",(function(){return s}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map